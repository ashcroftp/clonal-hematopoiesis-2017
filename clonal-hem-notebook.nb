(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    851208,      21540]
NotebookOptionsPosition[    831373,      20960]
NotebookOutlinePosition[    831729,      20976]
CellTagsIndexPosition[    831686,      20973]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["clonal-hem-notebook.nb", "Title",
 CellChangeTimes->{{3.673248574008663*^9, 3.6732485799278107`*^9}, {
  3.6955626330434523`*^9, 3.695562639420328*^9}}],

Cell["Mathematical analysis and data presentation functions", "Subtitle",
 CellChangeTimes->{{3.695562654332616*^9, 3.6955626651078243`*^9}}],

Cell["Author: Peter Ashcroft, ETH Z\[UDoubleDot]rich", "Subsubtitle",
 CellChangeTimes->{{3.69556267332403*^9, 3.695562679338793*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}],

Cell[CellGroupData[{

Cell["Plotting and notebook options", "Subsubsection",
 CellChangeTimes->{{3.7123009243397093`*^9, 3.712300932042646*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Clear", " ", "output", " ", "cells", " ", "before", " ", "saving", " ", 
    "and", " ", 
    RowBox[{"pushing", "!"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"NotebookDelete", "[", 
    RowBox[{"Cells", "[", 
     RowBox[{
      RowBox[{"EvaluationNotebook", "[", "]"}], ",", 
      RowBox[{"CellStyle", "\[Rule]", 
       RowBox[{"{", "\"\<Output\>\"", "}"}]}]}], "]"}], " ", "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.695575061048427*^9, 3.6955751014159107`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Define", " ", "plot", " ", "style", " ", "for", " ", "this", " ", 
    RowBox[{"notebook", ".", " ", "\[IndentingNewLine]", "Run"}], " ", 
    "before", " ", "evaluating", " ", "notebook", " ", "cells", " ", "to", 
    " ", "avoid", " ", 
    RowBox[{"errors", "!"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"myPlotStyle", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"col", "\[Rule]", "\[Section]col"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"sym", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Section]col", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"Circle", "[", "]"}]}], "}"}]}], ",", "0.05"}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], " ", "]"}], ",", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"\[Section]col", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], " ", "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"Rectangle", "[", "]"}]}], "}"}]}], ",", "0.04"}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], " ", "]"}], ",", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"\[Section]col", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], " ", "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"Polygon", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.5"}], "}"}]}], "}"}], "]"}]}], 
                "}"}]}], ",", "0.06"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], " ", "]"}], ",", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"\[Section]col", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], " ", "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"Triangle", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    FractionBox[
                    SqrtBox["3"], "2"]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
              ",", "0.05"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"symFull", "\[Rule]", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[Section]col", "[", 
                  RowBox[{"[", "1", "]"}], "]"}], ",", 
                 RowBox[{"Disk", "[", "]"}]}], "}"}]}], ",", "0.05"}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"\[Section]col", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], " ", "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], " ", "]"}], ",", 
                 RowBox[{"Rectangle", "[", "]"}]}], "}"}]}], ",", "0.04"}], 
             "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"\[Section]col", "[", 
                    RowBox[{"[", "3", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], " ", "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], " ", "]"}], ",", 
                 RowBox[{"Polygon", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0.5"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", "1"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0.5"}], "}"}]}], "}"}], "]"}]}], 
                "}"}]}], ",", "0.06"}], "}"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Graphics", "@", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"FaceForm", "[", 
                  RowBox[{"Directive", "[", 
                   RowBox[{
                    RowBox[{"\[Section]col", "[", 
                    RowBox[{"[", "4", "]"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "1", "]"}]}], " ", "]"}], " ", 
                  "]"}], ",", 
                 RowBox[{"EdgeForm", "[", 
                  RowBox[{"Opacity", "[", "0", "]"}], " ", "]"}], ",", 
                 RowBox[{"Triangle", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"0", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "0"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"0.5", ",", 
                    FractionBox[
                    SqrtBox["3"], "2"]}], "}"}]}], "}"}], "]"}]}], "}"}]}], 
              ",", "0.05"}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"labelSize", "\[Rule]", "22"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ticksSize", "\[Rule]", "16"}], ",", "\[IndentingNewLine]", 
         RowBox[{"insetSize", "\[Rule]", "12"}], ",", "\[IndentingNewLine]", 
         RowBox[{"font", "\[Rule]", "\"\<Helvetica\>\""}]}], 
        "\[IndentingNewLine]", "}"}], "/.", 
       RowBox[{"\[Section]col", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RGBColor", "[", 
           RowBox[{
            RowBox[{"94", "/", "255"}], ",", 
            RowBox[{"60", "/", "255"}], ",", 
            RowBox[{"153", "/", "255"}]}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
            RowBox[{"230", "/", "255"}], ",", 
            RowBox[{"97", "/", "255"}], ",", 
            RowBox[{"1", "/", "255"}]}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
            RowBox[{"178", "/", "255"}], ",", 
            RowBox[{"171", "/", "255"}], ",", 
            RowBox[{"210", "/", "255"}]}], "]"}], ",", 
          RowBox[{"RGBColor", "[", 
           RowBox[{
            RowBox[{"253", "/", "255"}], ",", 
            RowBox[{"184", "/", "255"}], ",", 
            RowBox[{"99", "/", "255"}]}], "]"}]}], "}"}]}]}], "//", 
      "Quiet"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getTickValues", "[", 
     RowBox[{"{", 
      RowBox[{"fmin_", ",", "fmax_"}], "}"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"series", ",", "min", ",", "max", ",", "tickValues"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"series", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"i", ",", "9", ",", "1"}], "]"}], "\[Times]", 
            SuperscriptBox["10", 
             RowBox[{
              RowBox[{"Floor", "[", 
               RowBox[{
                RowBox[{"i", "-", "1"}], ",", "9"}], "]"}], "/", "9"}]]}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"-", "89"}], ",", "91"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"min", "=", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[LessEqual]", "fmin"}], "&"}], ",", "series"}], 
            "]"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"max", "=", 
        RowBox[{
         RowBox[{"FirstPosition", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[GreaterEqual]", "fmax"}], "&"}], ",", 
             "series"}], "]"}], ",", "True"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tickValues", "=", 
        RowBox[{"series", "[", 
         RowBox[{"[", 
          RowBox[{"min", ";;", "max"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "tickValues", "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"logTicks", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fmin_", ",", "fmax_"}], "}"}], ",", "isLog_", ",", 
      "isLabelled_", ",", "isSciFormat_", ",", "isPercentage_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tickValues", ",", "tickLocations", ",", "suffix", ",", "n", " ", ",", 
        "power10", ",", "tickLabels", ",", 
        RowBox[{"\[CapitalDelta]", "=", "0.01"}], ",", "tickSizes", ",", 
        "ticks"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tickValues", "=", 
        RowBox[{"getTickValues", "[", 
         RowBox[{"{", 
          RowBox[{"fmin", ",", "fmax"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "tickValues", "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tickLocations", "=", 
        RowBox[{"If", "[", 
         RowBox[{"isLog", ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"isPercentage", ",", 
            FractionBox["tickValues", "100"], ",", "tickValues"}], "]"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{"isPercentage", ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"Log10", "[", "#", "]"}], "-", "2"}], 
                RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], "&"}], ",", 
              "tickValues"}], "]"}], ",", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"Log10", "[", "#", "]"}], 
                RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], "&"}], ",", 
              "tickValues"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"suffix", "=", 
        RowBox[{"If", "[", 
         RowBox[{"isPercentage", ",", "\"\<%\>\"", ",", "\"\<\>\""}], "]"}]}],
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"power10", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MemberQ", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox["10.", "i"], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "10"}], ",", "10"}], "}"}]}], "]"}], ",", "#"}],
             "]"}], "&"}], ",", "tickValues"}], "]"}]}], ";", 
       RowBox[{"(*", 
        RowBox[{
        "Is", " ", "our", " ", "tick", " ", "value", " ", "a", " ", "power", 
         " ", "of", " ", 
         RowBox[{"10", "?"}]}], "*)"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"tickLabels", "=", 
        RowBox[{"If", "[", 
         RowBox[{"isLabelled", ",", "\[IndentingNewLine]", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"power10", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{"isSciFormat", ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"Superscript", "[", 
                    RowBox[{"\"\<10\>\"", ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"Log10", "[", 
                    RowBox[{"tickValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
                    " ", "]"}], ",", 
                   RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}],
                  "<>", "suffix"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"tickValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "\[GreaterEqual]", "1"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"Round", "[", 
                    RowBox[{"tickValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], "<>",
                    "suffix"}], ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"ToString", "[", 
                    RowBox[{"tickValues", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "<>", 
                   "suffix"}]}], "\[IndentingNewLine]", "]"}]}], 
               "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
              "\"\<\>\""}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ConstantArray", "[", 
           RowBox[{"\"\<\>\"", ",", "n"}], "]"}]}], "\[IndentingNewLine]", 
         "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"tickSizes", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{"#", ",", "\[CapitalDelta]", ",", 
                FractionBox["\[CapitalDelta]", "2"]}], "]"}], "&"}], ",", 
             "power10"}], "]"}], ",", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", "n"}], "]"}]}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ticks", "=", 
        RowBox[{"Transpose", "[", 
         RowBox[{"{", 
          RowBox[{"tickLocations", ",", "tickLabels", ",", "tickSizes"}], 
          "}"}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "ticks", "]"}], ";"}]}], "\[IndentingNewLine]", 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.695580363768602*^9, 3.695580375168418*^9}, 
   3.695588676484167*^9, {3.695590579815021*^9, 3.695590583413836*^9}, {
   3.696064928827763*^9, 3.6960649453316927`*^9}, {3.696143411044868*^9, 
   3.696143424963386*^9}, {3.708767654608158*^9, 3.70876766027907*^9}, {
   3.708767711693638*^9, 3.70876771230132*^9}, {3.708767756212493*^9, 
   3.708767759283763*^9}, {3.708769995848255*^9, 3.708770015022944*^9}, {
   3.711881901381802*^9, 3.711881902445035*^9}, {3.712057931975542*^9, 
   3.71205793447582*^9}, {3.7120580129021463`*^9, 3.7120580132050056`*^9}, {
   3.712132172210967*^9, 3.712132225648562*^9}, {3.712132818244712*^9, 
   3.7121328205406313`*^9}, {3.7121328718670197`*^9, 3.712132879858671*^9}, {
   3.7121329633761187`*^9, 3.712133121730811*^9}, {3.712133564564537*^9, 
   3.712133613282464*^9}, {3.712133933033039*^9, 3.712133990869645*^9}, {
   3.712134079915056*^9, 3.712134081882687*^9}, 3.712134328667515*^9, {
   3.71213445195056*^9, 3.712134473216629*^9}, {3.712134504733898*^9, 
   3.712134517396916*^9}, {3.712134664864686*^9, 3.712134697374382*^9}, {
   3.712134763341096*^9, 3.712134763636167*^9}, {3.712135152103715*^9, 
   3.71213525493195*^9}, {3.712135356984866*^9, 3.712135357608285*^9}, {
   3.7121354399183483`*^9, 3.7121355925764093`*^9}}],

Cell[" ", "Text",
 Editable->False,
 Selectable->False,
 CellFrame->{{0, 0}, {0, 3}},
 ShowCellBracket->False,
 CellMargins->{{0, 0}, {1, 1}},
 CellElementSpacings->{"CellMinHeight"->1},
 CellFrameMargins->0,
 CellFrameColor->RGBColor[0, 0, 1],
 CellSize->{Inherited, 5}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
1. Basic model: steady-state mouse parameters, residence times, and fluxes\
\>", "Chapter",
 CellChangeTimes->{{3.676115125024188*^9, 3.676115130783197*^9}, {
   3.6955642058283997`*^9, 3.695564210211318*^9}, {3.69556424110646*^9, 
   3.695564244370101*^9}, 3.695565180296815*^9, {3.6955652583103952`*^9, 
   3.695565276588955*^9}, {3.695573738675383*^9, 3.6955737387153177`*^9}, {
   3.6957076824290133`*^9, 3.695707683480365*^9}}],

Cell[CellGroupData[{

Cell["\[Rho]=0, \[Alpha]=0", "Subsection",
 CellChangeTimes->{{3.706335702117693*^9, 3.706335707580586*^9}, {
  3.70711430924503*^9, 3.70711431040919*^9}}],

Cell[CellGroupData[{

Cell["{\[Delta], d, a}", "Subsubsection",
 CellChangeTimes->{{3.6900207362540903`*^9, 3.6900207462510757`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "[", 
   RowBox[{"\[Section]s_", ",", "\[Section]\[ScriptL]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      FractionBox["n", "s"]}], ",", 
     RowBox[{
      FractionBox["s", 
       RowBox[{"\[ScriptL]", " ", "n"}]], "-", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "\[ScriptL]"], "-", 
        FractionBox[
         RowBox[{"\[Beta]", " ", "n"}], "s"]}], ")"}], 
      FractionBox["\[ScriptCapitalN]", 
       RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["1.", "39"]}], ",", 
     RowBox[{"n", "\[Rule]", "9900"}], ",", 
     RowBox[{"s", "\[Rule]", "\[Section]s"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", 
      FractionBox["\[Section]\[ScriptL]", "1440."]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramTab", "[", "\[Section]s_", "]"}], ":=", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"params", "[", 
        RowBox[{"\[Section]s", ",", "1"}], "]"}], ",", 
       RowBox[{"params", "[", 
        RowBox[{"\[Section]s", ",", "3"}], "]"}], ",", 
       RowBox[{"params", "[", 
        RowBox[{"\[Section]s", ",", "5"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<\[Delta]\>\"", ",", "\"\<d\>\"", ",", "\"\<a\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[ScriptL]=1\>\"", ",", "\"\<\[ScriptL]=3\>\"", ",", 
         "\"\<\[ScriptL]=5\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6926891760150423`*^9, 3.6926892997060337`*^9}, {
  3.692690454081099*^9, 3.692690463016618*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.692689364551364*^9, 3.692689364695389*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", "10", "]"}]], "Input",
 CellChangeTimes->{3.692689367895446*^9}],

Cell[BoxData[
 RowBox[{"paramTab", "[", "100", "]"}]], "Input",
 CellChangeTimes->{{3.69268930153172*^9, 3.692689323697193*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Residence time in BM", "Subsubsection",
 CellChangeTimes->{{3.6900207625312157`*^9, 3.69002076916226*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"resTime", "[", 
   RowBox[{"\[Section]s_", ",", "\[Section]\[ScriptL]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         FractionBox["s", 
          RowBox[{"\[ScriptL]", " ", "n"}]], "-", "\[Beta]"}], ")"}], 
       RowBox[{"-", "1"}]], "\[Times]", "24"}], ",", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        FractionBox["s", 
         RowBox[{"\[ScriptL]", " ", "n"}]], "-", "\[Beta]"}], ")"}], 
      RowBox[{"-", "1"}]]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["1.", "39"]}], ",", 
     RowBox[{"n", "\[Rule]", "9900"}], ",", 
     RowBox[{"s", "\[Rule]", "\[Section]s"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", 
      FractionBox["\[Section]\[ScriptL]", "1440."]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"resTimeTab", "[", "\[Section]s_", "]"}], ":=", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"resTime", "[", 
        RowBox[{"\[Section]s", ",", "1"}], "]"}], ",", 
       RowBox[{"resTime", "[", 
        RowBox[{"\[Section]s", ",", "3"}], "]"}], ",", 
       RowBox[{"resTime", "[", 
        RowBox[{"\[Section]s", ",", "5"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<hours\>\"", ",", "\"\<days\>\""}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[ScriptL]=1\>\"", ",", "\"\<\[ScriptL]=3\>\"", ",", 
         "\"\<\[ScriptL]=5\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.692689384678368*^9, 3.6926893927423487`*^9}, {
  3.692689425910328*^9, 3.692689478923517*^9}, {3.6926903724838552`*^9, 
  3.692690382291192*^9}}],

Cell[BoxData[
 RowBox[{"resTimeTab", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.6926894852379208`*^9, 3.692689488043684*^9}}],

Cell[BoxData[
 RowBox[{"resTimeTab", "[", "10", "]"}]], "Input",
 CellChangeTimes->{3.6926894948747263`*^9}],

Cell[BoxData[
 RowBox[{"resTimeTab", "[", "100", "]"}]], "Input",
 CellChangeTimes->{{3.692689501394452*^9, 3.692689501498465*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Flux", "Subsubsection",
 CellChangeTimes->{{3.692689547657835*^9, 3.692689548040812*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"flux", "[", 
   RowBox[{"\[Section]s_", ",", "\[Section]\[ScriptL]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["s", "\[ScriptL]"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"d", " ", "n"}], "+", 
        RowBox[{"\[Beta]", " ", "n"}]}], ")"}], "/.", 
      RowBox[{"d", "\[Rule]", 
       RowBox[{
        FractionBox["s", 
         RowBox[{"\[ScriptL]", " ", "n"}]], "-", "\[Beta]"}]}]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["1.", "39"]}], ",", 
     RowBox[{"n", "\[Rule]", "9900"}], ",", 
     RowBox[{"s", "\[Rule]", "\[Section]s"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", 
      FractionBox["\[Section]\[ScriptL]", "1440."]}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"fluxTab", "[", "\[Section]s_", "]"}], ":=", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"flux", "[", 
        RowBox[{"\[Section]s", ",", "1"}], "]"}], ",", 
       RowBox[{"flux", "[", 
        RowBox[{"\[Section]s", ",", "3"}], "]"}], ",", 
       RowBox[{"flux", "[", 
        RowBox[{"\[Section]s", ",", "5"}], "]"}]}], "}"}], "]"}], ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<flux out of PB\>\"", ",", "\"\<flux out of BM\>\""}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "\"\<\[ScriptL]=1\>\"", ",", "\"\<\[ScriptL]=3\>\"", ",", 
         "\"\<\[ScriptL]=5\>\""}], "}"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.69268956158559*^9, 3.69268961854253*^9}, {
  3.6926898205843163`*^9, 3.692689869117701*^9}, {3.692689934100781*^9, 
  3.692690000984808*^9}, {3.69269039292304*^9, 3.692690400034649*^9}}],

Cell[BoxData[
 RowBox[{"fluxTab", "[", "1", "]"}]], "Input",
 CellChangeTimes->{{3.692689603602504*^9, 3.692689605583866*^9}}],

Cell[BoxData[
 RowBox[{"fluxTab", "[", "10", "]"}]], "Input",
 CellChangeTimes->{3.692689627334176*^9}],

Cell[BoxData[
 RowBox[{"fluxTab", "[", "100", "]"}]], "Input",
 CellChangeTimes->{{3.6926896323576717`*^9, 3.692689632477824*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 "\[Rho]=0, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "\[NotEqual]", "0"}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.706335692864699*^9, 3.706335715004387*^9}, {
  3.706335968508939*^9, 3.706335970598983*^9}, {3.7071143124655313`*^9, 
  3.707114312936908*^9}}],

Cell[CellGroupData[{

Cell["Alternative model: {\[Delta], d, a}", "Subsubsection",
 CellChangeTimes->{{3.6900207362540903`*^9, 3.6900207462510757`*^9}, {
  3.6900207847064743`*^9, 3.6900207870337133`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "[", 
   RowBox[{
   "\[Section]s_", ",", "\[Section]\[ScriptL]_", ",", "\[Section]\[Alpha]_"}],
    "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Beta]", " ", "n"}], 
      RowBox[{"s", "+", 
       RowBox[{"\[Alpha]", " ", "n"}]}]], ",", 
     RowBox[{
      FractionBox["s", 
       RowBox[{"\[ScriptL]", " ", "n"}]], "-", "\[Beta]"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "\[ScriptL]"], "-", 
        FractionBox[
         RowBox[{"\[Beta]", " ", "n"}], 
         RowBox[{"s", "+", 
          RowBox[{"\[Alpha]", " ", "n"}]}]]}], ")"}], 
      FractionBox["\[ScriptCapitalN]", 
       RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["1.", "39"]}], ",", 
     RowBox[{"n", "\[Rule]", "9900"}], ",", 
     RowBox[{"s", "\[Rule]", "\[Section]s"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", 
      FractionBox["\[Section]\[ScriptL]", "1440."]}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "\[Section]\[Alpha]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramTab", "[", 
   RowBox[{"\[Section]s_", ",", "\[Section]\[Alpha]Vals_"}], "]"}], ":=", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"params", "[", 
        RowBox[{"\[Section]s", ",", "3", ",", "\[Section]\[Alpha]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Alpha]", ",", "\[Section]\[Alpha]Vals"}], 
        "}"}]}], "]"}], " ", "]"}], ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<\[Delta]\>\"", ",", "\"\<d\>\"", ",", "\"\<a\>\""}], 
        "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Section]\[Alpha]", "\[Equal]", "0"}], ",", 
           RowBox[{"\"\<\[Alpha]=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Section]\[Alpha]", "]"}]}], ",", 
           RowBox[{"Superscript", "[", 
            RowBox[{"\"\<\[Alpha]=10\>\"", ",", 
             RowBox[{"Log10", "[", "\[Section]\[Alpha]", "]"}]}], " ", 
            "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Section]\[Alpha]", ",", "\[Section]\[Alpha]Vals"}], 
          "}"}]}], "]"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.692700492348117*^9, 3.692700571096177*^9}, {
  3.6927006014393787`*^9, 3.692700729970685*^9}, {3.692700762970559*^9, 
  3.692700772993155*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]Vals", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "4"}]], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "2"}]], ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692700784959499*^9, 3.692700796393087*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", 
  RowBox[{"1", ",", "\[Alpha]Vals"}], "]"}]], "Input",
 CellChangeTimes->{{3.692700659931436*^9, 3.692700679612338*^9}, {
  3.692700791065534*^9, 3.692700799535987*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", 
  RowBox[{"100", ",", "\[Alpha]Vals"}], "]"}]], "Input",
 CellChangeTimes->{{3.692700811848422*^9, 3.692700811967496*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     SubscriptBox["\[Rho]", "0"], 
     FractionBox[
      RowBox[{"N", "-", "n"}], "N"]}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "\[NotEqual]", "0"}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{{3.706335702117693*^9, 3.706335707580586*^9}, {
  3.706335739267529*^9, 3.706335742595594*^9}, {3.7063357835381327`*^9, 
  3.706335791218364*^9}, {3.706335951997387*^9, 3.7063359620953417`*^9}, {
  3.706360144487933*^9, 3.706360144632025*^9}, {3.707114315909134*^9, 
  3.707114317928996*^9}}],

Cell[CellGroupData[{

Cell["Find parameters in terms of knowns", "Subsubsection",
 CellChangeTimes->{{3.7063358735518303`*^9, 3.706335886198637*^9}}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"\[Rho]", " ", 
              FractionBox[
               RowBox[{"\[ScriptCapitalN]", "-", "n"}], 
               "\[ScriptCapitalN]"]}]}], ")"}]}]}], ")"}], "n"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           FractionBox[
            RowBox[{"\[ScriptCapitalN]", "-", "n"}], "\[ScriptCapitalN]"]}], 
          "+", "\[Delta]"}], ")"}], "s"}]}]}], ",", 
     RowBox[{"0", "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", " ", "\[Rho]", " ", 
           FractionBox[
            RowBox[{"\[ScriptCapitalN]", "-", "n"}], "\[ScriptCapitalN]"]}], 
          "-", "d", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], "n"}], "+", 
       RowBox[{"a", " ", "s", " ", 
        FractionBox[
         RowBox[{"\[ScriptCapitalN]", "-", "n"}], "\[ScriptCapitalN]"]}]}]}], 
     ",", 
     RowBox[{"\[ScriptL]", "\[Equal]", 
      FractionBox["1", 
       RowBox[{"\[Delta]", "+", 
        RowBox[{"a", " ", 
         FractionBox[
          RowBox[{"\[ScriptCapitalN]", "-", "n"}], 
          "\[ScriptCapitalN]"]}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", "d", ",", "a"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706335887506509*^9, 3.706335947129074*^9}, {
   3.706336153654592*^9, 3.706336224051721*^9}, {3.7063362833071213`*^9, 
   3.706336359711464*^9}, {3.7063364214059973`*^9, 3.706336422488871*^9}, 
   3.70633646314815*^9, {3.70633650685111*^9, 3.706336508410778*^9}, {
   3.707114357439887*^9, 3.707114362391304*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["{\[Delta], d, a}", "Subsubsection",
 CellChangeTimes->{{3.6900207362540903`*^9, 3.6900207462510757`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "[", 
   RowBox[{
   "\[Section]s_", ",", "\[Section]\[ScriptL]_", ",", "\[Section]\[Alpha]_"}],
    "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      FractionBox["n", 
       RowBox[{"s", "+", 
        RowBox[{"\[Alpha]", " ", "n"}]}]]}], ",", 
     RowBox[{
      FractionBox["s", 
       RowBox[{"\[ScriptL]", " ", "n"}]], "-", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"\[Rho]", " ", 
          FractionBox[
           RowBox[{"\[ScriptCapitalN]", "-", "n"}], "\[ScriptCapitalN]"]}]}], 
        ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "\[ScriptL]"], "-", 
        FractionBox[
         RowBox[{"\[Beta]", " ", "n"}], 
         RowBox[{"s", "+", 
          RowBox[{"\[Alpha]", " ", "n"}]}]]}], ")"}], 
      FractionBox["\[ScriptCapitalN]", 
       RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["1.", "39"]}], ",", 
     RowBox[{"n", "\[Rule]", "9900"}], ",", 
     RowBox[{"s", "\[Rule]", "\[Section]s"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", 
      FractionBox["\[Section]\[ScriptL]", "1440."]}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "\[Section]\[Alpha]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramTab", "[", 
   RowBox[{"\[Section]s_", ",", "\[Section]\[Alpha]Vals_"}], "]"}], ":=", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"params", "[", 
        RowBox[{"\[Section]s", ",", "3", ",", "\[Section]\[Alpha]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Alpha]", ",", "\[Section]\[Alpha]Vals"}], 
        "}"}]}], "]"}], " ", "]"}], ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<\[Delta]\>\"", ",", "\"\<d\>\"", ",", "\"\<a\>\""}], 
        "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Section]\[Alpha]", "\[Equal]", "0"}], ",", 
           RowBox[{"\"\<\[Alpha]=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Section]\[Alpha]", "]"}]}], ",", 
           RowBox[{"Superscript", "[", 
            RowBox[{"\"\<\[Alpha]=10\>\"", ",", 
             RowBox[{"Log10", "[", "\[Section]\[Alpha]", "]"}]}], " ", 
            "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Section]\[Alpha]", ",", "\[Section]\[Alpha]Vals"}], 
          "}"}]}], "]"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6926891760150423`*^9, 3.6926892997060337`*^9}, {
   3.692690454081099*^9, 3.692690463016618*^9}, {3.7063372282182903`*^9, 
   3.7063372320100946`*^9}, {3.7063375588160067`*^9, 3.706337562743318*^9}, {
   3.70633771607507*^9, 3.706337726481789*^9}, {3.706337764097869*^9, 
   3.706337783528006*^9}, 3.7063378457502832`*^9, {3.707114376063862*^9, 
   3.7071143764312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]Vals", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "4"}]], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "2"}]], ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692700784959499*^9, 3.692700796393087*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", 
  RowBox[{"1", ",", "\[Alpha]Vals"}], "]"}]], "Input",
 CellChangeTimes->{{3.692700659931436*^9, 3.692700679612338*^9}, {
  3.692700791065534*^9, 3.692700799535987*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", 
  RowBox[{"100", ",", "\[Alpha]Vals"}], "]"}]], "Input",
 CellChangeTimes->{{3.692700811848422*^9, 3.692700811967496*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Rho]", "=", 
    RowBox[{
     SubscriptBox["\[Rho]", "0"], 
     FractionBox[
      RowBox[{"N", "-", "n"}], 
      RowBox[{"N", "-", 
       SuperscriptBox["n", "\[Times]"]}]]}]}], TraditionalForm]]],
 ", ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Alpha]", "\[NotEqual]", "0"}], TraditionalForm]]],
 " (Also for step function, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Rho]", "(", "n", ")"}], "=", 
    RowBox[{
     SubscriptBox["\[Rho]", "0"], 
     SubscriptBox["\[Delta]", 
      RowBox[{"n", ",", "N"}]]}]}], TraditionalForm]]],
 ")"
}], "Subsection",
 CellChangeTimes->{{3.706335702117693*^9, 3.706335707580586*^9}, {
  3.706335739267529*^9, 3.706335742595594*^9}, {3.7063357835381327`*^9, 
  3.706335791218364*^9}, {3.706335951997387*^9, 3.7063359620953417`*^9}, {
  3.70635394969701*^9, 3.706353955711149*^9}, {3.7063601327731447`*^9, 
  3.706360164339423*^9}, {3.707114323316471*^9, 3.707114346511815*^9}}],

Cell[CellGroupData[{

Cell["Find parameters in terms of knowns", "Subsubsection",
 CellChangeTimes->{{3.7063358735518303`*^9, 3.706335886198637*^9}}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], " ", ")"}]}]}], ")"}], "n"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", 
           FractionBox[
            RowBox[{"\[ScriptCapitalN]", "-", "n"}], "\[ScriptCapitalN]"]}], 
          "+", "\[Delta]"}], ")"}], "s"}]}]}], ",", 
     RowBox[{"0", "\[Equal]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", " ", "\[Rho]"}], "-", "d", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], "n"}], "+", 
       RowBox[{"a", " ", "s", " ", 
        FractionBox[
         RowBox[{"\[ScriptCapitalN]", "-", "n"}], "\[ScriptCapitalN]"]}]}]}], 
     ",", 
     RowBox[{"\[ScriptL]", "\[Equal]", 
      FractionBox["1", 
       RowBox[{"\[Delta]", "+", 
        RowBox[{"a", " ", 
         FractionBox[
          RowBox[{"\[ScriptCapitalN]", "-", "n"}], 
          "\[ScriptCapitalN]"]}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Delta]", ",", "d", ",", "a"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706335887506509*^9, 3.706335947129074*^9}, {
   3.706336153654592*^9, 3.706336224051721*^9}, {3.7063362833071213`*^9, 
   3.706336359711464*^9}, {3.7063364214059973`*^9, 3.706336422488871*^9}, 
   3.70633646314815*^9, {3.70633650685111*^9, 3.706336508410778*^9}, {
   3.706353977631591*^9, 3.706353979919435*^9}, {3.7071143927984877`*^9, 
   3.707114396406281*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["{\[Delta], d, a}", "Subsubsection",
 CellChangeTimes->{{3.6900207362540903`*^9, 3.6900207462510757`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "[", 
   RowBox[{
   "\[Section]s_", ",", "\[Section]\[ScriptL]_", ",", "\[Section]\[Alpha]_"}],
    "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Beta]", " ", 
      FractionBox["n", 
       RowBox[{"s", "+", 
        RowBox[{"\[Alpha]", " ", "n"}]}]]}], ",", 
     RowBox[{
      FractionBox["s", 
       RowBox[{"\[ScriptL]", " ", "n"}]], "-", 
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Rho]"}], " ", ")"}]}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "\[ScriptL]"], "-", 
        FractionBox[
         RowBox[{"\[Beta]", " ", "n"}], 
         RowBox[{"s", "+", 
          RowBox[{"\[Alpha]", " ", "n"}]}]]}], ")"}], 
      FractionBox["\[ScriptCapitalN]", 
       RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      FractionBox["1.", "39"]}], ",", 
     RowBox[{"n", "\[Rule]", "9900"}], ",", 
     RowBox[{"s", "\[Rule]", "\[Section]s"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", 
      FractionBox["\[Section]\[ScriptL]", "1440."]}], ",", 
     RowBox[{"\[Alpha]", "\[Rule]", "\[Section]\[Alpha]"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramTab", "[", 
   RowBox[{"\[Section]s_", ",", "\[Section]\[Alpha]Vals_"}], "]"}], ":=", 
  RowBox[{"TableForm", "[", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"params", "[", 
        RowBox[{"\[Section]s", ",", "3", ",", "\[Section]\[Alpha]"}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Alpha]", ",", "\[Section]\[Alpha]Vals"}], 
        "}"}]}], "]"}], " ", "]"}], ",", 
    RowBox[{"TableHeadings", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\"\<\[Delta]\>\"", ",", "\"\<d\>\"", ",", "\"\<a\>\""}], 
        "}"}], ",", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"\[Section]\[Alpha]", "\[Equal]", "0"}], ",", 
           RowBox[{"\"\<\[Alpha]=\>\"", "<>", 
            RowBox[{"ToString", "[", "\[Section]\[Alpha]", "]"}]}], ",", 
           RowBox[{"Superscript", "[", 
            RowBox[{"\"\<\[Alpha]=10\>\"", ",", 
             RowBox[{"Log10", "[", "\[Section]\[Alpha]", "]"}]}], " ", 
            "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Section]\[Alpha]", ",", "\[Section]\[Alpha]Vals"}], 
          "}"}]}], "]"}]}], "}"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6926891760150423`*^9, 3.6926892997060337`*^9}, {
   3.692690454081099*^9, 3.692690463016618*^9}, {3.7063372282182903`*^9, 
   3.7063372320100946`*^9}, {3.7063375588160067`*^9, 3.706337562743318*^9}, {
   3.70633771607507*^9, 3.706337726481789*^9}, {3.706337764097869*^9, 
   3.706337783528006*^9}, 3.7063378457502832`*^9, 3.706353995704032*^9, {
   3.70711441358204*^9, 3.7071144138699017`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Alpha]Vals", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "4"}]], ",", 
     SuperscriptBox["10", 
      RowBox[{"-", "2"}]], ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.692700784959499*^9, 3.692700796393087*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", 
  RowBox[{"1", ",", "\[Alpha]Vals"}], "]"}]], "Input",
 CellChangeTimes->{{3.692700659931436*^9, 3.692700679612338*^9}, {
  3.692700791065534*^9, 3.692700799535987*^9}}],

Cell[BoxData[
 RowBox[{"paramTab", "[", 
  RowBox[{"100", ",", "\[Alpha]Vals"}], "]"}]], "Input",
 CellChangeTimes->{{3.692700811848422*^9, 3.692700811967496*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["2. Mathematical analysis of time to clonality (\[Rho]=\[Alpha]=0)", \
"Chapter",
 CellChangeTimes->{{3.695565335947528*^9, 3.695565371137779*^9}, {
  3.695707687496222*^9, 3.695707688552051*^9}, {3.7089316464628143`*^9, 
  3.7089316515738707`*^9}}],

Cell[CellGroupData[{

Cell["Neutral clone", "Section",
 CellChangeTimes->{{3.677308899376074*^9, 3.6773089013112497`*^9}, {
  3.677323066630706*^9, 3.677323068262315*^9}, {3.6955735452611856`*^9, 
  3.6955735491383543`*^9}}],

Cell[CellGroupData[{

Cell["Jacobian and eigensystem", "Subsection",
 CellChangeTimes->{{3.668257551026848*^9, 3.668257552191036*^9}, {
  3.668313384779729*^9, 3.668313389091033*^9}}],

Cell[TextData[{
 "Writing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["x", "\[Rule]"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["s", "1"], ",", 
       SubscriptBox["s", "2"], ",", 
       SubscriptBox["n", "1"], ",", 
       SubscriptBox["n", "2"]}], ")"}], "/", "N"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", the neutral ODEs for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", 
    RowBox[{
     OverscriptBox["x", "\[Rule]"], "/", "dt"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are given by:"
}], "Text",
 CellChangeTimes->{{3.6955736326165047`*^9, 3.6955736841102343`*^9}, {
  3.6955737872290983`*^9, 3.6955738201183767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"odes", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "\[Beta]"}], ")"}], "x3"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x1"}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "\[Beta]"}], ")"}], "x4"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", "x3"}], "+", 
      RowBox[{"a", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", "x4"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6682575831991*^9, 3.668257751936234*^9}, {
  3.677308948262648*^9, 3.677308994204137*^9}, {3.677309034596307*^9, 
  3.6773090467222757`*^9}}],

Cell["\<\
The slow manifold is given by xStar. We then compute the Jacobian of the ODEs \
about this point.\
\>", "Text",
 CellChangeTimes->{{3.695573839219204*^9, 3.695573899281167*^9}, {
  3.695573932972476*^9, 3.69557396597019*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xStar", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "\[Rule]", 
        RowBox[{
         FractionBox["\[Beta]", "\[Delta]"], 
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], ",", 
       RowBox[{"x2", "\[Rule]", 
        RowBox[{
         FractionBox["\[Beta]", "\[Delta]"], "z"}]}], ",", 
       RowBox[{"x3", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
       RowBox[{"x4", "\[Rule]", "z"}]}], "}"}], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"d", " ", "\[Delta]"}], 
        RowBox[{"a", " ", "\[Beta]"}]]}]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"odes", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "}"}]}], 
      "]"}], "/.", "xStar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "J", "]"}]}], "Input",
 CellChangeTimes->{{3.695573903138708*^9, 3.6955739227886744`*^9}, 
   3.695573970004027*^9, {3.695574000684684*^9, 3.6955740125537252`*^9}}],

Cell[TextData[{
 "Now we compute the eigenvalues, and right & left eigenvectors of ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.695574046395015*^9, 3.6955740729446774`*^9}}],

Cell[BoxData[
 RowBox[{"\[Lambda]", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668257903804352*^9, 3.668257936249565*^9}, {
  3.668258186073648*^9, 3.668258212881054*^9}, {3.668313280711825*^9, 
  3.6683132863668413`*^9}}],

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682578845517*^9, 3.668257886467813*^9}, {
  3.668258005416245*^9, 3.66825803552743*^9}, {3.668313276512781*^9, 
  3.668313290470598*^9}}],

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"Transpose", "[", "J", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668258062573778*^9, 3.668258066404913*^9}, {
   3.668313295630507*^9, 3.668313296054381*^9}, 3.668313396731451*^9}],

Cell[TextData[{
 "Here we extract the first eigenvectors, corresponding to the zero \
eigenvalue. They are rescaled so that they look pretty and so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"v1", "\[CenterDot]", "u1"}], "=", "1"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "."
}], "Text",
 CellChangeTimes->{{3.695574103410289*^9, 3.6955741242000523`*^9}, {
  3.695574164407937*^9, 3.6955741949756327`*^9}, {3.6955742454087763`*^9, 
  3.6955742621407967`*^9}}],

Cell[BoxData[{
 RowBox[{"v1", "=", 
  RowBox[{"FullSimplify", "[", 
   FractionBox[
    RowBox[{"v", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"v", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "4"}], "]"}], "]"}]], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"u1", "=", 
  RowBox[{"FullSimplify", "[", 
   FractionBox[
    RowBox[{"u", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", "v1"}]], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"v1", ".", "u1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6683134066592712`*^9, 3.668313409690284*^9}, {
  3.668313471912043*^9, 3.668313526798155*^9}, {3.6685970487541924`*^9, 
  3.668597048962077*^9}, {3.6955742673004913`*^9, 3.695574282255293*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Diffusion matrix", "Subsection",
 CellChangeTimes->{{3.668411114600995*^9, 3.668411118287931*^9}}],

Cell["\<\
By considering the individual-based reactions, we can construct \
multiplicative diffusion matrix for the SDE approximation.
We can then evaluate this on the slow-manifold xStar.\
\>", "Text",
 CellChangeTimes->{{3.6955743245523863`*^9, 3.695574382148737*^9}, {
  3.6955744131777563`*^9, 3.69557444052248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "\[Beta]"}], ")"}], "x3"}], " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], "x1"}]}], 
       ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x3"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", "0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", "\[Beta]"}], ")"}], "x4"}], " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], "x2"}]}], 
       ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x4"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x3"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"d", " ", "x3"}], "+", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", "0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x4"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{"d", " ", "x4"}], "+", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.668598697363703*^9, 3.668598757580647*^9}, {
   3.6685988006357517`*^9, 3.668598857889097*^9}, {3.668598890760662*^9, 
   3.668598934030899*^9}, {3.6773092220441713`*^9, 3.677309229395602*^9}, {
   3.677309485091032*^9, 3.677309649053141*^9}, 3.695574391894211*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"B", "/.", "xStar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "B", "]"}]}], "Input",
 CellChangeTimes->{{3.668598940890915*^9, 3.668598962368547*^9}, {
   3.668599042323842*^9, 3.668599068434012*^9}, 3.677309716659997*^9, {
   3.695574401061257*^9, 3.6955744017724323`*^9}}],

Cell["\<\
New diffusion coefficient, which is the diffusion matrix projected onto the \
slow-manifold direction using the leading left eigenvector.\
\>", "Text",
 CellChangeTimes->{{3.695575131328445*^9, 3.695575153934256*^9}, {
  3.6955751842140083`*^9, 3.69557519082962*^9}, {3.708931661445508*^9, 
  3.708931662165392*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"u1", ".", 
   RowBox[{"(", 
    RowBox[{"B", ".", "u1"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.668411221124408*^9, 3.668411235243884*^9}, {
  3.695575377469091*^9, 3.695575382796157*^9}}],

Cell["Let\[CloseCurlyQuote]s write that in a neater form.", "Text",
 CellChangeTimes->{{3.6955753909918833`*^9, 3.695575429122048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTilde", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", "\[Beta]"}], ")"}], "\[Beta]", " ", 
       SuperscriptBox["\[Delta]", "2"], " "}], 
      RowBox[{"\[Xi]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
          RowBox[{"\[Beta]", " ", "d"}], "+", 
          RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"]}]], "z", 
     RowBox[{"(", 
      RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"d", " ", "\[Delta]"}], 
       RowBox[{"a", " ", "\[Beta]"}]]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.668411453842161*^9, 3.668411548601388*^9}, {
  3.677309765016757*^9, 3.6773097806529016`*^9}, {3.7089316790451927`*^9, 
  3.7089316871087637`*^9}, {3.70893174499572*^9, 3.7089317527784977`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"u1", ".", 
     RowBox[{"(", 
      RowBox[{"B", ".", "u1"}], ")"}]}], "-", "BTilde"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.708931784275069*^9, 3.7089318059767227`*^9}}],

Cell[TextData[{
 "The coefficient, which we write as \[ScriptCapitalB] in the manuscript, can \
be expressed in terms of the fundamental parameters (",
 Cell[BoxData[
  FormBox[
   RowBox[{
   "\[Beta]", ",", "\[ScriptCapitalN]", ",", "s", ",", "n", ",", 
    "\[ScriptL]"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ")."
}], "Text",
 CellChangeTimes->{{3.695575431707925*^9, 3.695575507043271*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"paramSub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Delta]", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Beta]", " ", "n"}], "s"]}], ",", 
     RowBox[{"d", "\[Rule]", 
      RowBox[{
       FractionBox[
        RowBox[{
         FractionBox["1", "\[ScriptL]"], "s"}], "n"], "-", "\[Beta]"}]}], ",", 
     RowBox[{"a", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "\[ScriptL]"], "-", 
         FractionBox[
          RowBox[{"\[Beta]", " ", "n"}], "s"]}], ")"}], 
       FractionBox["\[ScriptCapitalN]", 
        RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"a", " ", "d", " ", 
     RowBox[{"(", 
      RowBox[{"d", "+", "\[Beta]"}], ")"}], 
     SuperscriptBox["\[Beta]", "2"], " ", 
     SuperscriptBox["\[Delta]", "2"], " "}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", " ", "\[Beta]"}], "-", 
       RowBox[{"d", " ", "\[Delta]"}]}], ")"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
        RowBox[{"d", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], "2"]}]], "/.",
    "paramSub"}], "]"}]}], "Input",
 CellChangeTimes->{{3.695575513901004*^9, 3.695575535257642*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times", "Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}}],

Cell["\<\
We start the process on the slow manifold at the position z0. We want to know \
what is the probability our mutant reaches fixation (z=\[Xi]), and how long \
this takes.\
\>", "Text",
 CellChangeTimes->{{3.695575671665298*^9, 3.6955757204814034`*^9}, {
  3.695575955351097*^9, 3.695575957543264*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[LessEqual]", "z", "\[LessEqual]", "\[Xi]"}], ",", 
     RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
     RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
     RowBox[{"\[ScriptCapitalB]", ">", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7114461790107317`*^9, 3.71144619107979*^9}, 
   3.71180183199942*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"DSolve", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"\[Phi]", "''"}], "[", "z", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Phi]", "[", "\[Xi]", "]"}], "\[Equal]", "1"}]}], "}"}], 
     ",", 
     RowBox[{"\[Phi]", "[", "z", "]"}], ",", "z"}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
  3.668667378420467*^9, 3.668667380404291*^9}, {3.677478050979171*^9, 
  3.677478056762979*^9}, {3.677479841931428*^9, 3.677479844971135*^9}, {
  3.677479891641713*^9, 3.677479893152734*^9}, {3.7118018336711206`*^9, 
  3.711801862108934*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"t", "''"}], "[", "z", "]"}], "\[Equal]", 
          RowBox[{"-", 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalB]", " ", "z", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"t", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
  3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
  3.677310575463461*^9}, {3.677478058731037*^9, 3.677478071146494*^9}, {
  3.677479848019381*^9, 3.677479860978179*^9}, {3.6774798953128757`*^9, 
  3.67747989610461*^9}, {3.711446193958865*^9, 3.711446236589654*^9}, {
  3.7116895884815063`*^9, 3.7116895973359127`*^9}, {3.7118018668941402`*^9, 
  3.7118018789658403`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "''"}], "[", "z", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[ScriptCapitalN]", 
               RowBox[{"\[ScriptCapitalB]", " ", "z", 
                RowBox[{"(", 
                 RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
             FractionBox["z", "\[Xi]"]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
     "First"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox["z", "\[Xi]"]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6774780892498913`*^9, 3.677478122128717*^9}, {
   3.677478699420609*^9, 3.677478708195252*^9}, {3.6774787456502047`*^9, 
   3.677478882276909*^9}, {3.6774798745138483`*^9, 3.677479926748268*^9}, {
   3.695575851969529*^9, 3.695575876821679*^9}, 3.71143416531596*^9, 
   3.711446071763987*^9, {3.7114462444543867`*^9, 3.711446248501293*^9}, {
   3.7114471209442472`*^9, 3.711447128094913*^9}, {3.711689553398097*^9, 
   3.711689559097187*^9}, {3.7116895997446547`*^9, 3.711689600423894*^9}, {
   3.711801889980949*^9, 3.71180191093178*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Second", " ", 
    RowBox[{"moment", ":", " ", 
     RowBox[{"NEW", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "''"}], "[", "z", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"-", "2"}], 
             FractionBox["\[ScriptCapitalN]", 
              RowBox[{"\[ScriptCapitalB]", " ", "z", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "z"}], ")"}]}]], 
             RowBox[{"(", 
              RowBox[{
               FractionBox["z", "\[Xi]"], 
               FractionBox[
                RowBox[{"\[ScriptCapitalN]", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "z"}], ")"}], " ", 
                 RowBox[{"Log", "[", 
                  FractionBox["\[Xi]", 
                   RowBox[{"\[Xi]", "-", "z"}]], "]"}]}], 
                RowBox[{"\[ScriptCapitalB]", " ", "z"}]]}], ")"}]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z", "]"}], ",", "z", ",", 
         RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
     "First"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["sec", "\[Xi]"], "[", "z", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox["z", "\[Xi]"]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.711433975886159*^9, 3.711433991072525*^9}, {
   3.7114340770296164`*^9, 3.711434111260458*^9}, {3.711434202514422*^9, 
   3.7114342913822947`*^9}, 3.7114461142353277`*^9, {3.711446254253386*^9, 
   3.711446262844467*^9}, {3.711446365369894*^9, 3.711446372061371*^9}, {
   3.711446772476375*^9, 3.7114467841630917`*^9}, 3.711447069978993*^9, {
   3.711447133400799*^9, 3.711447160855138*^9}, {3.711452104563302*^9, 
   3.711452109978841*^9}, {3.711689686724687*^9, 3.711689713555806*^9}, {
   3.711801927580529*^9, 3.711801945971114*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Check", " ", "with", " ", "my", " ", "simplified", " ", "solution"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["sec", "\[Xi]"], "[", "z", "]"}], "/.", "%"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"2", 
        SuperscriptBox["\[ScriptCapitalN]", "2"]}], 
       SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          FractionBox[
           RowBox[{"\[Xi]", "-", "z"}], "z"], ")"}], " ", 
         RowBox[{"Log", "[", 
          FractionBox[
           RowBox[{"\[Xi]", "-", "z"}], "\[Xi]"], "]"}]}], "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"PolyLog", "[", 
           RowBox[{"2", ",", "1"}], "]"}], "-", 
          RowBox[{"PolyLog", "[", 
           RowBox[{"2", ",", 
            FractionBox["z", "\[Xi]"]}], "]"}]}], ")"}]}], " ", ")"}]}], " ", 
     ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711690581669384*^9, 3.711690679833262*^9}, {
  3.711794512098901*^9, 3.7117945152021313`*^9}, {3.711801952812492*^9, 
  3.7118019601232243`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times to \[Sigma]-level of chimerism", \
"Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}, {
  3.6779157947628508`*^9, 3.6779157995863657`*^9}}],

Cell["\<\
If we want to know if our mutant reaches a given level of clonality/chimerism \
(\[Sigma]), we need to modify the boundary conditions.\
\>", "Text",
 CellChangeTimes->{{3.69557591333808*^9, 3.695575967335421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[LessEqual]", "z", "\[LessEqual]", "\[Xi]"}], ",", 
     RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
     RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
     RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
     RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.711447104629136*^9, 3.711447106889133*^9}, 
   3.7118019724017467`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "Probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "''"}], "[", "z", "]"}], "\[Equal]", "0"}], ",", 
         
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "1"}]}], 
        "}"}], ",", 
       RowBox[{"\[Phi]", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
  3.668667378420467*^9, 3.668667380404291*^9}, {3.677406709476321*^9, 
  3.6774067219832897`*^9}, {3.677406764514456*^9, 3.677406783248962*^9}, {
  3.6774068183275948`*^9, 3.677406827751631*^9}, {3.6774799488636217`*^9, 
  3.6774799842536983`*^9}, {3.6774800356605387`*^9, 3.6774800392434473`*^9}, {
  3.677480074587178*^9, 3.677480076602214*^9}, {3.6774802739161453`*^9, 
  3.677480336530141*^9}, {3.677909832830461*^9, 3.677909863652874*^9}, {
  3.684146409670973*^9, 3.684146434701337*^9}, {3.711447220756666*^9, 
  3.711447222222681*^9}, {3.7118019748657703`*^9, 3.711801981001243*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"t", "''"}], "[", "z", "]"}], "\[Equal]", 
          RowBox[{"-", 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalB]", " ", "z", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
        "}"}], ",", 
       RowBox[{"t", "[", "z", "]"}], ",", "z", ",", 
       RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
   3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
   3.677310575463461*^9}, 3.67740691974185*^9, {3.677407222418562*^9, 
   3.677407223758267*^9}, {3.67740810744318*^9, 3.677408117362837*^9}, {
   3.677480131993122*^9, 3.677480186512088*^9}, {3.677480228061646*^9, 
   3.6774802445485077`*^9}, {3.677480373431834*^9, 3.6774803842953978`*^9}, {
   3.6774806819737186`*^9, 3.6774806828287992`*^9}, {3.6779098801164293`*^9, 
   3.677909880700451*^9}, {3.677909960626295*^9, 3.677909965841529*^9}, 
   3.684146447405238*^9, {3.684146492323386*^9, 3.684146494403393*^9}, {
   3.711447228461125*^9, 3.7114472451694*^9}, {3.7116897608183203`*^9, 
   3.7116897715136337`*^9}, {3.7118019856903267`*^9, 
   3.7118019934419823`*^9}, {3.711802071294606*^9, 3.7118020720144*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "''"}], "[", "z", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[ScriptCapitalN]", 
               RowBox[{"\[ScriptCapitalB]", " ", "z", 
                RowBox[{"(", 
                 RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
             FractionBox["z", 
              RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z", "]"}], ",", "z", ",", 
         RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
     "First"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox["z", 
         RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6774804062952137`*^9, 3.677480412966385*^9}, {
  3.677480579456427*^9, 3.677480592680192*^9}, {3.677480623998776*^9, 
  3.677480721756995*^9}, {3.67791581711384*^9, 3.6779158178977127`*^9}, {
  3.677915853481181*^9, 3.6779158809995203`*^9}, {3.6779292242820187`*^9, 
  3.677929225657383*^9}, {3.684146516883525*^9, 3.684146606839511*^9}, {
  3.6900208683919277`*^9, 3.69002087263065*^9}, {3.695575983538888*^9, 
  3.695576000088818*^9}, {3.71144182527181*^9, 3.71144182969525*^9}, {
  3.711447271298683*^9, 3.71144728250486*^9}, {3.711689779185422*^9, 
  3.711689794168777*^9}, {3.711802082031295*^9, 3.711802101486642*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "my", " ", "simplified", " ", "form"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "/.", "%"}], ")"}], "-", 
     
     RowBox[{"(", 
      RowBox[{
       FractionBox["\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Xi]", "-", "z"}], "z"], 
          RowBox[{"Log", "[", 
           FractionBox["\[Xi]", 
            RowBox[{"\[Xi]", "-", "z"}]], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "\[Sigma]"}], "]"}]}]}], ")"}]}], ")"}]}], ",", 
    RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711447339417123*^9, 3.711447432439258*^9}, {
  3.711689809584949*^9, 3.71168983582344*^9}, {3.7116898795977697`*^9, 
  3.711689893637302*^9}, {3.711690268247616*^9, 3.711690299654394*^9}, {
  3.7116903338371277`*^9, 3.711690434233481*^9}, {3.711802143804035*^9, 
  3.711802149293062*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Second", " ", 
    RowBox[{"moment", ":", " ", 
     RowBox[{"NEW", "!"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"DSolve", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"\[Theta]", "''"}], "[", "z", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"-", "2"}], 
            FractionBox["\[ScriptCapitalN]", 
             RowBox[{"\[ScriptCapitalB]", " ", "z", 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}]], 
            RowBox[{"(", 
             RowBox[{
              FractionBox["z", 
               RowBox[{"\[Sigma]", " ", "\[Xi]"}]], 
              FractionBox["\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 FractionBox[
                  RowBox[{"\[Xi]", "-", "z"}], "z"], 
                 RowBox[{"Log", "[", 
                  FractionBox["\[Xi]", 
                   RowBox[{"\[Xi]", "-", "z"}]], "]"}]}], "+", 
                RowBox[{
                 FractionBox["1", "\[Sigma]"], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Sigma]"}], ")"}], 
                 RowBox[{"Log", "[", 
                  RowBox[{"1", "-", "\[Sigma]"}], "]"}]}]}], ")"}]}], 
             ")"}]}]}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
          RowBox[{
           RowBox[{"\[Theta]", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], 
         "}"}], ",", 
        RowBox[{"\[Theta]", "[", "z", "]"}], ",", "z", ",", 
        RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], ",", 
      RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
    "First"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["sec", "\[Xi]"], "[", "z", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox["z", 
         RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.711447452655299*^9, 3.7114474791078033`*^9}, {
   3.711447585073863*^9, 3.71144761197608*^9}, {3.711447926581849*^9, 
   3.7114479802450027`*^9}, {3.711448096579438*^9, 3.711448099591017*^9}, {
   3.71145216604856*^9, 3.711452174719803*^9}, {3.711689845278886*^9, 
   3.711689854238624*^9}, 3.7116899089981413`*^9, 3.7116913106750603`*^9, {
   3.711802165660874*^9, 3.711802190002701*^9}}],

Cell[CellGroupData[{

Cell["Manual calculation to avoid imaginary numbers", "Subsubsection",
 CellChangeTimes->{{3.711449124909853*^9, 3.711449134375198*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", "f", "]"}]], "Input",
 CellChangeTimes->{{3.71144818895875*^9, 3.711448190060421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Integrating", " ", "the", " ", 
     RowBox[{"\[Theta]", "''"}], " ", "equation", " ", "gives", " ", "the", 
     " ", "following", " ", "solution"}], ",", " ", 
    RowBox[{
    "from", " ", "which", " ", "we", " ", "can", " ", "determine", " ", "the",
      " ", "integration", " ", "constants", " ", "c1", " ", "and", " ", 
     "c2"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", "z_", "]"}], ":=", 
    RowBox[{
     RowBox[{"-", "2"}], " ", 
     FractionBox[
      SuperscriptBox["\[ScriptCapitalN]", "2"], 
      RowBox[{
       SuperscriptBox["\[ScriptCapitalB]", "2"], " ", "\[Sigma]", " ", 
       "\[Xi]"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "z"}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}], 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"\[Xi]", "-", "z"}], "\[Xi]"], "]"}]}], "+", 
       RowBox[{"z", " ", 
        RowBox[{"PolyLog", "[", 
         RowBox[{"2", ",", 
          FractionBox["z", "\[Xi]"]}], "]"}]}], "-", 
       RowBox[{
        FractionBox["1", "\[Sigma]"], 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Sigma]"}], ")"}], 
        RowBox[{"Log", "[", 
         RowBox[{"1", "-", "\[Sigma]"}], "]"}], 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"Log", "[", 
           RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}]}], "+", 
       RowBox[{"c1", " ", "z"}], "+", "c2"}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"c", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"f", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"f", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
        "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"c1", ",", "c2"}], "}"}]}], "]"}], "//", 
     "First"}]}]}]}]], "Input",
 CellChangeTimes->{{3.711445759906762*^9, 3.7114459039939747`*^9}, {
  3.7114481807497463`*^9, 3.711448187500297*^9}, {3.711448291873681*^9, 
  3.7114483387272987`*^9}, {3.711690485711801*^9, 3.711690523510222*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"f", "[", "z", "]"}], "/.", "c"}], "]"}]], "Input",
 CellChangeTimes->{{3.711445907982535*^9, 3.711445914552537*^9}, 
   3.71144820451572*^9, 3.711448429868924*^9, 3.7118022172256517`*^9}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Test", " ", "with", " ", "second", " ", "moment", " ", "of", " ", 
   "fixation", " ", "time", " ", 
   RowBox[{"(", 
    RowBox[{"\[Sigma]", "=", "1"}], ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.711449155603196*^9, 3.711449178707427*^9}, {
  3.711690149355753*^9, 3.711690154499402*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"Limit", "[", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"f", "[", "z", "]"}], "/.", "c"}], 
      FractionBox["z", 
       RowBox[{"\[Sigma]", " ", "\[Xi]"}]]], ",", 
     RowBox[{"\[Sigma]", "\[Rule]", "1"}]}], "]"}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"2", 
       SuperscriptBox["\[ScriptCapitalN]", "2"]}], 
      SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         FractionBox[
          RowBox[{"\[Xi]", "-", "z"}], "z"], ")"}], " ", 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"\[Xi]", "-", "z"}], "\[Xi]"], "]"}]}], "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"PolyLog", "[", 
          RowBox[{"2", ",", "1"}], "]"}], "-", 
         RowBox[{"PolyLog", "[", 
          RowBox[{"2", ",", 
           FractionBox["z", "\[Xi]"]}], "]"}]}], ")"}]}], " ", ")"}]}], " ", 
    ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.711445989071352*^9, 3.7114459989022217`*^9}, {
   3.7114483635740232`*^9, 3.711448365213818*^9}, {3.711449181611537*^9, 
   3.711449249217004*^9}, 3.711690816781085*^9, {3.711794622086344*^9, 
   3.7117946244224043`*^9}, {3.711802232361259*^9, 3.71180224227308*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Check", " ", "my", " ", "simplified", " ", 
   RowBox[{"(", "rewritten", ")"}], " ", "solution"}], "*)"}]], "Input",
 CellChangeTimes->{{3.711690948125101*^9, 3.711690977173394*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gg", "=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      SuperscriptBox["\[ScriptCapitalN]", "2"]}], 
     SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"\[Xi]", "-", "z"}], "z"], " ", 
       RowBox[{"Log", "[", 
        FractionBox[
         RowBox[{"\[Xi]", "-", "z"}], "\[Xi]"], "]"}]}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"PolyLog", "[", 
         RowBox[{"2", ",", "\[Sigma]"}], "]"}], "-", " ", 
        RowBox[{"PolyLog", "[", 
         RowBox[{"2", ",", 
          FractionBox["z", "\[Xi]"]}], "]"}]}], ")"}], "+", 
      RowBox[{
       FractionBox[
        RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "-", "\[Sigma]"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Xi]", "-", "z"}], "z"], 
          RowBox[{"Log", "[", 
           FractionBox["\[Xi]", 
            RowBox[{"\[Xi]", "-", "z"}]], "]"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], 
          RowBox[{"Log", "[", 
           RowBox[{"1", "-", "\[Sigma]"}], "]"}]}], "-", "1"}], ")"}]}]}], 
     ")"}]}]}], ";"}], "\n", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"f", "[", "z", "]"}], "/.", "c"}], 
     FractionBox["z", 
      RowBox[{"\[Sigma]", " ", "\[Xi]"}]]], "-", "gg"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.711449318617049*^9, 3.71144938253233*^9}, {
   3.711449441947447*^9, 3.711449463578641*^9}, {3.711449700619499*^9, 
   3.71144984331035*^9}, {3.7114499558912687`*^9, 3.711449969290166*^9}, {
   3.7114503976685333`*^9, 3.711450411778762*^9}, {3.711451309655004*^9, 
   3.711451352675701*^9}, 3.71145138522921*^9, {3.711451426250176*^9, 
   3.7114514327126293`*^9}, {3.711451737824656*^9, 3.7114518070366096`*^9}, {
   3.711691002917303*^9, 3.711691033771359*^9}, {3.7116911019931602`*^9, 
   3.711691194335187*^9}, {3.7118022492485533`*^9, 3.711802264097659*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Advantageous clone", "Section",
 CellChangeTimes->{{3.677323077902556*^9, 3.677323082429555*^9}, {
  3.695576075431119*^9, 3.695576078581169*^9}}],

Cell[CellGroupData[{

Cell["Jacobian and eigensystem of neutral system", "Subsection",
 CellChangeTimes->{{3.668257551026848*^9, 3.668257552191036*^9}, {
  3.668313384779729*^9, 3.668313389091033*^9}, {3.668510030093388*^9, 
  3.6685100351252537`*^9}}],

Cell[TextData[{
 "Writing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["x", "\[Rule]"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["s", "1"], ",", 
       SubscriptBox["s", "2"], ",", 
       SubscriptBox["n", "1"], ",", 
       SubscriptBox["n", "2"]}], ")"}], "/", "N"}]}], TraditionalForm]]],
 ", the neutral ODEs for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", 
    RowBox[{
     OverscriptBox["x", "\[Rule]"], "/", "dt"}]}], TraditionalForm]]],
 " are given by:"
}], "Text",
 CellChangeTimes->{{3.6955736326165047`*^9, 3.6955736841102343`*^9}, {
  3.6955737872290983`*^9, 3.6955738201183767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"odesNeutral", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "\[Beta]"}], ")"}], "x3"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x1"}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", "\[Beta]"}], ")"}], "x4"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", "x3"}], "+", 
      RowBox[{"a", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "d"}], " ", "x4"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6682575831991*^9, 3.668257751936234*^9}, {
  3.677308948262648*^9, 3.677308994204137*^9}, {3.677309034596307*^9, 
  3.6773090467222757`*^9}, {3.695576121498086*^9, 3.695576122808425*^9}}],

Cell["\<\
The slow manifold is given by xStar. We then compute the Jacobian of the ODEs \
about this point.\
\>", "Text",
 CellChangeTimes->{{3.695573839219204*^9, 3.695573899281167*^9}, {
  3.695573932972476*^9, 3.69557396597019*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xStar", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "\[Rule]", 
        RowBox[{
         FractionBox["\[Beta]", "\[Delta]"], 
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], ",", 
       RowBox[{"x2", "\[Rule]", 
        RowBox[{
         FractionBox["\[Beta]", "\[Delta]"], "z"}]}], ",", 
       RowBox[{"x3", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
       RowBox[{"x4", "\[Rule]", "z"}]}], "}"}], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"d", " ", "\[Delta]"}], 
        RowBox[{"a", " ", "\[Beta]"}]]}]}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"odesNeutral", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "}"}]}], 
      "]"}], "/.", "xStar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "J", "]"}]}], "Input",
 CellChangeTimes->{{3.695573903138708*^9, 3.6955739227886744`*^9}, 
   3.695573970004027*^9, {3.695574000684684*^9, 3.6955740125537252`*^9}, {
   3.695576142641704*^9, 3.695576143935557*^9}, {3.695578047600287*^9, 
   3.695578052638955*^9}, {3.695578126939178*^9, 3.695578132000951*^9}}],

Cell[TextData[{
 "Now we compute the eigenvalues, and right & left eigenvectors of the \
neutral Jacobian, ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.695576180066536*^9, 3.695576197701112*^9}, {
   3.695578033431114*^9, 3.695578042141323*^9}, 3.70893195532397*^9}],

Cell[BoxData[
 RowBox[{"\[Lambda]", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668257903804352*^9, 3.668257936249565*^9}, {
  3.668258186073648*^9, 3.668258212881054*^9}, {3.668313280711825*^9, 
  3.6683132863668413`*^9}, {3.695578108771305*^9, 3.695578144016879*^9}}],

Cell[BoxData[
 RowBox[{"vLong", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682578845517*^9, 3.668257886467813*^9}, {
  3.668258005416245*^9, 3.66825803552743*^9}, {3.668313276512781*^9, 
  3.668313290470598*^9}, {3.6955783767347507`*^9, 3.6955783771560183`*^9}}],

Cell[BoxData[
 RowBox[{"uLong", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"Transpose", "[", "J", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668258062573778*^9, 3.668258066404913*^9}, {
   3.668313295630507*^9, 3.668313296054381*^9}, 3.668313396731451*^9, {
   3.695578379148731*^9, 3.6955783796522627`*^9}}],

Cell["\<\
For aesthetics, we make sure z does not appear in the denominator. We also \
normalise the left eigenvectors.\
\>", "Text",
 CellChangeTimes->{{3.695576326838492*^9, 3.695576366127243*^9}}],

Cell[BoxData[
 RowBox[{"vNorm", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"vLong", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"vLong", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}]], ",", 
     FractionBox[
      RowBox[{"vLong", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"vLong", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]], ",", 
     RowBox[{"z", 
      FractionBox[
       RowBox[{"vLong", "[", 
        RowBox[{"[", "3", "]"}], "]"}], 
       RowBox[{"vLong", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "4"}], "]"}], "]"}]]}], ",", 
     RowBox[{"z", 
      FractionBox[
       RowBox[{"vLong", "[", 
        RowBox[{"[", "4", "]"}], "]"}], 
       RowBox[{"vLong", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}]]}]}], "}"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.695576261568841*^9, 3.695576296622437*^9}, {
  3.69557817739298*^9, 3.6955781790404053`*^9}, {3.695578264440542*^9, 
  3.695578270526478*^9}, {3.695578388524782*^9, 3.6955783979506197`*^9}}],

Cell[BoxData[
 RowBox[{"uNorm", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"uLong", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{
       RowBox[{"uLong", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ".", 
       RowBox[{"vNorm", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668510555373578*^9, 3.668510577706005*^9}, {
  3.695578181272563*^9, 3.695578186839653*^9}, {3.695578402750791*^9, 
  3.695578405214717*^9}}],

Cell["\<\
The eigenvectors can be compactified further by expressing them in terms of \
the eigenvalues.
Here we check that our shortened forms fit with the solutions above, and that \
they are orthonormal.\
\>", "Text",
 CellChangeTimes->{{3.695576757362596*^9, 3.6955768127917957`*^9}, {
  3.695578340382938*^9, 3.695578347116832*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"v", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"-", "\[Beta]"}], "\[Delta]"], ",", 
        FractionBox["\[Beta]", "\[Delta]"], ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"\[Beta]", "+", "d"}], "d"], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"\[Beta]", "+", "d"}], "d"]}], ",", 
        RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}], 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]], 
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["\[Beta]", 
          RowBox[{"d", " ", "\[Delta]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "+", 
           FractionBox[
            RowBox[{"a", " ", "\[Beta]"}], "\[Delta]"]}], ")"}], "z"}], ",", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}], ",", "z"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}]], 
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
        RowBox[{
         FractionBox["\[Beta]", 
          RowBox[{"d", " ", "\[Delta]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "+", 
           FractionBox[
            RowBox[{"a", " ", "\[Beta]"}], "\[Delta]"]}], ")"}], "z"}], ",", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}], ",", "z"}], "}"}]}], 
     "\[IndentingNewLine]", "}"}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"d", " ", "\[Delta]"}], 
       RowBox[{"a", " ", "\[Beta]"}]]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"u", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"a", " ", "\[Beta]", " ", "\[Delta]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", "\[Beta]"}], "-", 
           RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}]}]], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "d"}], " ", "z"}], ",", 
         RowBox[{"d", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", "-", " ", "z"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "+", "d"}], ")"}]}], "z"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Beta]", "+", "d"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox[
        RowBox[{"a", " ", "d", " ", "\[Beta]"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", "\[Beta]"}], "-", 
           RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
           RowBox[{"d", " ", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}]}]], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", " ", "z"}], ",", 
         RowBox[{
          RowBox[{"-", "\[Delta]"}], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", "-", " ", "z"}], ")"}]}], ",", 
         RowBox[{
          RowBox[{"-", "\[Beta]"}], " ", "z"}], ",", 
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["a", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", "\[Beta]"}], "-", 
           RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "3", "]"}], "]"}], "+", 
           FractionBox[
            RowBox[{"a", " ", "\[Beta]"}], 
            RowBox[{"2", "\[Delta]"}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Beta]", "+", "d"}], ")"}], "\[Delta]"}], 
            RowBox[{"2", "\[Beta]"}]]}], ")"}]}]], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", " ", "\[Delta]"}], ",", 
         RowBox[{"d", " ", "\[Delta]"}], ",", 
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
           ")"}]}], ",", 
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
           ")"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["a", 
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"a", " ", "\[Beta]"}], "-", 
           RowBox[{"d", " ", "\[Delta]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Lambda]", "[", 
            RowBox[{"[", "4", "]"}], "]"}], "+", 
           FractionBox[
            RowBox[{"a", " ", "\[Beta]"}], 
            RowBox[{"2", "\[Delta]"}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{"\[Beta]", "+", "d"}], ")"}], "\[Delta]"}], 
            RowBox[{"2", "\[Beta]"}]]}], ")"}]}]], 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"d", " ", "\[Delta]"}], ",", 
         RowBox[{"d", " ", "\[Delta]"}], ",", 
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
           ")"}]}], ",", 
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            RowBox[{
             FractionBox[
              RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
           ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"d", " ", "\[Delta]"}], 
       RowBox[{"a", " ", "\[Beta]"}]]}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.695578216015052*^9, 3.695578219544037*^9}, {
  3.6955782788664083`*^9, 3.695578289447497*^9}, {3.6955784132006493`*^9, 
  3.69557841650179*^9}, {3.6955785101605577`*^9, 3.6955785562222424`*^9}}],

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  RowBox[{"vNorm", "-", "v"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"uNorm", "-", "u"}], "]"}]}], "Input",
 CellChangeTimes->{{3.668777106989574*^9, 3.66877712233244*^9}, {
  3.695576736979989*^9, 3.69557675121027*^9}, {3.6955782982392406`*^9, 
  3.695578306189044*^9}, {3.695578426035819*^9, 3.6955784314776297`*^9}}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"[", "i", "]"}], "]"}], ".", 
     RowBox[{"v", "[", 
      RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.695578367924515*^9, 3.695578370484455*^9}, {
  3.695578437789566*^9, 3.695578440083303*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Drift vector", "Subsection",
 CellChangeTimes->{{3.668663746520438*^9, 3.668663748407606*^9}}],

Cell["\<\
We find that the new drift vector along the slow-subspace satisfies \
\[Epsilon] u1.h, where h is the extra drift on the slow-manifold xStar due to \
the selective effect of \[Epsilon].\
\>", "Text",
 CellChangeTimes->{{3.6955768593447742`*^9, 3.6955769348218327`*^9}, {
  3.6955797589402227`*^9, 3.695579759546625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "\[Gamma]d"}], "+", 
           RowBox[{"\[Beta]", " ", "\[Gamma]\[Beta]"}]}], ")"}], "x4"}], "-", 
        
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Delta]", " ", "\[Gamma]\[Delta]"}], "+", 
           RowBox[{"a", " ", "\[Gamma]a", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], "x2"}]}], 
       ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "\[Gamma]d", " ", "x4"}], " ", "+", " ", 
        RowBox[{"a", " ", "\[Gamma]a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], "}"}], "/.",
      "xStar"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.69557857999722*^9, 3.69557877382694*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ".", "h"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6955787868930264`*^9, 3.695578807730257*^9}, {
  3.6955797815975924`*^9, 3.6955797830754557`*^9}}],

Cell[TextData[{
 "Again this can be written in a more compact form (as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", " ", 
    RowBox[{"z", "(", 
     RowBox[{"\[Xi]", "-", "z"}], ")"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ")."
}], "Text",
 CellChangeTimes->{{3.695577021346534*^9, 3.6955770544799013`*^9}, {
  3.6955772180308437`*^9, 3.695577231548636*^9}, {3.69557893187311*^9, 
  3.6955789346620913`*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{
       RowBox[{"u", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ".", "h"}]}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{"\[Epsilon]", 
      FractionBox[
       RowBox[{"a", " ", "d", " ", 
        SuperscriptBox["\[Beta]", "2"], " ", "\[Delta]"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", " ", "\[Beta]"}], "-", 
          RowBox[{"d", " ", "\[Delta]"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "\[Beta]"}], "+", 
          RowBox[{"d", " ", "\[Delta]"}], "+", 
          RowBox[{"\[Beta]", " ", "\[Delta]"}]}], ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{"\[Gamma]d", "-", "\[Gamma]a"}], ")"}]}], ")"}], "z", 
      RowBox[{"(", 
       RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ")"}]}], "/.", 
   RowBox[{"\[Xi]", "\[Rule]", 
    RowBox[{"1", "-", 
     FractionBox[
      RowBox[{"d", " ", "\[Delta]"}], 
      RowBox[{"a", " ", "\[Beta]"}]]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.66866397996664*^9, 3.668663997734776*^9}, {
   3.668664220263571*^9, 3.6686643065799837`*^9}, {3.6686644565594673`*^9, 
   3.6686644728698893`*^9}, {3.6955769943784037`*^9, 
   3.6955770066018248`*^9}, {3.6955770865554523`*^9, 3.695577105064086*^9}, {
   3.6955788368183823`*^9, 3.695578860665351*^9}, 3.6955789169282637`*^9, {
   3.695579787988243*^9, 3.695579792643886*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Slow subspace", "Subsection",
 CellChangeTimes->{{3.6685106794869328`*^9, 3.668510691621687*^9}, 
   3.695577381366755*^9}],

Cell[TextData[{
 "Our slow-subspace satisfies the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["x", "~"], "=", 
    RowBox[{
     SuperscriptBox["x", "*"], "+", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"f", "(", "z", ")"}]}]}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "z", ")"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " is given by:"
}], "Text",
 CellChangeTimes->{{3.6955789929984407`*^9, 3.695579054553976*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{"-", "1"}], 
        RowBox[{"\[Lambda]", "[", 
         RowBox[{"[", "k", "]"}], "]"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"u", "[", 
          RowBox[{"[", "k", "]"}], "]"}], ".", "h"}], ")"}], 
       RowBox[{"v", "[", 
        RowBox[{"[", "k", "]"}], "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"xTilde", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "/.", 
      "xStar"}], ")"}], "+", 
    RowBox[{"\[Epsilon]", " ", "f"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.668777889930395*^9, {3.6687779325037813`*^9, 3.668777938398926*^9}, {
   3.668778011101204*^9, 3.668778061634667*^9}, {3.6955790571381807`*^9, 
   3.695579062234375*^9}, {3.695579113838834*^9, 3.695579140897011*^9}, {
   3.69557918815242*^9, 3.6955791977656403`*^9}, {3.695579306658332*^9, 
   3.6955793099613457`*^9}, 3.695579397791819*^9, {3.695579718438501*^9, 
   3.695579718866437*^9}, {3.6956311541530867`*^9, 3.695631174553863*^9}}],

Cell[CellGroupData[{

Cell["Visualise slow subspace", "Subsubsection",
 CellChangeTimes->{{3.695628924841165*^9, 3.695628929200087*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ODE", " ", "solver"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solveODEs", "[", 
    RowBox[{"params_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paramSub", ",", "initialCondition", ",", "eqs", ",", "dSol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSub", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           FractionBox["sStar", 
            RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"initialCondition", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"s1", "[", "0", "]"}], "\[Equal]", "sStar"}], ",", 
         RowBox[{
          RowBox[{"s2", "[", "0", "]"}], "\[Equal]", "\[ScriptCapitalS]"}], 
         ",", 
         RowBox[{
          RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "nStar"}], ",", 
         RowBox[{
          RowBox[{"n2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eqs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"s1", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d1", "+", "\[Beta]1"}], ")"}], 
               RowBox[{"n1", "[", "t", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Delta]1", "+", 
                 RowBox[{"a1", 
                  FractionBox[
                   RowBox[{"\[ScriptCapitalN]", "-", 
                    RowBox[{"n1", "[", "t", "]"}], "-", 
                    RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}],
                 ")"}], 
               RowBox[{"s1", "[", "t", "]"}]}]}]}], " ", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"s2", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d2", "+", "\[Beta]2"}], ")"}], 
               RowBox[{"n2", "[", "t", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Delta]2", "+", 
                 RowBox[{"a2", 
                  FractionBox[
                   RowBox[{"\[ScriptCapitalN]", "-", 
                    RowBox[{"n1", "[", "t", "]"}], "-", 
                    RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}],
                 ")"}], 
               RowBox[{"s2", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"n1", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d1"}], " ", 
               RowBox[{"n1", "[", "t", "]"}]}], "+", 
              RowBox[{"a1", 
               FractionBox[
                RowBox[{"\[ScriptCapitalN]", "-", 
                 RowBox[{"n1", "[", "t", "]"}], "-", 
                 RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
               RowBox[{"s1", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"n2", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d2"}], " ", 
               RowBox[{"n2", "[", "t", "]"}]}], "+", 
              RowBox[{"a2", 
               FractionBox[
                RowBox[{"\[ScriptCapitalN]", "-", 
                 RowBox[{"n1", "[", "t", "]"}], "-", 
                 RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
               RowBox[{"s2", "[", "t", "]"}]}]}]}]}], "\[IndentingNewLine]", 
           "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a1", "\[Rule]", "a"}], ",", 
            RowBox[{"d1", "\[Rule]", "d"}], ",", 
            RowBox[{"\[Beta]1", "\[Rule]", "\[Beta]"}], ",", 
            RowBox[{"\[Delta]1", "\[Rule]", "\[Delta]"}], ",", 
            RowBox[{"a2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]a", " ", "\[Epsilon]"}]}], ")"}], "a"}]}], 
            ",", 
            RowBox[{"d2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]d", " ", "\[Epsilon]"}]}], ")"}], "d"}]}], 
            ",", 
            RowBox[{"\[Beta]2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]\[Beta]", " ", "\[Epsilon]"}]}], ")"}], 
              "\[Beta]"}]}], ",", 
            RowBox[{"\[Delta]2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]\[Delta]", " ", "\[Epsilon]"}]}], ")"}], 
              "\[Delta]"}]}]}], "}"}]}], ")"}], "/.", "paramSub"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dSol", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"eqs", "/.", "params"}], ",", 
             RowBox[{"initialCondition", "/.", "params"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s1", "[", "t", "]"}], ",", 
            RowBox[{"s2", "[", "t", "]"}], ",", 
            RowBox[{"n1", "[", "t", "]"}], ",", 
            RowBox[{"n2", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "dSol", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695629538258133*^9, 3.695629576123612*^9}, {
  3.695629607433374*^9, 3.69562967987818*^9}, {3.695629806801642*^9, 
  3.6956301246791553`*^9}, {3.6956303461026363`*^9, 3.6956303523023252`*^9}, {
  3.695630390125766*^9, 3.6956303984850597`*^9}, {3.6956304376428556`*^9, 
  3.695630467994227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plotting", " ", "function"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"pPlot", "[", 
    RowBox[{"i_", ",", "odeSols_", ",", "paramsTab_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "paramSub", ",", "xTilde", ",", "odeSols\[Section]i", ",", 
       "paramsTab\[Section]i", ",", "n\[Epsilon]", ",", "myCol", ",", 
       "plot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSub", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           FractionBox["sStar", 
            RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xTilde", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Beta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "z", "-", 
              FractionBox[
               RowBox[{"d", " ", "\[Delta]"}], 
               RowBox[{"a", " ", "\[Beta]"}]], "-", 
              FractionBox[
               RowBox[{"d", " ", "z", " ", "\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Beta]"}], 
                  "+", 
                  RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "d", " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}]}], "+", 
                  RowBox[{"\[Beta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"a", " ", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d", "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", "\[Delta]"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"a", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}]}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "2"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "3"]}]}], ")"}], " ", 
                "\[Epsilon]"}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"a", " ", "\[Beta]"}], "-", 
                   RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
                 "2"]}]]}], ")"}]}], "\[Delta]"], ",", 
          FractionBox[
           RowBox[{"z", " ", "\[Beta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "d", " ", "\[Beta]", " ", "\[Delta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", "z", " ", 
                    SuperscriptBox["\[Beta]", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "z"}], ")"}], " ", "\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                    "\[Delta]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Gamma]\[Beta]"}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", 
                    SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", "z", " ", 
                    SuperscriptBox["\[Beta]", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}]}], "+", 
                    RowBox[{"d", " ", "\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Gamma]a"}],
                     "+", "\[Gamma]d", "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]d", "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", "\[Delta]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Gamma]a"}],
                     "+", "\[Gamma]d", "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]d", "-", "\[Gamma]\[Beta]", "+", 
                    "\[Gamma]\[Delta]"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
                    SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "3"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[Gamma]\[Beta]"}], "+", 
                    "\[Gamma]\[Delta]"}], ")"}], " ", "\[Delta]"}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"a", " ", "\[Beta]"}], "-", 
                   RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
                 "2"]}]]}], ")"}]}], "\[Delta]"], ",", 
          RowBox[{"1", "-", "z", "-", 
           FractionBox[
            RowBox[{"d", " ", "\[Delta]"}], 
            RowBox[{"a", " ", "\[Beta]"}]], "+", 
           FractionBox[
            RowBox[{"d", " ", "z", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Beta]"}], 
               "+", 
               RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Gamma]a"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "-", "\[Gamma]\[Beta]", 
                    "+", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                  RowBox[{"d", " ", "\[Beta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Gamma]a"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "-", "\[Gamma]\[Beta]", 
                    "+", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], " ", "\[Gamma]a"}], "+", 
                    RowBox[{"3", " ", "\[Gamma]d"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", "\[Delta]"}], "-", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "+", 
               RowBox[{"a", " ", 
                SuperscriptBox["\[Beta]", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Beta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[Gamma]\[Beta]"}], "+", 
                    "\[Gamma]\[Delta]"}], ")"}], " ", "\[Delta]"}], "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], 
                 ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", "\[Beta]"}], "-", 
                RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
              "2"]}]]}], ",", 
          FractionBox[
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
               "2"], "+", 
              RowBox[{"d", " ", "\[Beta]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "\[Gamma]\[Beta]"}], "+", 
                    "\[Gamma]\[Delta]"}], ")"}], " ", "\[Delta]"}], "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
               " ", "\[Epsilon]"}], "+", 
              FractionBox[
               RowBox[{"a", " ", "d", " ", "z", " ", "\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Delta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SuperscriptBox["\[Beta]", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Gamma]a"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", "\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "\[Gamma]a"}], "-", 
                    RowBox[{"3", " ", "\[Gamma]d"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}], "+", 
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Gamma]a"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}]}], ")"}], " ", 
                    "\[Delta]"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}], " ", 
                    SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "+", 
                  RowBox[{"a", " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}], " ", "\[Delta]"}], "-", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "\[Beta]"}], "-", 
                  RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"]]}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
            "2"]]}], "}"}], "/.", "paramSub"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"odeSols\[Section]i", "=", 
       RowBox[{"odeSols", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"paramsTab\[Section]i", "=", 
       RowBox[{"paramsTab", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n\[Epsilon]", "=", 
       RowBox[{"Length", "[", "paramsTab\[Section]i", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"myCol", "=", 
       RowBox[{"col", "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ParametricPlot", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"s1", "[", "t", "]"}], ",", 
                  RowBox[{"s2", "[", "t", "]"}]}], "}"}], "/.", 
                RowBox[{"odeSols\[Section]i", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
            RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"myCol", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}],
             ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], " ", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ParametricPlot", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[ScriptCapitalN]", " ", 
                    RowBox[{"(", 
                    RowBox[{"xTilde", "/.", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    FractionBox["nStar", "\[ScriptCapitalN]"], " ", "x"}]}]}],
                     ")"}]}], ")"}], "/.", 
                  RowBox[{"paramsTab\[Section]i", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"myCol", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"Dashing", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.02", ",", "0.02"}], "}"}], "]"}], ",", 
                 RowBox[{"Thickness", "[", "0.01", "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], 
              "]"}]}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
             RowBox[{"Arrowheads", "[", "0.1", "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "0.3"}], "}"}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}], "]"}]}], "}"}], "]"}]}],
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "labelSize", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
               RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.54", ",", "0.74"}], "}"}], "]"}]}], "]"}], "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Max", "[", "\[Epsilon]Vals", "]"}]}], ")"}], 
                "\[Times]", " ", 
                RowBox[{"sStarVals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Max", "[", "\[Epsilon]Vals", "]"}]}], ")"}], 
                "\[Times]", 
                RowBox[{"sStarVals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(s\), \(2\)]\)\>\"", ",", 
                 "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(s\), \(1\)]\)\>\"", ",", 
                 "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)=\>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"sStarVals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", "labelSize",
                  ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], 
              "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"ticksSize", ",", 
             RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"52", ",", "15"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"45", ",", "30"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695629538258133*^9, 3.695629580582512*^9}, {
  3.695630150487031*^9, 3.695630181676609*^9}, {3.695631013791443*^9, 
  3.695631114395885*^9}, {3.695631260230754*^9, 3.695631261669949*^9}, {
  3.695631378907044*^9, 3.695631475942564*^9}, {3.695631567267468*^9, 
  3.695631570668131*^9}, {3.695631682351459*^9, 3.695631699935519*^9}, {
  3.695631731078377*^9, 3.695631769860447*^9}, {3.695631804276219*^9, 
  3.695631891312611*^9}, {3.695631969653493*^9, 3.6956322828525267`*^9}, {
  3.695632384248952*^9, 3.695632390143971*^9}, {3.6956324230726337`*^9, 
  3.695632423214795*^9}, {3.6956324840934772`*^9, 3.6956325866485863`*^9}, {
  3.695632640047977*^9, 3.695632640439431*^9}, {3.695632693206221*^9, 
  3.69563275965131*^9}, {3.6956328079392433`*^9, 3.695632896518944*^9}, {
  3.708931541539064*^9, 3.708931541562016*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Determine", " ", "parameters", " ", "and", " ", "evaluate", " ", 
    "trajectories", " ", "from", " ", "ODEs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sStarVals", "=", 
     RowBox[{"{", 
      RowBox[{"10", ",", "100"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nS", "=", 
     RowBox[{"Length", "[", "sStarVals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]Vals", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.1", ",", "0.5", ",", "1.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Epsilon]", "=", 
     RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"paramsFunc", "[", 
      RowBox[{"\[Section]sStar_", ",", "\[Section]\[Epsilon]_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
       RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
       RowBox[{"nStar", "\[Rule]", "9900"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", 
        RowBox[{"1.", "/", "39"}]}], ",", 
       RowBox[{"\[ScriptCapitalS]", "\[Rule]", "5000"}], ",", 
       RowBox[{"\[ScriptL]", "\[Rule]", 
        FractionBox["3", "1440."]}], ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "\[Section]\[Epsilon]"}], ",", 
       RowBox[{"\[Gamma]\[Beta]", "\[Rule]", "1"}], ",", 
       RowBox[{"\[Gamma]\[Delta]", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Gamma]d", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", "0"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"paramsTab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"paramsFunc", "[", 
          RowBox[{
           RowBox[{"sStarVals", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Epsilon]Vals", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"odeSols", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"solveODEs", "[", 
          RowBox[{
           RowBox[{"paramsTab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "T"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.677328790399165*^9, 3.6773289187142363`*^9}, {
   3.677329506822762*^9, 3.677329574499803*^9}, {3.677329635978705*^9, 
   3.677329636057755*^9}, {3.6773305896894817`*^9, 3.677330590209255*^9}, {
   3.6773852502724733`*^9, 3.677385267487152*^9}, 3.6773853076062117`*^9, {
   3.6773853748995943`*^9, 3.6773853757313757`*^9}, {3.6773855077028427`*^9, 
   3.677385508054625*^9}, {3.695629369729677*^9, 3.695629377544651*^9}, {
   3.695629416551139*^9, 3.695629455493663*^9}, {3.695630485801869*^9, 
   3.6956305306078377`*^9}, {3.695630632172306*^9, 3.695630634019733*^9}, {
   3.695630978999683*^9, 3.695631001735991*^9}, {3.695631272765643*^9, 
   3.6956313155474977`*^9}, {3.695631578242546*^9, 3.695631578362268*^9}, {
   3.6956322992889423`*^9, 3.6956323203120413`*^9}, {3.695632669363978*^9, 
   3.695632683412003*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Plot", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Row", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pPlot", "[", 
      RowBox[{"i", ",", "odeSols", ",", "paramsTab", ",", "T"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677386172076716*^9, 3.677386186149084*^9}, {
   3.6773862583949013`*^9, 3.677386259514772*^9}, {3.6773863749746933`*^9, 
   3.6773863770545893`*^9}, {3.695631457358231*^9, 3.69563151047719*^9}, {
   3.695632449083468*^9, 3.695632454549788*^9}, {3.6956324903220997`*^9, 
   3.695632492466007*^9}, 3.6956326629409943`*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Diffusion matrix", "Subsection",
 CellChangeTimes->{{3.668411114600995*^9, 3.668411118287931*^9}}],

Cell["\<\
We assume the diffusion coefficient is unchanged by selection, such that it \
is as described in the neutral case, i.e.\
\>", "Text",
 CellChangeTimes->{{3.6955753909918833`*^9, 3.695575429122048*^9}, {
  3.695579845733582*^9, 3.695579892817384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTilde", "=", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2", "a", " ", "d", " ", 
       RowBox[{"(", 
        RowBox[{"d", "+", "\[Beta]"}], ")"}], 
       SuperscriptBox["\[Beta]", "2"], " ", 
       SuperscriptBox["\[Delta]", "2"], " "}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"a", " ", "\[Beta]"}], "-", 
         RowBox[{"d", " ", "\[Delta]"}]}], ")"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], "2"]}]], 
     "z", 
     RowBox[{"(", 
      RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"d", " ", "\[Delta]"}], 
       RowBox[{"a", " ", "\[Beta]"}]]}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.668411453842161*^9, 3.668411548601388*^9}, {
  3.677309765016757*^9, 3.6773097806529016`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times", "Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}}],

Cell[TextData[{
 "We start the process on the slow manifold at the position z0. We want to \
know what is the probability our mutant reaches fixation (z=\[Xi]), and how \
long this takes.\nWe write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    RowBox[{"\[Epsilon]", " ", "\[ScriptCapitalN]", " ", 
     RowBox[{"\[ScriptCapitalA]", "/", "\[ScriptCapitalB]"}]}]}], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 " (const.)."
}], "Text",
 CellChangeTimes->{{3.695575671665298*^9, 3.6955757204814034`*^9}, {
  3.695575955351097*^9, 3.695575957543264*^9}, {3.695579953476364*^9, 
  3.695580018252986*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[LessEqual]", "z", "\[LessEqual]", "\[Xi]"}], ",", 
     RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
     RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
     RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
     RowBox[{"\[CapitalLambda]", ">", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7114539305683317`*^9, 3.711453967971332*^9}, {
   3.711719551168295*^9, 3.711719551528069*^9}, 3.711802295944006*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "Probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Phi]", "''"}], "[", "z", "]"}]}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "\[Xi]", "]"}], "\[Equal]", "1"}]}], "}"}], 
       ",", 
       RowBox[{"\[Phi]", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
   3.668667378420467*^9, 3.668667380404291*^9}, {3.677406709476321*^9, 
   3.6774067219832897`*^9}, {3.677406764514456*^9, 3.677406783248962*^9}, {
   3.6774068183275948`*^9, 3.677406827751631*^9}, {3.6774799488636217`*^9, 
   3.6774799842536983`*^9}, {3.6774800356605387`*^9, 
   3.6774800392434473`*^9}, {3.677480074587178*^9, 3.677480076602214*^9}, {
   3.6774802739161453`*^9, 3.677480336530141*^9}, 3.695580023273849*^9, {
   3.711453945364106*^9, 3.7114539466680803`*^9}, {3.711802302063142*^9, 
   3.711802309062686*^9}, {3.711802555959778*^9, 3.7118025569669857`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"t", "'"}], "[", "z", "]"}]}], "+", " ", 
           RowBox[{
            RowBox[{"t", "''"}], "[", "z", "]"}]}], "\[Equal]", 
          RowBox[{"-", 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalB]", " ", "z", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"t", "[", "z", "]"}], ",", "z", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"z", "<", "\[Xi]"}]}]}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
   3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
   3.677310575463461*^9}, 3.67740691974185*^9, {3.677407222418562*^9, 
   3.677407223758267*^9}, {3.67740810744318*^9, 3.677408117362837*^9}, {
   3.677480131993122*^9, 3.677480186512088*^9}, {3.677480228061646*^9, 
   3.6774802445485077`*^9}, {3.677480373431834*^9, 3.6774803842953978`*^9}, {
   3.6774806819737186`*^9, 3.6774806828287992`*^9}, {3.7114539744514637`*^9, 
   3.711453977342888*^9}, {3.711691984513385*^9, 3.711691990728565*^9}, 
   3.7117104284338093`*^9, {3.711710486878826*^9, 3.71171049959744*^9}, {
   3.711718851296792*^9, 3.7117188522966022`*^9}, {3.7118025372796793`*^9, 
   3.711802553350588*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "my", " ", "simplified", " ", "solution"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", "[", "z", "]"}], "/.", "%"}], ")"}], "-", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"-", "\[ScriptCapitalN]"}], 
       RowBox[{"\[ScriptCapitalB]", " ", "\[Xi]", " ", "\[CapitalLambda]"}]], 
      
      FractionBox["1", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", "1"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"EulerGamma", "+", 
           RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
           RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", "1"}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", "z", "]"}], "-", 
           RowBox[{"Log", "[", 
            RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", "1"}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"ExpIntegralEi", "[", 
          RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], ")"}]}], 
        "+", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
         RowBox[{"ExpIntegralEi", "[", 
          RowBox[{
           RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], ")"}]}]}], 
       ")"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711718797583435*^9, 3.711718845360715*^9}, {
   3.711718977157139*^9, 3.711718977556601*^9}, {3.7117190347709007`*^9, 
   3.711719035178281*^9}, {3.711719066609761*^9, 3.71171907708154*^9}, {
   3.7117191295764017`*^9, 3.711719136350656*^9}, {3.711719199261949*^9, 
   3.7117192611705236`*^9}, {3.7117211851927013`*^9, 3.711721186911528*^9}, 
   3.71179435096023*^9, {3.711802566046754*^9, 3.711802585421917*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalLambda]", " ", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "z", "]"}]}], "+", " ", 
             RowBox[{
              RowBox[{"\[Theta]", "''"}], "[", "z", "]"}]}], "\[Equal]", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[ScriptCapitalN]", 
               RowBox[{"\[ScriptCapitalB]", " ", "z", 
                RowBox[{"(", 
                 RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
             FractionBox[
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], 
                "]"}]}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z", "]"}], ",", "z", ",", 
         RowBox[{"Assumptions", "\[Rule]", 
          RowBox[{"z", "<", "\[Xi]"}]}]}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
     "First"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}]}]]}], 
       ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6774804062952137`*^9, 3.677480412966385*^9}, {
   3.677480579456427*^9, 3.677480592680192*^9}, {3.677480623998776*^9, 
   3.677480721756995*^9}, 3.695580089790978*^9, {3.711454025146639*^9, 
   3.711454031496674*^9}, {3.711454080304988*^9, 3.711454095880385*^9}, {
   3.711718988012644*^9, 3.711718998323813*^9}, {3.711721248838232*^9, 
   3.7117212749924507`*^9}, {3.711722745353842*^9, 3.711722746872964*^9}, {
   3.711802589501871*^9, 3.711802613500725*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "my", " ", "simplified", " ", "solution"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "/.", "%"}], ")"}], "-", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["\[ScriptCapitalN]", 
        RowBox[{" ", 
         RowBox[{
         "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", "\[Xi]"}]}]]}], 
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", "1"}], 
         ")"}]}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"EulerGamma", "+", 
           RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
           RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"3", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "-", 
           RowBox[{"3", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", "z", "]"}], "-", 
           RowBox[{"Log", "[", 
            RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "+", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], " ", 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{"\[CapitalLambda]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"ExpIntegralEi", "[", 
          RowBox[{
           RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"2", "\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{
           RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
         RowBox[{"ExpIntegralEi", "[", 
          RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "-", 
           RowBox[{"2", 
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}]}], ")"}]}]}],
        ")"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711721338077428*^9, 3.711721525037034*^9}, {
   3.711721622380019*^9, 3.711722198029622*^9}, {3.7117222332462254`*^9, 
   3.7117222476436977`*^9}, {3.71172229786684*^9, 3.71172243316499*^9}, {
   3.711722495085003*^9, 3.7117226451895647`*^9}, {3.7117227363238373`*^9, 
   3.711722794415514*^9}, {3.711787353675005*^9, 3.711787361617683*^9}, 
   3.711788041411483*^9, {3.711802623916852*^9, 3.711802661819579*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times to \[Sigma]-level of chimerism", \
"Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}, {
  3.6779157947628508`*^9, 3.6779157995863657`*^9}}],

Cell["\<\
If we want to know if our mutant reaches a given level of clonality/chimerism \
(\[Sigma]), we need to modify the boundary conditions.\
\>", "Text",
 CellChangeTimes->{{3.695580110885211*^9, 3.695580117009012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"assumptions", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"0", "\[LessEqual]", "z", "\[LessEqual]", "\[Xi]"}], ",", 
     RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
     RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
     RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
     RowBox[{"\[CapitalLambda]", ">", "0"}], ",", 
     RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.7114539305683317`*^9, 3.711453967971332*^9}, {
   3.711719551168295*^9, 3.711719551528069*^9}, {3.711792270241007*^9, 
   3.711792277472837*^9}, 3.7118027919588003`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "Probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "z", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Phi]", "''"}], "[", "z", "]"}]}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "1"}]}], 
        "}"}], ",", 
       RowBox[{"\[Phi]", "[", "z", "]"}], ",", "z"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
  3.668667378420467*^9, 3.668667380404291*^9}, {3.677406709476321*^9, 
  3.6774067219832897`*^9}, {3.677406764514456*^9, 3.677406783248962*^9}, {
  3.6774068183275948`*^9, 3.677406827751631*^9}, {3.6774799488636217`*^9, 
  3.6774799842536983`*^9}, {3.6774800356605387`*^9, 3.6774800392434473`*^9}, {
  3.677480074587178*^9, 3.677480076602214*^9}, {3.6774802739161453`*^9, 
  3.677480336530141*^9}, {3.677909832830461*^9, 3.677909863652874*^9}, {
  3.711792293521365*^9, 3.711792294331448*^9}, {3.711802795678463*^9, 
  3.711802804270112*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"t", "'"}], "[", "z", "]"}]}], "+", " ", 
           RowBox[{
            RowBox[{"t", "''"}], "[", "z", "]"}]}], "\[Equal]", 
          RowBox[{"-", 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalB]", " ", "z", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
        "}"}], ",", 
       RowBox[{"t", "[", "z", "]"}], ",", "z", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"z", "<", "\[Xi]"}]}]}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
   "First"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
   3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
   3.677310575463461*^9}, 3.67740691974185*^9, {3.677407222418562*^9, 
   3.677407223758267*^9}, {3.67740810744318*^9, 3.677408117362837*^9}, {
   3.677480131993122*^9, 3.677480186512088*^9}, {3.677480228061646*^9, 
   3.6774802445485077`*^9}, {3.677480373431834*^9, 3.6774803842953978`*^9}, {
   3.6774806819737186`*^9, 3.6774806828287992`*^9}, {3.6779098801164293`*^9, 
   3.677909880700451*^9}, {3.677909960626295*^9, 3.677909965841529*^9}, {
   3.71179258116746*^9, 3.7117926281323357`*^9}, {3.7118028084233103`*^9, 
   3.711802823309623*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "my", " ", "simplified", " ", "solution"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t", "[", "z", "]"}], "/.", "%"}], ")"}], "-", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["\[ScriptCapitalN]", 
       RowBox[{"\[ScriptCapitalB]", " ", "\[Xi]", " ", "\[CapitalLambda]"}]], 
      
      FractionBox["1", 
       RowBox[{
        RowBox[{"Exp", "[", 
         RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], "]"}], 
        "-", "1"}]], 
      RowBox[{"Exp", "[", 
       RowBox[{
        RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"EulerGamma", "+", 
           RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
           RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", "z", "]"}], "-", 
           RowBox[{"Log", "[", 
            RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
            "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", "1"}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"Exp", "[", 
          RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
         RowBox[{"ExpIntegralEi", "[", 
          RowBox[{
           RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", "\[Sigma]", "]"}], "-", 
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "\[Sigma]"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], "]"}],
            "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}]}], ")"}]}]}], " ", ")"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.71179273270306*^9, 3.7117927380977573`*^9}, {
  3.71179286010157*^9, 3.71179287476348*^9}, {3.711793088765439*^9, 
  3.711793698183729*^9}, {3.711793770678022*^9, 3.711793843490971*^9}, {
  3.711793879802306*^9, 3.711793907640511*^9}, {3.711793965247225*^9, 
  3.71179412134614*^9}, {3.711794295899836*^9, 3.711794337090146*^9}, {
  3.7118028349586983`*^9, 3.71180286577273*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalLambda]", " ", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "z", "]"}]}], "+", " ", 
             RowBox[{
              RowBox[{"\[Theta]", "''"}], "[", "z", "]"}]}], "\[Equal]", 
            RowBox[{
             RowBox[{"-", 
              FractionBox["\[ScriptCapitalN]", 
               RowBox[{"\[ScriptCapitalB]", " ", "z", 
                RowBox[{"(", 
                 RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
             FractionBox[
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
              RowBox[{"1", "-", 
               RowBox[{"Exp", "[", 
                RowBox[{
                 RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                 "\[Xi]"}], "]"}]}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z", "]"}], ",", "z", ",", 
         RowBox[{"Assumptions", "\[Rule]", 
          RowBox[{"z", "<", "\[Xi]"}]}]}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}], "//", 
     "First"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
            "\[Xi]"}], "]"}]}]]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", "assumptions"}]}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.6774804062952137`*^9, 3.677480412966385*^9}, {
   3.677480579456427*^9, 3.677480592680192*^9}, {3.677480623998776*^9, 
   3.677480721756995*^9}, {3.67791581711384*^9, 3.6779158178977127`*^9}, {
   3.677915853481181*^9, 3.6779158809995203`*^9}, {3.6779292242820187`*^9, 
   3.677929225657383*^9}, 3.6955801371961184`*^9, {3.7117946990703163`*^9, 
   3.711794706908052*^9}, {3.711794744851273*^9, 3.711794765109311*^9}, {
   3.711798282216062*^9, 3.711798283206627*^9}, {3.711802871652638*^9, 
   3.711802895971245*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Check", " ", "my", " ", "simplified", " ", "solution"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z", "]"}], "/.", "%"}], ")"}], "-", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      FractionBox["\[ScriptCapitalN]", 
       RowBox[{"\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", "\[Xi]"}]], 
      
      FractionBox["1", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Exp", "[", 
           RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], "]"}],
           "-", "1"}], ")"}], " "}]], 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"(", 
          RowBox[{"EulerGamma", "+", 
           RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
           RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Log", "[", "z", "]"}], "-", 
           RowBox[{"Log", "[", 
            RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
            "]"}]}], ")"}]}], "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], " ", 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{"\[CapitalLambda]", " ", 
              RowBox[{"(", 
               RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", "1"}], ")"}]}], "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}]}]}], 
          ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}], " ", 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{"\[CapitalLambda]", 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}], "-", 
           RowBox[{"ExpIntegralEi", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Xi]", " ", "\[Sigma]"}], 
            "]"}], "-", 
           RowBox[{
            RowBox[{"Exp", "[", 
             RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
             "]"}], 
            RowBox[{"ExpIntegralEi", "[", 
             RowBox[{
              RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
              "\[Xi]"}], "]"}]}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
          ")"}]}], "+", 
        RowBox[{
         RowBox[{"(", " ", 
          RowBox[{
           RowBox[{"Log", "[", 
            RowBox[{"1", "-", "\[Sigma]"}], "]"}], "-", 
           RowBox[{"Log", "[", "\[Sigma]", "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
            "]"}], "-", 
           RowBox[{"Exp", "[", 
            RowBox[{"\[CapitalLambda]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
            "]"}]}], ")"}]}]}], ")"}]}], ")"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.711794933011355*^9, 3.711795431421859*^9}, {
   3.711795663821774*^9, 3.711796007866012*^9}, {3.711796042056929*^9, 
   3.7117961914038057`*^9}, {3.71179626220874*^9, 3.7117963378268538`*^9}, {
   3.711796391181549*^9, 3.71179639419615*^9}, {3.711796460082819*^9, 
   3.711796530575186*^9}, {3.711796566461026*^9, 3.7117966239472227`*^9}, {
   3.711796733576836*^9, 3.711796736399743*^9}, {3.711796780837709*^9, 
   3.711796828027297*^9}, {3.711796895689849*^9, 3.71179698172013*^9}, {
   3.711797022493476*^9, 3.7117970738047743`*^9}, {3.711797114606559*^9, 
   3.7117972055688562`*^9}, {3.711797237966177*^9, 3.711797284893052*^9}, {
   3.7117973438260527`*^9, 3.7117973889440813`*^9}, {3.7117974270485153`*^9, 
   3.71179744983817*^9}, {3.711797494541841*^9, 3.711797510780074*^9}, 
   3.7117975602667637`*^9, {3.7117981711080647`*^9, 3.711798215273244*^9}, {
   3.71179826599192*^9, 3.711798300183832*^9}, {3.711802905979841*^9, 
   3.711802944130368*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["2.1 Mathematical analysis of time to clonality (general)", "Chapter",
 CellChangeTimes->{{3.695565335947528*^9, 3.695565371137779*^9}, {
   3.695707687496222*^9, 3.695707688552051*^9}, 3.708097272703266*^9, 
   3.708168154655459*^9, {3.708778080116268*^9, 3.70877808863305*^9}}],

Cell[CellGroupData[{

Cell["Neutral clone", "Section",
 CellChangeTimes->{{3.677308899376074*^9, 3.6773089013112497`*^9}, {
  3.677323066630706*^9, 3.677323068262315*^9}, {3.6955735452611856`*^9, 
  3.6955735491383543`*^9}}],

Cell[CellGroupData[{

Cell["Jacobian and eigensystem", "Subsection",
 CellChangeTimes->{{3.668257551026848*^9, 3.668257552191036*^9}, {
  3.668313384779729*^9, 3.668313389091033*^9}}],

Cell[TextData[{
 "Writing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["x", "\[Rule]"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["s", "1"], ",", 
       SubscriptBox["s", "2"], ",", 
       SubscriptBox["n", "1"], ",", 
       SubscriptBox["n", "2"]}], ")"}], "/", "N"}]}], TraditionalForm]]],
 ", the neutral ODEs for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", 
    RowBox[{
     OverscriptBox["x", "\[Rule]"], "/", "dt"}]}], TraditionalForm]]],
 " are given by:"
}], "Text",
 CellChangeTimes->{{3.6955736326165047`*^9, 3.6955736841102343`*^9}, {
  3.6955737872290983`*^9, 3.6955738201183767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"odes", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], "x3"}], 
      "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x1"}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], "x4"}], 
      "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", "d", "-", 
         RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", "x3"}], "+", 
      RowBox[{"a", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", "d", "-", 
         RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", "x4"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6682575831991*^9, 3.668257751936234*^9}, {
  3.677308948262648*^9, 3.677308994204137*^9}, {3.677309034596307*^9, 
  3.6773090467222757`*^9}, {3.708158921737846*^9, 3.708158932297564*^9}, {
  3.708171886204314*^9, 3.70817194619341*^9}}],

Cell["\<\
We can find the slow manifold by solving the stationary equations\
\>", "Text",
 CellChangeTimes->{{3.708675407902088*^9, 3.70867542662044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"odes", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}]}], "]"}]], "Input",\

 CellChangeTimes->{{3.7081594185043507`*^9, 3.7081594698941*^9}, {
  3.708159527284278*^9, 3.708159528491095*^9}, {3.708159586201128*^9, 
  3.708159587097208*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"Solve", "::", "svars"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Equations may not give solutions for all \\\"solve\\\" \
variables. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\
\\\", ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/Solve/svars\\\", \
ButtonNote -> \\\"Solve::svars\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.708159470464953*^9, 3.708159528958619*^9, 
  3.7081595877110567`*^9, 3.708172270675729*^9, 3.7081741044920692`*^9, 
  3.708668715900873*^9, 3.708931830224668*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"a", " ", "\[Beta]"}], "-", 
       RowBox[{"a", " ", "x4", " ", "\[Beta]"}], "-", 
       RowBox[{"d", " ", "\[Delta]"}], "-", 
       RowBox[{"a", " ", "\[Alpha]", " ", "\[Delta]"}], "+", 
       RowBox[{"a", " ", "x4", " ", "\[Alpha]", " ", "\[Delta]"}], "-", 
       RowBox[{"\[Alpha]", " ", 
        SuperscriptBox["\[Delta]", "2"]}], "+", 
       RowBox[{"\[Beta]", " ", "\[Delta]", " ", "\[Rho]"}]}], 
      RowBox[{"a", " ", "\[Delta]"}]], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Beta]", "-", 
        RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], 
      RowBox[{"(", 
       RowBox[{"\[Xi]", "-", "x4"}], ")"}]}]}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
          RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}], " ", "\[Delta]"}], 
       RowBox[{"a", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708160493380598*^9, 3.7081605539823637`*^9}, {
  3.708172836147911*^9, 3.708172851655463*^9}, {3.708174092479755*^9, 
  3.708174095239358*^9}, {3.708668742130925*^9, 3.708668745106892*^9}}],

Cell["\<\
The slow manifold is given by xStar. We then compute the Jacobian of the ODEs \
about this point.\
\>", "Text",
 CellChangeTimes->{{3.695573839219204*^9, 3.695573899281167*^9}, {
  3.695573932972476*^9, 3.69557396597019*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xStar", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], 
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], ",", 
       RowBox[{"x2", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], "z"}]}], ",", 
       RowBox[{"x3", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
       RowBox[{"x4", "\[Rule]", "z"}]}], "}"}], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}], " ", "\[Delta]"}], 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"odes", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "}"}]}], 
      "]"}], "/.", "xStar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "J", "]"}]}], "Input",
 CellChangeTimes->{{3.695573903138708*^9, 3.6955739227886744`*^9}, 
   3.695573970004027*^9, {3.695574000684684*^9, 3.6955740125537252`*^9}, {
   3.7081606836575537`*^9, 3.7081607135213013`*^9}, {3.708172903632111*^9, 
   3.708172905860756*^9}}],

Cell[TextData[{
 "Now we compute the eigenvalues, and right & left eigenvectors of ",
 Cell[BoxData[
  FormBox["J", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.695574046395015*^9, 3.6955740729446774`*^9}}],

Cell[BoxData[
 RowBox[{"\[Lambda]", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668257903804352*^9, 3.668257936249565*^9}, {
  3.668258186073648*^9, 3.668258212881054*^9}, {3.668313280711825*^9, 
  3.6683132863668413`*^9}}],

Cell[BoxData[
 RowBox[{"v", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682578845517*^9, 3.668257886467813*^9}, {
  3.668258005416245*^9, 3.66825803552743*^9}, {3.668313276512781*^9, 
  3.668313290470598*^9}}],

Cell[BoxData[
 RowBox[{"u", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"Transpose", "[", "J", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668258062573778*^9, 3.668258066404913*^9}, {
   3.668313295630507*^9, 3.668313296054381*^9}, 3.668313396731451*^9}],

Cell[TextData[{
 "Here we extract the first eigenvectors, corresponding to the zero \
eigenvalue. They are rescaled so that they look pretty and so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"v1", "\[CenterDot]", "u1"}], "=", "1"}], TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.695574103410289*^9, 3.6955741242000523`*^9}, {
  3.695574164407937*^9, 3.6955741949756327`*^9}, {3.6955742454087763`*^9, 
  3.6955742621407967`*^9}}],

Cell[BoxData[{
 RowBox[{"v1", "=", 
  RowBox[{"FullSimplify", "[", 
   FractionBox[
    RowBox[{"v", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{"v", "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "4"}], "]"}], "]"}]], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"u1", "=", 
  RowBox[{"FullSimplify", "[", 
   FractionBox[
    RowBox[{"u", "[", 
     RowBox[{"[", "1", "]"}], "]"}], 
    RowBox[{
     RowBox[{"u", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ".", "v1"}]], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"v1", ".", "u1"}], "]"}]}], "Input",
 CellChangeTimes->{{3.6683134066592712`*^9, 3.668313409690284*^9}, {
  3.668313471912043*^9, 3.668313526798155*^9}, {3.6685970487541924`*^9, 
  3.668597048962077*^9}, {3.6955742673004913`*^9, 3.695574282255293*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Diffusion matrix", "Subsection",
 CellChangeTimes->{{3.668411114600995*^9, 3.668411118287931*^9}}],

Cell["\<\
By considering the individual-based reactions, we can construct \
multiplicative diffusion matrix for the SDE approximation.
We can then evaluate this on the slow-manifold xStar.\
\>", "Text",
 CellChangeTimes->{{3.6955743245523863`*^9, 3.695574382148737*^9}, {
  3.6955744131777563`*^9, 3.69557444052248*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], 
         "x3"}], " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], "x1"}]}], 
       ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x3"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", "0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], 
         "x4"}], " ", "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Delta]", "+", 
           RowBox[{"a", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], "x2"}]}], 
       ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x4"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x3"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", "\[VeryThinSpace] ", "\[Beta]"}], "+", "d", "+", 
           
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", "x3"}], "+", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", "0"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "d"}], " ", "x4"}], "-", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}], ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", " ", "\[Beta]"}], "+", "d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", "x4"}], "+", 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], "}"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.668598697363703*^9, 3.668598757580647*^9}, {
   3.6685988006357517`*^9, 3.668598857889097*^9}, {3.668598890760662*^9, 
   3.668598934030899*^9}, {3.6773092220441713`*^9, 3.677309229395602*^9}, {
   3.677309485091032*^9, 3.677309649053141*^9}, 3.695574391894211*^9, {
   3.708162138789483*^9, 3.7081621503817368`*^9}, {3.708173443486598*^9, 
   3.708173467389216*^9}, {3.708173568385659*^9, 3.7081735840010633`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"B", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"B", "/.", "xStar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "B", "]"}]}], "Input",
 CellChangeTimes->{{3.668598940890915*^9, 3.668598962368547*^9}, {
   3.668599042323842*^9, 3.668599068434012*^9}, 3.677309716659997*^9, {
   3.695574401061257*^9, 3.6955744017724323`*^9}}],

Cell["\<\
New diffusion coefficient, which is teh diffusion matrix projected onto the \
slow-manifold direction using the leading left eigenvector.\
\>", "Text",
 CellChangeTimes->{{3.695575131328445*^9, 3.695575153934256*^9}, {
  3.6955751842140083`*^9, 3.69557519082962*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"u1", ".", 
   RowBox[{"(", 
    RowBox[{"B", ".", "u1"}], ")"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.668411221124408*^9, 3.668411235243884*^9}, {
  3.695575377469091*^9, 3.695575382796157*^9}}],

Cell["Let\[CloseCurlyQuote]s write that in a neater form.", "Text",
 CellChangeTimes->{{3.6955753909918833`*^9, 3.695575429122048*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTilde", "=", 
   RowBox[{
    RowBox[{"2", 
     FractionBox[
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], 
       SuperscriptBox["\[Delta]", "2"], 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"\[Alpha]", " ", "\[Delta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], 
      RowBox[{"\[Xi]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
          RowBox[{"\[Beta]", " ", "d"}], "+", 
          RowBox[{"d", " ", "\[Delta]"}], "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "-", 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], "-", 
          RowBox[{"\[Rho]", " ", "\[Beta]", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
             RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}], 
        "2"]}]], "z", 
     RowBox[{"(", 
      RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
          RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}], " ", "\[Delta]"}], 
       RowBox[{"a", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.668411453842161*^9, 3.668411548601388*^9}, {
   3.677309765016757*^9, 3.6773097806529016`*^9}, 3.708164381702585*^9, 
   3.7081748354314327`*^9, {3.708669034610055*^9, 3.7086690362492657`*^9}, 
   3.708768568945323*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"u1", ".", 
     RowBox[{"(", 
      RowBox[{"B", ".", "u1"}], ")"}]}], "-", "BTilde"}], "]"}]}]], "Input"],

Cell[TextData[{
 "The coefficient, which we write as \[ScriptCapitalB] in the manuscript, can \
be expressed in terms of the fundamental parameters (",
 Cell[BoxData[
  FormBox[
   RowBox[{
   "\[Beta]", ",", "\[ScriptCapitalN]", ",", "s", ",", "n", ",", 
    "\[ScriptL]"}], TraditionalForm]]],
 ").\nTo this end we solve the expression for s*, n*, and ",
 Cell[BoxData[
  FormBox["\[ScriptL]", TraditionalForm]],
  FormatType->"TraditionalForm"],
 " in terms of a, d, and \[Delta]."
}], "Text",
 CellChangeTimes->{{3.695575431707925*^9, 3.695575507043271*^9}, {
  3.708669193435565*^9, 3.708669235449307*^9}}],

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s", "\[Equal]", 
      RowBox[{
       FractionBox[
        RowBox[{"\[Beta]", "-", 
         RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], "n"}]}], ",", 
     RowBox[{
      RowBox[{"n", "\[Equal]", 
       RowBox[{"\[ScriptCapitalN]", " ", "\[Xi]"}]}], "/.", 
      RowBox[{"\[Xi]", "\[Rule]", 
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
            RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}], " ", "\[Delta]"}], 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], ",", 
     RowBox[{"\[ScriptL]", "==", 
      FractionBox["1", 
       RowBox[{"\[Delta]", "+", 
        RowBox[{"a", 
         FractionBox[
          RowBox[{"(", 
           RowBox[{"\[ScriptCapitalN]", "-", "n"}], ")"}], 
          "\[ScriptCapitalN]"]}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"a", ",", "d", ",", "\[Delta]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.708669109670816*^9, 3.708669167965024*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paramSub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "\[ScriptL]"], "-", 
         FractionBox[
          RowBox[{"n", " ", "\[Beta]"}], 
          RowBox[{"s", "+", 
           RowBox[{"\[Alpha]", " ", "n"}]}]]}], ")"}], 
       FractionBox["\[ScriptCapitalN]", 
        RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}], ",", 
     RowBox[{"d", "\[Rule]", 
      RowBox[{
       FractionBox["s", 
        RowBox[{"n", " ", "\[ScriptL]"}]], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}]}], ",", 
     RowBox[{"\[Delta]", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Beta]", " ", "n"}], 
       RowBox[{"s", "+", 
        RowBox[{"\[Alpha]", " ", "n"}]}]]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.708757026271194*^9, 3.708757087735125*^9}, {
  3.708757125670392*^9, 3.7087571601561213`*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Beta]", 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], 
       SuperscriptBox["\[Delta]", "2"], 
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{"\[Alpha]", " ", "\[Delta]", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], 
      RowBox[{"\[Xi]", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
          RowBox[{"\[Beta]", " ", "d"}], "+", 
          RowBox[{"d", " ", "\[Delta]"}], "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "-", 
             RowBox[{"(", 
              RowBox[{"d", "+", 
               RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], "-", 
          RowBox[{"\[Rho]", " ", "\[Beta]", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
             RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}], 
        "2"]}]], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}], " ", "\[Delta]"}], 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], ")"}], "/.",
    "paramSub"}], "]"}]], "Input",
 CellChangeTimes->{{3.708669305848485*^9, 3.708669318327414*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    FractionBox[
     RowBox[{"n", " ", "\[ScriptCapitalN]", " ", 
      RowBox[{"(", 
       RowBox[{"s", "+", 
        RowBox[{"n", " ", "\[Alpha]"}]}], ")"}], " ", "\[Beta]", " ", 
      RowBox[{"(", 
       RowBox[{"s", "+", 
        RowBox[{"n", " ", 
         RowBox[{"(", 
          RowBox[{"\[Alpha]", "+", 
           RowBox[{"\[ScriptL]", " ", "\[Beta]", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Rho]"}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "s"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{"s", "+", 
           RowBox[{"n", " ", "\[Alpha]"}]}], ")"}]}], "-", 
        RowBox[{"n", " ", "s", " ", "\[ScriptL]", " ", "\[Beta]"}]}], ")"}], 
      "2"]], "-", 
    FractionBox[
     RowBox[{"\[Beta]", " ", "n", " ", "\[ScriptCapitalN]", 
      RowBox[{"(", 
       RowBox[{"s", "+", 
        RowBox[{"\[Alpha]", " ", "n"}]}], ")"}], 
      RowBox[{"(", 
       RowBox[{"s", "+", 
        RowBox[{"\[Alpha]", " ", "n"}], "-", 
        RowBox[{"n", " ", "\[ScriptL]", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"n", "+", "s"}], ")"}], 
         RowBox[{"(", 
          RowBox[{"s", "+", 
           RowBox[{"\[Alpha]", " ", "n"}]}], ")"}]}], "-", 
        RowBox[{"n", " ", "s", " ", "\[ScriptL]", " ", "\[Beta]"}]}], ")"}], 
      "2"]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7086693468567038`*^9, 3.7086694173712893`*^9}}],

Cell[CellGroupData[{

Cell["Visualise", "Subsubsection",
 CellChangeTimes->{{3.7086697335048447`*^9, 3.7086697345920057`*^9}}],

Cell[BoxData[
 RowBox[{"ContourPlot", "[", 
  RowBox[{
   RowBox[{"Evaluate", "[", 
    RowBox[{
     FractionBox[
      FractionBox[
       RowBox[{"\[Beta]", " ", "n", " ", "\[ScriptCapitalN]", 
        RowBox[{"(", 
         RowBox[{"s", "+", 
          RowBox[{"\[Alpha]", " ", "n"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"s", "+", 
          RowBox[{"\[Alpha]", " ", "n"}], "-", 
          RowBox[{"n", " ", "\[ScriptL]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "s"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"s", "+", 
             RowBox[{"\[Alpha]", " ", "n"}]}], ")"}]}], "-", 
          RowBox[{"n", " ", "s", " ", "\[ScriptL]", " ", "\[Beta]"}]}], ")"}],
         "2"]], 
      FractionBox[
       RowBox[{"\[Beta]", " ", "n", " ", "\[ScriptCapitalN]", 
        RowBox[{"(", 
         RowBox[{"s", "+", 
          RowBox[{"0", "\[Alpha]", " ", "n"}]}], ")"}], 
        RowBox[{"(", 
         RowBox[{"s", "+", 
          RowBox[{"0", "\[Alpha]", " ", "n"}], "-", 
          RowBox[{"n", " ", "\[ScriptL]", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"0", "\[Rho]"}]}], ")"}], "\[Beta]"}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"n", "+", "s"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"s", "+", 
             RowBox[{"0", "\[Alpha]", " ", "n"}]}], ")"}]}], "-", 
          RowBox[{"n", " ", "s", " ", "\[ScriptL]", " ", "\[Beta]"}]}], ")"}],
         "2"]]], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Beta]", "\[Rule]", 
        FractionBox["1.", "39."]}], ",", 
       RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
       RowBox[{"n", "\[Rule]", "9900"}], ",", 
       RowBox[{"s", "\[Rule]", "1"}], ",", 
       RowBox[{"\[ScriptL]", "\[Rule]", 
        FractionBox["5.", "1440."]}], ",", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        SuperscriptBox["10", "log\[Alpha]"]}], ",", 
       RowBox[{"\[Rho]", "\[Rule]", 
        SuperscriptBox["10", "log\[Rho]"]}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"log\[Alpha]", ",", 
     RowBox[{"-", "4"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"log\[Rho]", ",", 
     RowBox[{"-", "4"}], ",", "0"}], "}"}], ",", 
   RowBox[{"Contours", "\[Rule]", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"0.5", "i"}]}], ")"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "0", ",", "20"}], "}"}]}], "]"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", "Automatic"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7086697420952253`*^9, 3.708669840017688*^9}, {
   3.708669876108239*^9, 3.708670016304015*^9}, {3.708670992654117*^9, 
   3.708671015436564*^9}, 3.7086710549556837`*^9, {3.7086710936257477`*^9, 
   3.708671144222994*^9}, {3.7086712520691633`*^9, 3.7086712535880823`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times to \[Sigma]-level of chimerism", \
"Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}, {
  3.6779157947628508`*^9, 3.6779157995863657`*^9}}],

Cell["\<\
If we want to know if our mutant reaches a given level of clonality/chimerism \
(\[Sigma]), we need to modify the boundary conditions.\
\>", "Text",
 CellChangeTimes->{{3.69557591333808*^9, 3.695575967335421*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "Probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[Phi]", "''"}], "[", "z0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "1"}]}], 
        "}"}], ",", 
       RowBox[{"\[Phi]", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}]}], "}"}]}]}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
  3.668667378420467*^9, 3.668667380404291*^9}, {3.677406709476321*^9, 
  3.6774067219832897`*^9}, {3.677406764514456*^9, 3.677406783248962*^9}, {
  3.6774068183275948`*^9, 3.677406827751631*^9}, {3.6774799488636217`*^9, 
  3.6774799842536983`*^9}, {3.6774800356605387`*^9, 3.6774800392434473`*^9}, {
  3.677480074587178*^9, 3.677480076602214*^9}, {3.6774802739161453`*^9, 
  3.677480336530141*^9}, {3.677909832830461*^9, 3.677909863652874*^9}, {
  3.684146409670973*^9, 3.684146434701337*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", " ", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"t", "''"}], "[", "z0", "]"}], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "\[ScriptCapitalN]"}], "\[ScriptCapitalB]"], 
           FractionBox["1", 
            RowBox[{"z0", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
        "}"}], ",", 
       RowBox[{"t", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
        RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}]}], "}"}]}]}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
   3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
   3.677310575463461*^9}, 3.67740691974185*^9, {3.677407222418562*^9, 
   3.677407223758267*^9}, {3.67740810744318*^9, 3.677408117362837*^9}, {
   3.677480131993122*^9, 3.677480186512088*^9}, {3.677480228061646*^9, 
   3.6774802445485077`*^9}, {3.677480373431834*^9, 3.6774803842953978`*^9}, {
   3.6774806819737186`*^9, 3.6774806828287992`*^9}, {3.6779098801164293`*^9, 
   3.677909880700451*^9}, {3.677909960626295*^9, 3.677909965841529*^9}, 
   3.684146447405238*^9, {3.684146492323386*^9, 3.684146494403393*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[Theta]", "''"}], "[", "z0", "]"}], "\[Equal]", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "\[ScriptCapitalN]"}], "\[ScriptCapitalB]"], 
             FractionBox[
              FractionBox["z0", 
               RowBox[{"\[Sigma]", " ", "\[Xi]"}]], 
              RowBox[{"z0", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
          RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
          RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
          RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
          RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}]}], "}"}]}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z0", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z0", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox["z0", 
         RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
        RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6774804062952137`*^9, 3.677480412966385*^9}, {
  3.677480579456427*^9, 3.677480592680192*^9}, {3.677480623998776*^9, 
  3.677480721756995*^9}, {3.67791581711384*^9, 3.6779158178977127`*^9}, {
  3.677915853481181*^9, 3.6779158809995203`*^9}, {3.6779292242820187`*^9, 
  3.677929225657383*^9}, {3.684146516883525*^9, 3.684146606839511*^9}, {
  3.6900208683919277`*^9, 3.69002087263065*^9}, {3.695575983538888*^9, 
  3.695576000088818*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Advantageous clone", "Section",
 CellChangeTimes->{{3.677323077902556*^9, 3.677323082429555*^9}, {
  3.695576075431119*^9, 3.695576078581169*^9}}],

Cell[CellGroupData[{

Cell["Jacobian and eigensystem of neutral system", "Subsection",
 CellChangeTimes->{{3.668257551026848*^9, 3.668257552191036*^9}, {
  3.668313384779729*^9, 3.668313389091033*^9}, {3.668510030093388*^9, 
  3.6685100351252537`*^9}}],

Cell[TextData[{
 "Writing ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["x", "\[Rule]"], "=", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["s", "1"], ",", 
       SubscriptBox["s", "2"], ",", 
       SubscriptBox["n", "1"], ",", 
       SubscriptBox["n", "2"]}], ")"}], "/", "N"}]}], TraditionalForm]]],
 ", the neutral ODEs for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"d", 
    RowBox[{
     OverscriptBox["x", "\[Rule]"], "/", "dt"}]}], TraditionalForm]]],
 " are given by:"
}], "Text",
 CellChangeTimes->{{3.6955736326165047`*^9, 3.6955736841102343`*^9}, {
  3.6955737872290983`*^9, 3.6955738201183767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"odesNeutral", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], "x3"}], 
      "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x1"}]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"d", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], "x4"}], 
      "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Delta]", "+", 
         RowBox[{"a", 
          RowBox[{"(", 
           RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], " ", 
       "x2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", "d", "-", 
         RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", "x3"}], "+", 
      RowBox[{"a", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x1"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", "d", "-", 
         RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", "x4"}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6682575831991*^9, 3.668257751936234*^9}, {
  3.677308948262648*^9, 3.677308994204137*^9}, {3.677309034596307*^9, 
  3.6773090467222757`*^9}, {3.695576121498086*^9, 3.695576122808425*^9}, {
  3.708675435133224*^9, 3.70867544394044*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paramSub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"a", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "\[ScriptL]"], "-", 
         FractionBox[
          RowBox[{"n", " ", "\[Beta]"}], 
          RowBox[{"s", "+", 
           RowBox[{"\[Alpha]", " ", "n"}]}]]}], ")"}], 
       FractionBox["\[ScriptCapitalN]", 
        RowBox[{"\[ScriptCapitalN]", "-", "n"}]]}]}], ",", 
     RowBox[{"d", "\[Rule]", 
      RowBox[{
       FractionBox["s", 
        RowBox[{"n", " ", "\[ScriptL]"}]], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}]}], ",", 
     RowBox[{"\[Delta]", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Beta]", " ", "n"}], 
       RowBox[{"s", "+", 
        RowBox[{"\[Alpha]", " ", "n"}]}]]}]}], "}"}]}], ";"}]], "Input"],

Cell["\<\
The slow manifold is given by xStar. We then compute the Jacobian of the ODEs \
about this point.\
\>", "Text",
 CellChangeTimes->{{3.695573839219204*^9, 3.695573899281167*^9}, {
  3.695573932972476*^9, 3.69557396597019*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xStar", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x1", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], 
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], ",", 
       RowBox[{"x2", "\[Rule]", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], "z"}]}], ",", 
       RowBox[{"x3", "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
       RowBox[{"x4", "\[Rule]", "z"}]}], "}"}], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"\[Delta]", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}]}], 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"odesNeutral", ",", 
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "}"}]}], 
      "]"}], "/.", "xStar"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "J", "]"}]}], "Input",
 CellChangeTimes->{{3.695573903138708*^9, 3.6955739227886744`*^9}, 
   3.695573970004027*^9, {3.695574000684684*^9, 3.6955740125537252`*^9}, {
   3.695576142641704*^9, 3.695576143935557*^9}, {3.695578047600287*^9, 
   3.695578052638955*^9}, {3.695578126939178*^9, 3.695578132000951*^9}, {
   3.7086754527236443`*^9, 3.7086754810356283`*^9}}],

Cell[TextData[{
 "Now we compute the eigenvalues, and right & left eigenvectors of the \
neutral Jacobian,",
 Cell[BoxData[
  FormBox["J", TraditionalForm]]],
 "."
}], "Text",
 CellChangeTimes->{{3.695576180066536*^9, 3.695576197701112*^9}, {
  3.695578033431114*^9, 3.695578042141323*^9}}],

Cell[BoxData[
 RowBox[{"\[Lambda]", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvalues", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668257903804352*^9, 3.668257936249565*^9}, {
  3.668258186073648*^9, 3.668258212881054*^9}, {3.668313280711825*^9, 
  3.6683132863668413`*^9}, {3.695578108771305*^9, 3.695578144016879*^9}}],

Cell[BoxData[
 RowBox[{"vLong", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", "J", "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6682578845517*^9, 3.668257886467813*^9}, {
  3.668258005416245*^9, 3.66825803552743*^9}, {3.668313276512781*^9, 
  3.668313290470598*^9}, {3.6955783767347507`*^9, 3.6955783771560183`*^9}}],

Cell[BoxData[
 RowBox[{"uLong", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"Eigenvectors", "[", 
     RowBox[{"Transpose", "[", "J", "]"}], "]"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", ">", "0"}], ",", 
       RowBox[{"d", ">", "0"}], ",", 
       RowBox[{"\[Delta]", ">", "0"}], ",", 
       RowBox[{"\[Beta]", ">", "0"}], ",", 
       RowBox[{"z", ">", "0"}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668258062573778*^9, 3.668258066404913*^9}, {
   3.668313295630507*^9, 3.668313296054381*^9}, 3.668313396731451*^9, {
   3.695578379148731*^9, 3.6955783796522627`*^9}}],

Cell["\<\
For aesthetics, we make sure z does not appear in the denominator. We also \
normalise the left eigenvectors.\
\>", "Text",
 CellChangeTimes->{{3.695576326838492*^9, 3.695576366127243*^9}}],

Cell[BoxData[
 RowBox[{"vNorm", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"vLong", "[", 
       RowBox[{"[", "1", "]"}], "]"}], 
      RowBox[{"vLong", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "4"}], "]"}], "]"}]], ",", 
     FractionBox[
      RowBox[{"vLong", "[", 
       RowBox[{"[", "2", "]"}], "]"}], 
      RowBox[{"vLong", "[", 
       RowBox[{"[", 
        RowBox[{"2", ",", "4"}], "]"}], "]"}]], ",", 
     RowBox[{"z", 
      FractionBox[
       RowBox[{"vLong", "[", 
        RowBox[{"[", "3", "]"}], "]"}], 
       RowBox[{"vLong", "[", 
        RowBox[{"[", 
         RowBox[{"3", ",", "4"}], "]"}], "]"}]]}], ",", 
     RowBox[{"z", 
      FractionBox[
       RowBox[{"vLong", "[", 
        RowBox[{"[", "4", "]"}], "]"}], 
       RowBox[{"vLong", "[", 
        RowBox[{"[", 
         RowBox[{"4", ",", "4"}], "]"}], "]"}]]}]}], "}"}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.695576261568841*^9, 3.695576296622437*^9}, {
  3.69557817739298*^9, 3.6955781790404053`*^9}, {3.695578264440542*^9, 
  3.695578270526478*^9}, {3.695578388524782*^9, 3.6955783979506197`*^9}}],

Cell[BoxData[
 RowBox[{"uNorm", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     FractionBox[
      RowBox[{"uLong", "[", 
       RowBox[{"[", "i", "]"}], "]"}], 
      RowBox[{
       RowBox[{"uLong", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ".", 
       RowBox[{"vNorm", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}]], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668510555373578*^9, 3.668510577706005*^9}, {
  3.695578181272563*^9, 3.695578186839653*^9}, {3.695578402750791*^9, 
  3.695578405214717*^9}, {3.7086756417020273`*^9, 3.708675662376093*^9}}],

Cell["\<\
The eigenvectors can be compactified further by expressing them in terms of \
the eigenvalues.
Here we check that our shortened forms fit with the solutions above, and that \
they are orthonormal.\
\>", "Text",
 CellChangeTimes->{{3.695576757362596*^9, 3.6955768127917957`*^9}, {
  3.695578340382938*^9, 3.695578347116832*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"v", "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"]}], ",", 
         FractionBox[
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], "\[Delta]"], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", 
          FractionBox[
           RowBox[{"d", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], 
           RowBox[{
            RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", "d", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}]]}], ",", 
         FractionBox[
          RowBox[{"d", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], 
          RowBox[{
           RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", "d", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}]], ",", 
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}], 
           RowBox[{"\[Delta]", "+", 
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}]}]], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
         RowBox[{
          FractionBox["\[Beta]", 
           RowBox[{"d", " ", "\[Delta]"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "+", 
            FractionBox[
             RowBox[{"a", " ", "\[Beta]"}], "\[Delta]"]}], ")"}], "z"}], ",", 
         
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}], ",", "z"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}], 
           RowBox[{"\[Delta]", "+", 
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "4", "]"}], "]"}]}]], 
          RowBox[{"(", 
           RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ",", 
         RowBox[{
          FractionBox["\[Beta]", 
           RowBox[{"d", " ", "\[Delta]"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            FractionBox[
             RowBox[{"a", " ", "\[Beta]"}], "\[Delta]"]}], ")"}], "z"}], ",", 
         
         RowBox[{"(", 
          RowBox[{"\[Xi]", "-", "z"}], ")"}], ",", "z"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"\[Delta]", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}]}], 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"u", "=", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"a", " ", "\[Beta]", " ", "\[Delta]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[Beta]"}], "-", 
            RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}]}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "d"}], " ", "z"}], ",", 
          RowBox[{"d", 
           RowBox[{"(", 
            RowBox[{"\[Xi]", "-", " ", "z"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "+", "d"}], ")"}]}], "z"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Beta]", "+", "d"}], ")"}], 
           RowBox[{"(", 
            RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox[
         RowBox[{"a", " ", "d", " ", "\[Beta]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[Beta]"}], "-", 
            RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
            RowBox[{"d", " ", 
             RowBox[{"(", 
              RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}]}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[Delta]", " ", "z"}], ",", 
          RowBox[{
           RowBox[{"-", "\[Delta]"}], 
           RowBox[{"(", 
            RowBox[{"\[Xi]", "-", " ", "z"}], ")"}]}], ",", 
          RowBox[{
           RowBox[{"-", "\[Beta]"}], " ", "z"}], ",", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"\[Xi]", "-", "z"}], ")"}]}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        FractionBox["a", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[Beta]"}], "-", 
            RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "+", 
            FractionBox[
             RowBox[{"a", " ", "\[Beta]"}], 
             RowBox[{"2", "\[Delta]"}]], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Beta]", "+", "d"}], ")"}], "\[Delta]"}], 
             RowBox[{"2", "\[Beta]"}]]}], ")"}]}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", " ", "\[Delta]"}], ",", 
          RowBox[{"d", " ", "\[Delta]"}], ",", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
            ")"}]}], ",", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "3", "]"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
            ")"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        FractionBox["a", 
         RowBox[{"2", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"a", " ", "\[Beta]"}], "-", 
            RowBox[{"d", " ", "\[Delta]"}]}], ")"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "+", 
            FractionBox[
             RowBox[{"a", " ", "\[Beta]"}], 
             RowBox[{"2", "\[Delta]"}]], "+", 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Beta]", "+", "d"}], ")"}], "\[Delta]"}], 
             RowBox[{"2", "\[Beta]"}]]}], ")"}]}]], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"d", " ", "\[Delta]"}], ",", 
          RowBox[{"d", " ", "\[Delta]"}], ",", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
            ")"}]}], ",", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", 
              RowBox[{"[", "4", "]"}], "]"}], "+", 
             RowBox[{
              FractionBox[
               RowBox[{"\[Beta]", "+", "d"}], "\[Beta]"], "\[Delta]"}]}], 
            ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", "}"}], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"\[Delta]", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}]}], 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}]}], ";"}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.695578216015052*^9, 3.695578219544037*^9}, {
  3.6955782788664083`*^9, 3.695578289447497*^9}, {3.6955784132006493`*^9, 
  3.69557841650179*^9}, {3.6955785101605577`*^9, 3.6955785562222424`*^9}, {
  3.7086757226033287`*^9, 3.7086757301963053`*^9}, {3.708675897236945*^9, 
  3.708675977579815*^9}, {3.708676370453308*^9, 3.708676374453003*^9}, {
  3.7087637895591497`*^9, 3.7087637934454613`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"vNorm", "-", "v"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"uNorm", "-", "u"}], "]"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.668777106989574*^9, 3.66877712233244*^9}, {
  3.695576736979989*^9, 3.69557675121027*^9}, {3.6955782982392406`*^9, 
  3.695578306189044*^9}, {3.695578426035819*^9, 3.6955784314776297`*^9}, {
  3.7087638147034273`*^9, 3.70876381683635*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{
      RowBox[{"u", "[", 
       RowBox[{"[", "i", "]"}], "]"}], ".", 
      RowBox[{"v", "[", 
       RowBox[{"[", "j", "]"}], "]"}]}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.695578367924515*^9, 3.695578370484455*^9}, {
  3.695578437789566*^9, 3.695578440083303*^9}, {3.708763822933114*^9, 
  3.708763824508091*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"u", "=", "uNorm"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v", "=", "vNorm"}], ";"}]}], "Input",
 CellChangeTimes->{{3.708676624608357*^9, 3.708676630378564*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Drift vector", "Subsection",
 CellChangeTimes->{{3.668663746520438*^9, 3.668663748407606*^9}}],

Cell["\<\
We find that the new drift vector along the slow-subspace satisfies \
\[Epsilon] u1.h, where h is the extra drift on the slow-manifold xStar due to \
the selective effect of \[Epsilon].\
\>", "Text",
 CellChangeTimes->{{3.6955768593447742`*^9, 3.6955769348218327`*^9}, {
  3.6955797589402227`*^9, 3.695579759546625*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"h", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"d", " ", "\[Gamma]d"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]", " ", 
            "\[Gamma]\[Beta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]", " ", "\[Gamma]\[Rho]"}]}], ")"}],
          "x4"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Delta]", " ", "\[Gamma]\[Delta]"}], "+", 
           RowBox[{"a", " ", "\[Gamma]a", 
            RowBox[{"(", 
             RowBox[{"1", "-", "x3", "-", "x4"}], ")"}]}]}], ")"}], "x2"}]}], 
       ",", "0", ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Rho]", " ", "\[Beta]", 
            RowBox[{"(", 
             RowBox[{"\[Gamma]\[Rho]", "+", "\[Gamma]\[Beta]"}], ")"}]}], "-", 
           RowBox[{"d", " ", "\[Gamma]d"}], " ", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]", " ", "\[Gamma]\[Delta]"}]}], 
          ")"}], "x4"}], " ", "+", " ", 
        RowBox[{"a", " ", "\[Gamma]a", 
         RowBox[{"(", 
          RowBox[{"1", "-", "x3", "-", "x4"}], ")"}], "x2"}]}]}], "}"}], "/.",
      "xStar"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.69557857999722*^9, 3.69557877382694*^9}, {
  3.708678722756461*^9, 3.708678795992886*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"\[Epsilon]", " ", 
   RowBox[{
    RowBox[{"u", "[", 
     RowBox[{"[", "1", "]"}], "]"}], ".", "h"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6955787868930264`*^9, 3.695578807730257*^9}, {
  3.6955797815975924`*^9, 3.6955797830754557`*^9}}],

Cell[TextData[{
 "Again this can be written in a more compact form (as ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalA]", " ", 
    RowBox[{"z", "(", 
     RowBox[{"\[Xi]", "-", "z"}], ")"}]}], TraditionalForm]]],
 ")."
}], "Text",
 CellChangeTimes->{{3.695577021346534*^9, 3.6955770544799013`*^9}, {
  3.6955772180308437`*^9, 3.695577231548636*^9}, {3.69557893187311*^9, 
  3.6955789346620913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Check", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Epsilon]", " ", 
       RowBox[{
        RowBox[{"u", "[", 
         RowBox[{"[", "1", "]"}], "]"}], ".", "h"}]}], ")"}], "-", 
     RowBox[{"(", 
      RowBox[{"\[Epsilon]", 
       FractionBox[
        RowBox[{"\[Delta]", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Gamma]a", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "-", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
              RowBox[{"\[Beta]", " ", "\[Rho]"}]}], ")"}]}], "-", 
           RowBox[{"\[Gamma]d", " ", "d", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "-", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], "+", 
           RowBox[{"\[Gamma]\[Beta]", " ", "\[Beta]", 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"\[Alpha]", " ", "\[Delta]", 
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], "-", 
           RowBox[{"\[Gamma]\[Delta]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"d", " ", "\[Beta]"}], "+", 
              RowBox[{"\[Alpha]", " ", "\[Delta]", 
               RowBox[{"(", 
                RowBox[{"\[Beta]", "-", 
                 RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], "-", 
              RowBox[{"\[Beta]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", 
                 RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}], 
           "+", 
           RowBox[{"\[Gamma]\[Rho]", " ", "\[Rho]", " ", "\[Beta]", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "-", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}], 
        RowBox[{"\[Xi]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
           RowBox[{"\[Beta]", " ", "d"}], "+", 
           RowBox[{"d", " ", "\[Delta]"}], "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "-", 
              RowBox[{"(", 
               RowBox[{"d", "+", 
                RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], 
           "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}]], 
       "z", 
       RowBox[{"(", 
        RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ")"}]}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"\[Delta]", 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
          RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}]}], 
       RowBox[{"a", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.708680905761292*^9, 3.708680931831439*^9}, 
   3.708680989669476*^9, {3.708681858713623*^9, 3.7086819024465733`*^9}, {
   3.708681966942327*^9, 3.70868196920496*^9}, {3.708756567394302*^9, 
   3.7087565677215433`*^9}, {3.708756620519712*^9, 3.70875662199262*^9}, {
   3.7087640176224127`*^9, 3.708764020933551*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Delta]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Gamma]a", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
            RowBox[{"\[Beta]", " ", "\[Rho]"}]}], ")"}]}], "-", 
         RowBox[{"\[Gamma]d", " ", "d", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], "+", 
         RowBox[{"\[Gamma]\[Beta]", " ", "\[Beta]", 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"\[Alpha]", " ", "\[Delta]", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{"\[Gamma]\[Delta]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"d", " ", "\[Beta]"}], "+", 
            RowBox[{"\[Alpha]", " ", "\[Delta]", 
             RowBox[{"(", 
              RowBox[{"\[Beta]", "-", 
               RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], "-", 
            RowBox[{"\[Beta]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", 
               RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"\[Gamma]\[Rho]", " ", "\[Rho]", " ", "\[Beta]", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}], 
      RowBox[{"\[Xi]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
         RowBox[{"\[Beta]", " ", "d"}], "+", 
         RowBox[{"d", " ", "\[Delta]"}], "+", 
         RowBox[{"\[Alpha]", " ", "\[Delta]", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "-", 
            RowBox[{"(", 
             RowBox[{"d", "+", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], "-", 
         
         RowBox[{"\[Rho]", " ", "\[Beta]", 
          RowBox[{"(", 
           RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}]], "/.", 
     RowBox[{"\[Xi]", "\[Rule]", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{"\[Delta]", 
         RowBox[{"(", 
          RowBox[{"d", "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}]}], 
        RowBox[{"a", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}], ")"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.708757840634263*^9, 3.708757869211707*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Slow subspace (for \[Alpha]=\[Rho]=0)", "Subsection",
 CellChangeTimes->{{3.6685106794869328`*^9, 3.668510691621687*^9}, 
   3.695577381366755*^9, {3.708767592489502*^9, 3.70876759986445*^9}}],

Cell[TextData[{
 "Our slow-subspace satisfies the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    OverscriptBox["x", "~"], "=", 
    RowBox[{
     SuperscriptBox["x", "*"], "+", 
     RowBox[{"\[Epsilon]", " ", 
      RowBox[{"f", "(", "z", ")"}]}]}]}], TraditionalForm]]],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", "z", ")"}], TraditionalForm]]],
 " is given by:"
}], "Text",
 CellChangeTimes->{{3.6955789929984407`*^9, 3.695579054553976*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"f", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"-", "1"}], 
          RowBox[{"\[Lambda]", "[", 
           RowBox[{"[", "k", "]"}], "]"}]], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"u", "[", 
            RowBox[{"[", "k", "]"}], "]"}], ".", "h"}], ")"}], 
         RowBox[{"v", "[", 
          RowBox[{"[", "k", "]"}], "]"}]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Alpha]", "\[Rule]", "0"}], ",", 
         RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "}"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "2", ",", "4"}], "}"}]}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{"xTilde", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"x1", ",", "x2", ",", "x3", ",", "x4"}], "}"}], "/.", 
        "xStar"}], ")"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]", "\[Rule]", "0"}], ",", 
        RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "}"}]}], ")"}], "+", 
    RowBox[{"\[Epsilon]", " ", "f"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.668777889930395*^9, {3.6687779325037813`*^9, 3.668777938398926*^9}, {
   3.668778011101204*^9, 3.668778061634667*^9}, {3.6955790571381807`*^9, 
   3.695579062234375*^9}, {3.695579113838834*^9, 3.695579140897011*^9}, {
   3.69557918815242*^9, 3.6955791977656403`*^9}, {3.695579306658332*^9, 
   3.6955793099613457`*^9}, 3.695579397791819*^9, {3.695579718438501*^9, 
   3.695579718866437*^9}, {3.6956311541530867`*^9, 3.695631174553863*^9}, {
   3.708767065859632*^9, 3.708767110689659*^9}}],

Cell[CellGroupData[{

Cell["Visualise slow subspace", "Subsubsection",
 CellChangeTimes->{{3.695628924841165*^9, 3.695628929200087*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"ODE", " ", "solver"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"solveODEs", "[", 
    RowBox[{"params_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"paramSub", ",", "initialCondition", ",", "eqs", ",", "dSol"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSub", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           FractionBox["sStar", 
            RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"initialCondition", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"s1", "[", "0", "]"}], "\[Equal]", "sStar"}], ",", 
         RowBox[{
          RowBox[{"s2", "[", "0", "]"}], "\[Equal]", "\[ScriptCapitalS]"}], 
         ",", 
         RowBox[{
          RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "nStar"}], ",", 
         RowBox[{
          RowBox[{"n2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"eqs", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"s1", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d1", "+", "\[Beta]1"}], ")"}], 
               RowBox[{"n1", "[", "t", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Delta]1", "+", 
                 RowBox[{"a1", 
                  FractionBox[
                   RowBox[{"\[ScriptCapitalN]", "-", 
                    RowBox[{"n1", "[", "t", "]"}], "-", 
                    RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}],
                 ")"}], 
               RowBox[{"s1", "[", "t", "]"}]}]}]}], " ", ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"s2", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"d2", "+", "\[Beta]2"}], ")"}], 
               RowBox[{"n2", "[", "t", "]"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Delta]2", "+", 
                 RowBox[{"a2", 
                  FractionBox[
                   RowBox[{"\[ScriptCapitalN]", "-", 
                    RowBox[{"n1", "[", "t", "]"}], "-", 
                    RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}],
                 ")"}], 
               RowBox[{"s2", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"n1", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d1"}], " ", 
               RowBox[{"n1", "[", "t", "]"}]}], "+", 
              RowBox[{"a1", 
               FractionBox[
                RowBox[{"\[ScriptCapitalN]", "-", 
                 RowBox[{"n1", "[", "t", "]"}], "-", 
                 RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
               RowBox[{"s1", "[", "t", "]"}]}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"n2", "'"}], "[", "t", "]"}], "\[Equal]", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "d2"}], " ", 
               RowBox[{"n2", "[", "t", "]"}]}], "+", 
              RowBox[{"a2", 
               FractionBox[
                RowBox[{"\[ScriptCapitalN]", "-", 
                 RowBox[{"n1", "[", "t", "]"}], "-", 
                 RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
               RowBox[{"s2", "[", "t", "]"}]}]}]}]}], "\[IndentingNewLine]", 
           "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"a1", "\[Rule]", "a"}], ",", 
            RowBox[{"d1", "\[Rule]", "d"}], ",", 
            RowBox[{"\[Beta]1", "\[Rule]", "\[Beta]"}], ",", 
            RowBox[{"\[Delta]1", "\[Rule]", "\[Delta]"}], ",", 
            RowBox[{"a2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]a", " ", "\[Epsilon]"}]}], ")"}], "a"}]}], 
            ",", 
            RowBox[{"d2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]d", " ", "\[Epsilon]"}]}], ")"}], "d"}]}], 
            ",", 
            RowBox[{"\[Beta]2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]\[Beta]", " ", "\[Epsilon]"}]}], ")"}], 
              "\[Beta]"}]}], ",", 
            RowBox[{"\[Delta]2", "\[Rule]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"\[Gamma]\[Delta]", " ", "\[Epsilon]"}]}], ")"}], 
              "\[Delta]"}]}]}], "}"}]}], ")"}], "/.", "paramSub"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"dSol", "=", 
       RowBox[{
        RowBox[{"NDSolve", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"eqs", "/.", "params"}], ",", 
             RowBox[{"initialCondition", "/.", "params"}]}], "}"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s1", "[", "t", "]"}], ",", 
            RowBox[{"s2", "[", "t", "]"}], ",", 
            RowBox[{"n1", "[", "t", "]"}], ",", 
            RowBox[{"n2", "[", "t", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "dSol", "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.695629538258133*^9, 3.695629576123612*^9}, {
  3.695629607433374*^9, 3.69562967987818*^9}, {3.695629806801642*^9, 
  3.6956301246791553`*^9}, {3.6956303461026363`*^9, 3.6956303523023252`*^9}, {
  3.695630390125766*^9, 3.6956303984850597`*^9}, {3.6956304376428556`*^9, 
  3.695630467994227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Plotting", " ", "function"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"pPlot", "[", 
    RowBox[{"i_", ",", "odeSols_", ",", "paramsTab_", ",", "T_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "paramSub", ",", "xTilde", ",", "odeSols\[Section]i", ",", 
       "paramsTab\[Section]i", ",", "n\[Epsilon]", ",", "myCol", ",", 
       "plot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"paramSub", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           FractionBox["sStar", 
            RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"xTilde", "=", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"\[Beta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "z", "-", 
              FractionBox[
               RowBox[{"d", " ", "\[Delta]"}], 
               RowBox[{"a", " ", "\[Beta]"}]], "-", 
              FractionBox[
               RowBox[{"d", " ", "z", " ", "\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Beta]"}], 
                  "+", 
                  RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "d", " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}]}], "+", 
                  RowBox[{"\[Beta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"a", " ", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d", "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", "\[Delta]"}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"a", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}]}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "2"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "3"]}]}], ")"}], " ", 
                "\[Epsilon]"}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"a", " ", "\[Beta]"}], "-", 
                   RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
                 "2"]}]]}], ")"}]}], "\[Delta]"], ",", 
          FractionBox[
           RowBox[{"z", " ", "\[Beta]", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              FractionBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "d", " ", "\[Beta]", " ", "\[Delta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", "z", " ", 
                    SuperscriptBox["\[Beta]", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "+", "z"}], ")"}], " ", "\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                    "\[Delta]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}]}], "+", 
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Gamma]\[Beta]"}], "+", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", 
                    SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["a", "2"], " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", "z", " ", 
                    SuperscriptBox["\[Beta]", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}]}], "+", 
                    RowBox[{"d", " ", "\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Gamma]a"}],
                     "+", "\[Gamma]d", "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]d", "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", "\[Delta]"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Gamma]a"}],
                     "+", "\[Gamma]d", "-", 
                    RowBox[{"z", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]d", "-", "\[Gamma]\[Beta]", "+", 
                    "\[Gamma]\[Delta]"}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
                    SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "-", 
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "3"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[Gamma]\[Beta]"}], "+", 
                    "\[Gamma]\[Delta]"}], ")"}], " ", "\[Delta]"}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"a", " ", "\[Beta]"}], "-", 
                   RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                   RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
                 "2"]}]]}], ")"}]}], "\[Delta]"], ",", 
          RowBox[{"1", "-", "z", "-", 
           FractionBox[
            RowBox[{"d", " ", "\[Delta]"}], 
            RowBox[{"a", " ", "\[Beta]"}]], "+", 
           FractionBox[
            RowBox[{"d", " ", "z", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"a", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "z"}], ")"}], " ", "\[Beta]"}], 
               "+", 
               RowBox[{"d", " ", "\[Delta]"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Delta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["d", "2"], " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Gamma]a"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "-", "\[Gamma]\[Beta]", 
                    "+", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                  RowBox[{"d", " ", "\[Beta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "\[Gamma]a"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "-", "\[Gamma]\[Beta]", 
                    "+", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "3"}], " ", "\[Gamma]a"}], "+", 
                    RowBox[{"3", " ", "\[Gamma]d"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}]}], 
                    ")"}], " ", "\[Delta]"}], "-", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}], " ", 
                   SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "+", 
               RowBox[{"a", " ", 
                SuperscriptBox["\[Beta]", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Beta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "\[Gamma]\[Beta]"}], "+", 
                    "\[Gamma]\[Delta]"}], ")"}], " ", "\[Delta]"}], "+", 
                  RowBox[{"d", " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], 
                 ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"a", " ", "\[Beta]"}], "-", 
                RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                RowBox[{"d", " ", 
                 RowBox[{"(", 
                  RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
              "2"]}]]}], ",", 
          FractionBox[
           RowBox[{"z", " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
               "2"], "+", 
              RowBox[{"d", " ", "\[Beta]", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"\[Beta]", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "\[Gamma]\[Beta]"}], "+", 
                    "\[Gamma]\[Delta]"}], ")"}], " ", "\[Delta]"}], "+", 
                 RowBox[{"d", " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
               " ", "\[Epsilon]"}], "+", 
              FractionBox[
               RowBox[{"a", " ", "d", " ", "z", " ", "\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"\[Delta]", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SuperscriptBox["d", "2"], " ", 
                    SuperscriptBox["\[Beta]", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Gamma]a"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}], "+", 
                    RowBox[{"d", " ", "\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "\[Gamma]a"}], "-", 
                    RowBox[{"3", " ", "\[Gamma]d"}], "+", 
                    RowBox[{"2", " ", "\[Gamma]\[Beta]"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]\[Delta]"}]}], ")"}]}], "+", 
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "\[Gamma]a"}], "-", 
                    RowBox[{"2", " ", "\[Gamma]d"}], "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}]}]}], ")"}], " ", 
                    "\[Delta]"}], "+", 
                    RowBox[{
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"d", "+", "\[Beta]"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    "\[Gamma]a", "-", "\[Gamma]d", "+", "\[Gamma]\[Beta]", 
                    "-", "\[Gamma]\[Delta]"}], ")"}], " ", 
                    SuperscriptBox["\[Delta]", "2"]}]}], ")"}]}], "+", 
                  RowBox[{"a", " ", 
                   SuperscriptBox["\[Beta]", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Beta]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]"}], 
                    ")"}], " ", "\[Delta]"}], "-", 
                    RowBox[{"d", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Gamma]a", "-", "\[Gamma]d"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], 
                    ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"a", " ", "\[Beta]"}], "-", 
                  RowBox[{"d", " ", "\[Delta]"}]}], ")"}], "2"]]}], ")"}]}], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
              RowBox[{"d", " ", 
               RowBox[{"(", 
                RowBox[{"\[Beta]", "+", "\[Delta]"}], ")"}]}]}], ")"}], 
            "2"]]}], "}"}], "/.", "paramSub"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"odeSols\[Section]i", "=", 
       RowBox[{"odeSols", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"paramsTab\[Section]i", "=", 
       RowBox[{"paramsTab", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"n\[Epsilon]", "=", 
       RowBox[{"Length", "[", "paramsTab\[Section]i", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"myCol", "=", 
       RowBox[{"col", "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{
        RowBox[{"Show", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ParametricPlot", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"s1", "[", "t", "]"}], ",", 
                  RowBox[{"s2", "[", "t", "]"}]}], "}"}], "/.", 
                RowBox[{"odeSols\[Section]i", "[", 
                 RowBox[{"[", "j", "]"}], "]"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
            RowBox[{"MaxRecursion", "\[Rule]", "15"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"myCol", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}],
             ",", 
            RowBox[{"PlotRange", "\[Rule]", "All"}]}], " ", "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ParametricPlot", "[", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"\[ScriptCapitalN]", " ", 
                    RowBox[{"(", 
                    RowBox[{"xTilde", "/.", 
                    RowBox[{"z", "\[Rule]", 
                    RowBox[{
                    FractionBox["nStar", "\[ScriptCapitalN]"], " ", "x"}]}]}],
                     ")"}]}], ")"}], "/.", 
                  RowBox[{"paramsTab\[Section]i", "[", 
                   RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "[", 
                RowBox[{"[", 
                 RowBox[{"{", 
                  RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"x", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{
                 RowBox[{"myCol", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"Dashing", "[", 
                  RowBox[{"{", 
                   RowBox[{"0.02", ",", "0.02"}], "}"}], "]"}], ",", 
                 RowBox[{"Thickness", "[", "0.01", "]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], 
              "]"}]}]}], " ", "]"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Opacity", "[", "0.2", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.02", "]"}], ",", 
             RowBox[{"Arrowheads", "[", "0.1", "]"}], ",", 
             RowBox[{"Arrow", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.1", ",", "0.3"}], "}"}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.7"}], "}"}], "]"}]}], "}"}], "]"}]}],
             "}"}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Graphics", "[", 
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[CurlyEpsilon]\>\"", ",", "labelSize", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
               RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.54", ",", "0.74"}], "}"}], "]"}]}], "]"}], "]"}], 
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Max", "[", "\[Epsilon]Vals", "]"}]}], ")"}], 
                "\[Times]", " ", 
                RowBox[{"sStarVals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"Max", "[", "\[Epsilon]Vals", "]"}]}], ")"}], 
                "\[Times]", 
                RowBox[{"sStarVals", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(s\), \(2\)]\)\>\"", ",", 
                 "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(s\), \(1\)]\)\>\"", ",", 
                 "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               RowBox[{"Style", "[", 
                RowBox[{
                 RowBox[{"\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)=\>\"", "<>", 
                  RowBox[{"ToString", "[", 
                   RowBox[{"sStarVals", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", "labelSize",
                  ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], 
              "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"ticksSize", ",", 
             RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "350"}], ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"56", ",", "15"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"45", ",", "30"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"AxesOrigin", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", "]"}], 
        "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQvcDJY86tjteOHxZPWgiiD009/wJEn1i29Q2Ibgje
GXIbSIuv9kkE0WFJ7cUg2rJgK5huZIttAtE1mnV9IFqy/8VMEB2SGDoLRKvb
e68A0cfe164C0QJNSetA9IkO680g+uS1ju0g+iVD1iEQnfXS5AyIfuYe/RnM
/87OcAdIZ84+AqZZgh+xgOhZ95+B6SN/m3hAtMXBEEkQzd7JqACiL/HzgenY
mcvUQHTH9S96INqD758JiDaYLeAAomUasva/XAj0f/lXMC3MkH0ERMsp3T0K
orf5Pz8FoquVH5wG0QCeUa5Q
  "]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Determine", " ", "parameters", " ", "and", " ", "evaluate", " ", 
    "trajectories", " ", "from", " ", "ODEs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sStarVals", "=", 
     RowBox[{"{", 
      RowBox[{"10", ",", "100"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nS", "=", 
     RowBox[{"Length", "[", "sStarVals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]Vals", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.1", ",", "0.5", ",", "1.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Epsilon]", "=", 
     RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"paramsFunc", "[", 
      RowBox[{"\[Section]sStar_", ",", "\[Section]\[Epsilon]_"}], "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
       RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
       RowBox[{"nStar", "\[Rule]", "9900"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", 
        RowBox[{"1.", "/", "39"}]}], ",", 
       RowBox[{"\[ScriptCapitalS]", "\[Rule]", "5000"}], ",", 
       RowBox[{"\[ScriptL]", "\[Rule]", 
        FractionBox["3", "1440."]}], ",", 
       RowBox[{"\[Epsilon]", "\[Rule]", "\[Section]\[Epsilon]"}], ",", 
       RowBox[{"\[Gamma]\[Beta]", "\[Rule]", "1"}], ",", 
       RowBox[{"\[Gamma]\[Delta]", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Gamma]d", "\[Rule]", "0"}], ",", 
       RowBox[{"\[Gamma]a", "\[Rule]", "0"}]}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"paramsTab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"paramsFunc", "[", 
          RowBox[{
           RowBox[{"sStarVals", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[Epsilon]Vals", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", "3000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"odeSols", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"solveODEs", "[", 
          RowBox[{
           RowBox[{"paramsTab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "T"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.677328790399165*^9, 3.6773289187142363`*^9}, {
   3.677329506822762*^9, 3.677329574499803*^9}, {3.677329635978705*^9, 
   3.677329636057755*^9}, {3.6773305896894817`*^9, 3.677330590209255*^9}, {
   3.6773852502724733`*^9, 3.677385267487152*^9}, 3.6773853076062117`*^9, {
   3.6773853748995943`*^9, 3.6773853757313757`*^9}, {3.6773855077028427`*^9, 
   3.677385508054625*^9}, {3.695629369729677*^9, 3.695629377544651*^9}, {
   3.695629416551139*^9, 3.695629455493663*^9}, {3.695630485801869*^9, 
   3.6956305306078377`*^9}, {3.695630632172306*^9, 3.695630634019733*^9}, {
   3.695630978999683*^9, 3.695631001735991*^9}, {3.695631272765643*^9, 
   3.6956313155474977`*^9}, {3.695631578242546*^9, 3.695631578362268*^9}, {
   3.6956322992889423`*^9, 3.6956323203120413`*^9}, {3.695632669363978*^9, 
   3.695632683412003*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Plot", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Row", "[", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"pPlot", "[", 
      RowBox[{"i", ",", "odeSols", ",", "paramsTab", ",", "T"}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677386172076716*^9, 3.677386186149084*^9}, {
   3.6773862583949013`*^9, 3.677386259514772*^9}, {3.6773863749746933`*^9, 
   3.6773863770545893`*^9}, {3.695631457358231*^9, 3.69563151047719*^9}, {
   3.695632449083468*^9, 3.695632454549788*^9}, {3.6956324903220997`*^9, 
   3.695632492466007*^9}, 3.6956326629409943`*^9, {3.708767807449526*^9, 
   3.708767817384988*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Diffusion matrix", "Subsection",
 CellChangeTimes->{{3.668411114600995*^9, 3.668411118287931*^9}}],

Cell["\<\
We assume the diffusion coefficient is unchanged by selection, such that it \
is as described in the neutral case, i.e.\
\>", "Text",
 CellChangeTimes->{{3.6955753909918833`*^9, 3.695575429122048*^9}, {
  3.695579845733582*^9, 3.695579892817384*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BTilde", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", 
      FractionBox[
       RowBox[{"\[Beta]", 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], 
        SuperscriptBox["\[Delta]", "2"], 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], 
       RowBox[{"\[Xi]", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
           RowBox[{"\[Beta]", " ", "d"}], "+", 
           RowBox[{"d", " ", "\[Delta]"}], "+", 
           RowBox[{"\[Alpha]", " ", "\[Delta]", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "-", 
              RowBox[{"(", 
               RowBox[{"d", "+", 
                RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], 
           "-", 
           RowBox[{"\[Rho]", " ", "\[Beta]", 
            RowBox[{"(", 
             RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}], 
         "2"]}]], "z", 
      RowBox[{"(", 
       RowBox[{"\[Xi]", "-", "z"}], ")"}]}], ")"}], "/.", 
    RowBox[{"\[Xi]", "\[Rule]", 
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
          RowBox[{"\[Rho]", " ", "\[Beta]"}]}], ")"}], " ", "\[Delta]"}], 
       RowBox[{"a", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.668411453842161*^9, 3.668411548601388*^9}, {
  3.677309765016757*^9, 3.6773097806529016`*^9}, {3.708768587872257*^9, 
  3.7087686163737497`*^9}}],

Cell[TextData[{
 "The fixation dynamics is dependent on the folloing parameter combination ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    RowBox[{"\[Epsilon]", " ", "\[ScriptCapitalN]", " ", 
     RowBox[{"\[ScriptCapitalA]", "/", "\[ScriptCapitalB]"}]}]}], 
   TraditionalForm]]],
 " (const.)."
}], "Text",
 CellChangeTimes->{{3.7087758918242407`*^9, 3.708775907571931*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalA]", "=", 
   FractionBox[
    RowBox[{"\[Delta]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Gamma]a", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}], "-", 
          RowBox[{"\[Beta]", " ", "\[Rho]"}]}], ")"}]}], "-", 
       RowBox[{"\[Gamma]d", " ", "d", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], "+", 
       RowBox[{"\[Gamma]\[Beta]", " ", "\[Beta]", 
        RowBox[{"(", 
         RowBox[{"d", "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"\[Gamma]\[Delta]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"d", " ", "\[Beta]"}], "+", 
          RowBox[{"\[Alpha]", " ", "\[Delta]", 
           RowBox[{"(", 
            RowBox[{"\[Beta]", "-", 
             RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], "-", 
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[Rho]", " ", "\[Beta]"}], "-", 
             RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"\[Gamma]\[Rho]", " ", "\[Rho]", " ", "\[Beta]", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"\[Xi]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
       RowBox[{"\[Beta]", " ", "d"}], "+", 
       RowBox[{"d", " ", "\[Delta]"}], "+", 
       RowBox[{"\[Alpha]", " ", "\[Delta]", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "-", 
          RowBox[{"(", 
           RowBox[{"d", "+", 
            RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], "-", 
       RowBox[{"\[Rho]", " ", "\[Beta]", 
        RowBox[{"(", 
         RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
          RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}]}]]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalB]", "=", 
   FractionBox[
    RowBox[{"\[Beta]", 
     RowBox[{"(", 
      RowBox[{"d", "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Beta]"}]}], ")"}], 
     SuperscriptBox["\[Delta]", "2"], 
     RowBox[{"(", 
      RowBox[{"d", "+", 
       RowBox[{"\[Alpha]", " ", "\[Delta]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Rho]"}], ")"}]}]}], ")"}]}], 
    RowBox[{"\[Xi]", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[Beta]", " ", "\[Delta]"}], "+", 
        RowBox[{"\[Beta]", " ", "d"}], "+", 
        RowBox[{"d", " ", "\[Delta]"}], "+", 
        RowBox[{"\[Alpha]", " ", "\[Delta]", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "-", 
           RowBox[{"(", 
            RowBox[{"d", "+", 
             RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}], ")"}]}], "-", 
        RowBox[{"\[Rho]", " ", "\[Beta]", 
         RowBox[{"(", 
          RowBox[{"\[Beta]", "+", "\[Delta]", "-", 
           RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}]}]}], ")"}], 
      "2"]}]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.708775942250391*^9, 3.708775944635261*^9}, {
  3.708776007313987*^9, 3.7087760178244267`*^9}}],

Cell[BoxData[{
 RowBox[{"FullSimplify", "[", 
  FractionBox[
   RowBox[{"\[Epsilon]", " ", "\[ScriptCapitalN]", " ", "\[ScriptCapitalA]"}],
    "\[ScriptCapitalB]"], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{"%", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.708775967404716*^9, 3.708776084446083*^9}}],

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"\[ScriptCapitalB]", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Alpha]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7087761799741697`*^9, 3.708776189107669*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times", "Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}}],

Cell[TextData[{
 "We start the process on the slow manifold at the position z0. We want to \
know what is the probability our mutant reaches fixation (z=\[Xi]), and how \
long this takes.\nWe write ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[CapitalLambda]", "=", 
    RowBox[{"\[Epsilon]", " ", "\[ScriptCapitalN]", " ", 
     RowBox[{"\[ScriptCapitalA]", "/", "\[ScriptCapitalB]"}]}]}], 
   TraditionalForm]]],
 " (const.)."
}], "Text",
 CellChangeTimes->{{3.695575671665298*^9, 3.6955757204814034`*^9}, {
  3.695575955351097*^9, 3.695575957543264*^9}, {3.695579953476364*^9, 
  3.695580018252986*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "Probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "z0", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Phi]", "''"}], "[", "z0", "]"}]}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "\[Xi]", "]"}], "\[Equal]", "1"}]}], "}"}], 
       ",", 
       RowBox[{"\[Phi]", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[Lambda]", "\[Element]", "Reals"}]}], "}"}]}]}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
   3.668667378420467*^9, 3.668667380404291*^9}, {3.677406709476321*^9, 
   3.6774067219832897`*^9}, {3.677406764514456*^9, 3.677406783248962*^9}, {
   3.6774068183275948`*^9, 3.677406827751631*^9}, {3.6774799488636217`*^9, 
   3.6774799842536983`*^9}, {3.6774800356605387`*^9, 
   3.6774800392434473`*^9}, {3.677480074587178*^9, 3.677480076602214*^9}, {
   3.6774802739161453`*^9, 3.677480336530141*^9}, 3.695580023273849*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"t", "'"}], "[", "z0", "]"}]}], "+", " ", 
           RowBox[{
            RowBox[{"t", "''"}], "[", "z0", "]"}]}], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "\[ScriptCapitalN]"}], "\[ScriptCapitalB]"], 
           FractionBox["1", 
            RowBox[{"z0", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"t", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
        RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
   3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
   3.677310575463461*^9}, 3.67740691974185*^9, {3.677407222418562*^9, 
   3.677407223758267*^9}, {3.67740810744318*^9, 3.677408117362837*^9}, {
   3.677480131993122*^9, 3.677480186512088*^9}, {3.677480228061646*^9, 
   3.6774802445485077`*^9}, {3.677480373431834*^9, 3.6774803842953978`*^9}, {
   3.6774806819737186`*^9, 3.6774806828287992`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalLambda]", " ", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "z0", "]"}]}], "+", " ", 
             RowBox[{
              RowBox[{"\[Theta]", "''"}], "[", "z0", "]"}]}], "\[Equal]", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "\[ScriptCapitalN]"}], "\[ScriptCapitalB]"], 
             FractionBox[
              FractionBox[
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}]}]], 
              RowBox[{"z0", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "\[Xi]", "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
          RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
          RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
          RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
          RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z0", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z0", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}]}]]}], 
       ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
        RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6774804062952137`*^9, 3.677480412966385*^9}, {
   3.677480579456427*^9, 3.677480592680192*^9}, {3.677480623998776*^9, 
   3.677480721756995*^9}, 3.695580089790978*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Fixation probability and times to \[Sigma]-level of chimerism", \
"Subsection",
 CellChangeTimes->{{3.6684142956703157`*^9, 3.668414301373425*^9}, {
  3.6779157947628508`*^9, 3.6779157995863657`*^9}}],

Cell["\<\
If we want to know if our mutant reaches a given level of clonality/chimerism \
(\[Sigma]), we need to modify the boundary conditions.\
\>", "Text",
 CellChangeTimes->{{3.695580110885211*^9, 3.695580117009012*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Fixation", " ", "Probability"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"\[Phi]", "'"}], "[", "z0", "]"}]}], "+", 
           RowBox[{
            RowBox[{"\[Phi]", "''"}], "[", "z0", "]"}]}], "\[Equal]", "0"}], 
         ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"\[Phi]", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "1"}]}], 
        "}"}], ",", 
       RowBox[{"\[Phi]", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}], ",", 
        RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668422528125231*^9, 3.66842258248514*^9}, {
  3.668667378420467*^9, 3.668667380404291*^9}, {3.677406709476321*^9, 
  3.6774067219832897`*^9}, {3.677406764514456*^9, 3.677406783248962*^9}, {
  3.6774068183275948`*^9, 3.677406827751631*^9}, {3.6774799488636217`*^9, 
  3.6774799842536983`*^9}, {3.6774800356605387`*^9, 3.6774800392434473`*^9}, {
  3.677480074587178*^9, 3.677480076602214*^9}, {3.6774802739161453`*^9, 
  3.677480336530141*^9}, {3.677909832830461*^9, 3.677909863652874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "unconditional", " ", "fixation", " ", "time"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{"DSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"\[CapitalLambda]", " ", 
            RowBox[{
             RowBox[{"t", "'"}], "[", "z0", "]"}]}], "+", " ", 
           RowBox[{
            RowBox[{"t", "''"}], "[", "z0", "]"}]}], "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"-", "\[ScriptCapitalN]"}], "\[ScriptCapitalB]"], 
           FractionBox["1", 
            RowBox[{"z0", 
             RowBox[{"(", 
              RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]]}]}], ",", 
         RowBox[{
          RowBox[{"t", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{
          RowBox[{"t", "[", 
           RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
        "}"}], ",", 
       RowBox[{"t", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
        RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}], ",", 
        RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
    "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"1", ",", "1"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.668422592573616*^9, 3.668422633149439*^9}, {
   3.668422721553232*^9, 3.66842277322266*^9}, {3.677310564652866*^9, 
   3.677310575463461*^9}, 3.67740691974185*^9, {3.677407222418562*^9, 
   3.677407223758267*^9}, {3.67740810744318*^9, 3.677408117362837*^9}, {
   3.677480131993122*^9, 3.677480186512088*^9}, {3.677480228061646*^9, 
   3.6774802445485077`*^9}, {3.677480373431834*^9, 3.6774803842953978`*^9}, {
   3.6774806819737186`*^9, 3.6774806828287992`*^9}, {3.6779098801164293`*^9, 
   3.677909880700451*^9}, {3.677909960626295*^9, 3.677909965841529*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Mean", " ", "conditional", " ", "fixation", " ", "time"}], "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"DSolve", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"\[CapitalLambda]", " ", 
              RowBox[{
               RowBox[{"\[Theta]", "'"}], "[", "z0", "]"}]}], "+", " ", 
             RowBox[{
              RowBox[{"\[Theta]", "''"}], "[", "z0", "]"}]}], "\[Equal]", 
            RowBox[{
             FractionBox[
              RowBox[{"-", "\[ScriptCapitalN]"}], "\[ScriptCapitalB]"], 
             FractionBox[
              FractionBox[
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
               RowBox[{"1", "-", 
                RowBox[{"Exp", "[", 
                 RowBox[{
                  RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                  "\[Xi]"}], "]"}]}]], 
              RowBox[{"z0", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]]}]}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
           RowBox[{
            RowBox[{"\[Theta]", "[", 
             RowBox[{"\[Sigma]", " ", "\[Xi]"}], "]"}], "\[Equal]", "0"}]}], 
          "}"}], ",", 
         RowBox[{"\[Theta]", "[", "z0", "]"}], ",", "z0"}], "]"}], ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
          RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
          RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
          RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
          RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}], ",", 
          RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
      "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1"}], "]"}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox["t", "\[Xi]"], "[", "z0", "]"}], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[Theta]", "[", "z0", "]"}], "/.", "%"}], ")"}], "/", 
        FractionBox[
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
         RowBox[{"1", "-", 
          RowBox[{"Exp", "[", 
           RowBox[{
            RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
            "\[Xi]"}], "]"}]}]]}], ")"}]}], ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[LessEqual]", "z0", "\[LessEqual]", "\[Xi]"}], ",", 
        RowBox[{"0", "<", "\[Xi]", "<", "1"}], ",", 
        RowBox[{"\[ScriptCapitalN]", ">", "0"}], ",", 
        RowBox[{"\[ScriptCapitalB]", ">", "0"}], ",", 
        RowBox[{"0", "<", "\[Sigma]", "\[LessEqual]", "1"}], ",", 
        RowBox[{"\[CapitalLambda]", "\[Element]", "Reals"}]}], "}"}]}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6774804062952137`*^9, 3.677480412966385*^9}, {
   3.677480579456427*^9, 3.677480592680192*^9}, {3.677480623998776*^9, 
   3.677480721756995*^9}, {3.67791581711384*^9, 3.6779158178977127`*^9}, {
   3.677915853481181*^9, 3.6779158809995203`*^9}, {3.6779292242820187`*^9, 
   3.677929225657383*^9}, 3.6955801371961184`*^9}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["3. Clonal dominance in mice", "Chapter",
 CellChangeTimes->{{3.6955802354307213`*^9, 3.695580252508171*^9}, {
  3.695588653717609*^9, 3.695588653949535*^9}, {3.695707689871997*^9, 
  3.695707690279904*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.6955803295626802`*^9, 3.695580331136545*^9}}],

Cell[CellGroupData[{

Cell["Data analysis", "Subsection",
 CellChangeTimes->{{3.695580338586547*^9, 3.6955803400482903`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPars", "[", "dir_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "i", ",", "data", ",", "parsBase", ",", 
      "parsPars", ",", "parsSel", ",", "pars"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.dat\>\"", ",", "dir"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"parsBase", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptCapitalN]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"sStar", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"nStar", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[ScriptL]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[ScriptCapitalS]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "5"}], "]"}], "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "6"}], "]"}], "]"}]}]}], "*)"}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"parsPars", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Beta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Delta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"a", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"d", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4"}], "]"}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"parsSel", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Gamma]\[Beta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Gamma]\[Delta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Gamma]a", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Gamma]d", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Epsilon]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "5"}], "]"}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pars", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"parsBase", ",", "parsPars", ",", "parsSel"}], "}"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "pars", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695583714787603*^9, 3.695583723715773*^9}, {
  3.695583954441474*^9, 3.6955840232506523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getClonalData", "[", 
   RowBox[{"dir_", ",", "totalRuns_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "data", ",", "nSample", ",", "index", ",", 
      "i", ",", "timeDist", ",", "fixProb"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.dat\>\"", ",", "dir"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"timeDist", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fixProb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"nSample", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"data", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"index", " ", "=", 
         RowBox[{"Unitize", "[", 
          RowBox[{
           RowBox[{"Transpose", "[", "data", "]"}], "[", 
           RowBox[{"[", "nSample", "]"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fixProb", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"N", "[", 
          FractionBox[
           RowBox[{"Total", "[", "index", "]"}], 
           RowBox[{"totalRuns", "[", 
            RowBox[{"[", "i", "]"}], "]"}]], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"index", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Position", "[", 
           RowBox[{"index", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"timeDist", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"data", "[", 
           RowBox[{"[", "index", "]"}], "]"}], " ", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"fixProb", ",", "timeDist"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.690446299808317*^9, 3.69044630231957*^9}, {
  3.6904463735732203`*^9, 3.690446521896121*^9}, {3.6904483112494497`*^9, 
  3.690448323265708*^9}, {3.6955835118111897`*^9, 3.6955835566474743`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractClonalStats", "[", 
   RowBox[{"dir_", ",", "totalRuns_", ",", "clonalLevels_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fixProb", ",", "timeDist", ",", "nFiles", ",", "i", ",", "means", ",", 
      "stds", ",", "nSample"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"fixProb", ",", "timeDist"}], "}"}], "=", 
      RowBox[{"getClonalData", "[", 
       RowBox[{"dir", ",", "totalRuns"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "fixProb", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"means", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stds", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nSample", "=", 
      RowBox[{"Length", "[", "clonalLevels", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"means", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"clonalLevels", "[", 
              RowBox[{"[", "\[Sigma]", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"Mean", "[", 
               RowBox[{"timeDist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "\[Sigma]"}], "]"}], "]"}], " ", "]"}], 
              "/", "365.25"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "nSample"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"stds", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"clonalLevels", "[", 
              RowBox[{"[", "\[Sigma]", "]"}], "]"}], ",", 
             RowBox[{
              RowBox[{"StandardDeviation", "[", 
               RowBox[{"timeDist", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "\[Sigma]"}], "]"}], "]"}], " ", "]"}], 
              "/", "365.25"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "nSample"}], "}"}]}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"means", ",", "stds"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6955833731883802`*^9, 3.69558337982714*^9}, {
  3.6955835278632402`*^9, 3.695583533847715*^9}, {3.695583587473938*^9, 
  3.695583637887233*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getIncidenceCurve", "[", 
   RowBox[{"timeData_", ",", "tMin_", ",", "tMax_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"n", ",", "timeDataSorted", ",", "curve", ",", "i"}], "}"}], ",",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"n", "=", 
      RowBox[{"Length", "[", "timeData", "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"timeDataSorted", "=", 
      RowBox[{"Sort", "[", "timeData", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"curve", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"tMin", ",", "0"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"(*", 
      RowBox[{
      "Second", " ", "point", " ", "useful", " ", "for", " ", "LogLinear", 
       " ", "plots"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "n"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"curve", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"timeDataSorted", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"N", "[", 
             FractionBox[
              RowBox[{"i", "-", "1"}], "n"], "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"AppendTo", "[", 
         RowBox[{"curve", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"timeDataSorted", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"N", "[", 
             FractionBox["i", "n"], "]"}]}], "}"}]}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"curve", ",", 
       RowBox[{"{", 
        RowBox[{"tMax", ",", "1"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "curve", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7119547312678127`*^9, 3.7119549140630913`*^9}, {
  3.711954991541135*^9, 3.711955005740019*^9}, {3.711955057084046*^9, 
  3.7119550753375883`*^9}, {3.711955626312023*^9, 3.711955633814839*^9}, {
  3.71196565254536*^9, 3.711965659121073*^9}, {3.711969515944789*^9, 
  3.711969546886364*^9}, {3.7119704012737303`*^9, 3.711970414488447*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Analytical results", "Subsection",
 CellChangeTimes->{{3.695588617015256*^9, 3.69558861988592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getZ0", "[", "params_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "z0", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"z0", "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"a", 
          FractionBox[
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], 
           "\[ScriptCapitalN]"]}], 
         RowBox[{"\[Delta]", "+", 
          RowBox[{"a", 
           FractionBox[
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], 
            "\[ScriptCapitalN]"]}]}]], 
        FractionBox["1", "\[ScriptCapitalN]"]}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "z0", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.668841539600287*^9, 3.668841561906837*^9}, {
   3.668841616682199*^9, 3.668841619345768*^9}, {3.668841746797442*^9, 
   3.668841752108912*^9}, 3.66884188208971*^9, {3.668842044618889*^9, 
   3.668842049849934*^9}, {3.6688420839213943`*^9, 3.6688422549568567`*^9}, {
   3.67749076451233*^9, 3.677490781687209*^9}, {3.677490828637987*^9, 
   3.677490828927264*^9}, {3.677490875829639*^9, 3.6774908779562693`*^9}, {
   3.677490928098897*^9, 3.677490968104032*^9}, {3.677492918547641*^9, 
   3.6774929346022387`*^9}, {3.695584308088787*^9, 3.6955843251507587`*^9}, {
   3.695584381989959*^9, 3.695584398074939*^9}, {3.695584451565102*^9, 
   3.6955845298680887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conditionalProb", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "prob"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"prob", "=", 
        FractionBox["z0", 
         RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"prob", "=", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
             "\[Xi]"}], "]"}]}]], ")"}]}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "prob", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695586504409417*^9, 3.6955866467615223`*^9}, {
   3.695586702077282*^9, 3.695586720452691*^9}, {3.711889333614003*^9, 
   3.711889368398201*^9}, 3.7118895614805183`*^9, {3.711889593406344*^9, 
   3.711889678475431*^9}, {3.7118897960392103`*^9, 3.7118899657300158`*^9}, {
   3.71189003902357*^9, 3.7118900407838087`*^9}, {3.711890092901648*^9, 
   3.711890164562224*^9}, {3.711890203186524*^9, 3.711890261958644*^9}, 
   3.711890297310302*^9, 3.7118903452206783`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conditionalTime", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "time"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"time", "=", 
           RowBox[{
            FractionBox["\[Section]\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
            FractionBox[
             RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Xi]", "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[Xi]", "-", "z0"}], "]"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"time", "=", 
           RowBox[{
            FractionBox["\[Section]\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
            FractionBox[
             RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Xi]", "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[Xi]", "-", "z0"}], "]"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Sigma]"}], ")"}], "z0"}], 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]], 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "\[Sigma]"}], "]"}]}]}], ")"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"time", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Section]\[ScriptCapitalN]", 
                RowBox[{" ", 
                 RowBox[{
                 "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", 
                  "\[Xi]"}]}]]}], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
                  "1"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"EulerGamma", "+", 
                   RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
                   RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"3", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "-", 
                   
                   RowBox[{"3", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", "z", "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}],
                   ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                    
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"ExpIntegralEi", "[", 
                  RowBox[{
                   RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"2", "\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                   "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                 RowBox[{"ExpIntegralEi", "[", 
                  RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "-", 
                   RowBox[{"2", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}], ")"}], "/.", 
            RowBox[{"z", "\[Rule]", "z0"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"time", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["\[Section]\[ScriptCapitalN]", 
               RowBox[{
               "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", "\[Xi]"}]], 
              
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                   "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], "]"}],
                   "-", "1"}], ")"}], " "}]], 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"EulerGamma", "+", 
                   RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
                   RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}]}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", "z", "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
                    "]"}]}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], " ", 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", "1"}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                    
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "+", 
                   
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], 
                    "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}], 
                    " ", 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}],
                    "+", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}],
                    "-", 
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Xi]", " ", "\[Sigma]"}], 
                    "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                    "\[Xi]"}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}],
                   ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"1", "-", "\[Sigma]"}], "]"}], "-", 
                   RowBox[{"Log", "[", "\[Sigma]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
                    "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/.", 
            RowBox[{"z", "\[Rule]", "z0"}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"time", "/", "365.25"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.69558468484597*^9, 3.695584718769825*^9}, {
   3.6955848037398043`*^9, 3.695584899448827*^9}, {3.695584955617128*^9, 
   3.695584980574943*^9}, {3.6955852085987377`*^9, 3.6955852577202473`*^9}, {
   3.6955852985182047`*^9, 3.6955854012801228`*^9}, {3.695585492999866*^9, 
   3.695585494576703*^9}, {3.6955855448124933`*^9, 3.6955855695475492`*^9}, {
   3.6955856712545137`*^9, 3.695585707584066*^9}, 3.695585763156383*^9, {
   3.6955858753117113`*^9, 3.695585879204714*^9}, {3.71179422580057*^9, 
   3.7117942529755573`*^9}, {3.7117943741420517`*^9, 3.711794375703191*^9}, {
   3.711794414425766*^9, 3.711794435872561*^9}, {3.7117976755762863`*^9, 
   3.7117977025990257`*^9}, {3.711797775887155*^9, 3.71179777938892*^9}, 
   3.711798326498131*^9, {3.711798520250523*^9, 3.711798530086753*^9}, {
   3.7118026866630583`*^9, 3.711802713019799*^9}, {3.711802966435885*^9, 
   3.7118029825063972`*^9}, {3.711890362280406*^9, 3.711890510761325*^9}, 
   3.7118906265092897`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"variance", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "sec", ",", "var", ",", "sol", ",", 
      "\[CapitalDelta]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sec", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"2", 
              SuperscriptBox["\[Section]\[ScriptCapitalN]", "2"]}], 
             SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"\[Xi]", "-", "z0"}], "\[Xi]"], "]"}]}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", "1"}], "]"}], "-", 
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", 
                  FractionBox["z0", "\[Xi]"]}], "]"}]}], ")"}]}], ")"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"sec", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[Section]\[ScriptCapitalN]", "2"]}], 
             SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"\[Xi]", "-", "z0"}], "z0"], " ", 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"\[Xi]", "-", "z0"}], "\[Xi]"], "]"}]}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", "\[Sigma]"}], "]"}], "-", " ", 
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", 
                  FractionBox["z0", "\[Xi]"]}], "]"}]}], ")"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], " ", 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "\[Sigma]"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
                  RowBox[{"Log", "[", 
                   FractionBox["\[Xi]", 
                    RowBox[{"\[Xi]", "-", "z0"}]], "]"}]}], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], 
                  RowBox[{"Log", "[", 
                   RowBox[{"1", "-", "\[Sigma]"}], "]"}]}], "-", "1"}], 
                ")"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"Requires", " ", "numerical", " ", "solution", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "here", " ", "we", " ", "solve", " ", "the", " ", "first", " ", 
            "and", " ", "second", " ", "moments"}], ",", " ", 
           RowBox[{"because", " ", "we", " ", "can"}]}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "=", 
         SuperscriptBox["10.", 
          RowBox[{"-", "10"}]]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Move", " ", "away", " ", "from", " ", "the", " ", "singular", " ", 
           
           RowBox[{"boundaries", ".", " ", "Not"}], " ", "perfect"}], ",", 
          " ", 
          RowBox[{"but", " ", "good", " ", "enough"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", 
                 RowBox[{
                  RowBox[{"\[Theta]1", "'"}], "[", "z", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Theta]1", "''"}], "[", "z", "]"}]}], "\[Equal]", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Section]\[ScriptCapitalN]", 
                  RowBox[{"\[ScriptCapitalB]", " ", "z", 
                   RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
                FractionBox[
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                    "\[Xi]"}], "]"}]}]]}]}], ",", 
              RowBox[{
               RowBox[{"\[Theta]1", "[", "\[CapitalDelta]", "]"}], "\[Equal]",
                "0"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]1", "[", 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}], "]"}], 
               "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", 
                 RowBox[{
                  RowBox[{"\[Theta]2", "'"}], "[", "z", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Theta]2", "''"}], "[", "z", "]"}]}], "\[Equal]", 
               RowBox[{
                RowBox[{"-", "2"}], 
                FractionBox["\[Section]\[ScriptCapitalN]", 
                 RowBox[{"\[ScriptCapitalB]", " ", "z", 
                  RowBox[{"(", 
                   RowBox[{"\[Xi]", "-", "z"}], ")"}]}]], 
                RowBox[{"\[Theta]1", "[", "z", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"\[Theta]2", "[", "\[CapitalDelta]", "]"}], "\[Equal]",
                "0"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]2", "[", 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}], "]"}], 
               "\[Equal]", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Theta]1", "[", "z", "]"}], ",", 
              RowBox[{"\[Theta]2", "[", "z", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "\[CapitalDelta]", ",", 
              RowBox[{"\[Sigma]", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}]}], "}"}], 
            ",", 
            RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}], "//", 
          "First"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"sec", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Theta]2", "[", "z", "]"}], "/.", "sol"}], ")"}], "/", 
            FractionBox[
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                "\[Xi]"}], "]"}]}]]}], ")"}], "/.", 
          RowBox[{"z", "\[Rule]", "z0"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{
       FractionBox["sec", 
        SuperscriptBox["365.25", "2"]], "-", 
       SuperscriptBox[
        RowBox[{"conditionalTime", "[", 
         RowBox[{"z0", ",", "\[Sigma]", ",", "params"}], "]"}], "2"]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "var", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.711446478802761*^9, 3.7114465828170633`*^9}, {
   3.711446738841564*^9, 3.711446754720251*^9}, {3.711446813086996*^9, 
   3.71144690628032*^9}, {3.711446950281795*^9, 3.711446957173641*^9}, {
   3.711446993336164*^9, 3.711447046956019*^9}, 3.7114472068375797`*^9, {
   3.711451969649268*^9, 3.711452022357366*^9}, {3.711452256222262*^9, 
   3.711452300180933*^9}, {3.711453174625086*^9, 3.711453183174818*^9}, {
   3.711691724516521*^9, 3.7116917550179987`*^9}, {3.7116917981043873`*^9, 
   3.711691841087152*^9}, {3.711791758524539*^9, 3.711791795956662*^9}, {
   3.711791832882471*^9, 3.71179184631597*^9}, {3.711791893385562*^9, 
   3.71179194199135*^9}, {3.711791980213264*^9, 3.711791982429175*^9}, {
   3.71179206230791*^9, 3.711792076293066*^9}, {3.711797868947214*^9, 
   3.711797871207541*^9}, {3.711797992683066*^9, 3.7117980978311787`*^9}, {
   3.711798133473428*^9, 3.711798136936211*^9}, 3.711798555304923*^9, {
   3.711798599536109*^9, 3.7117986057742977`*^9}, {3.711798649531909*^9, 
   3.71179870357178*^9}, {3.711798840278583*^9, 3.7117988601097317`*^9}, {
   3.7117997785339823`*^9, 3.711799820412499*^9}, {3.711799857445311*^9, 
   3.711799863227083*^9}, 3.711801078316558*^9, {3.711801184759046*^9, 
   3.7118011875418673`*^9}, {3.711801543986307*^9, 3.7118015820914717`*^9}, 
   3.711802735430949*^9, 3.711802995694175*^9, {3.7118031064862633`*^9, 
   3.711803110825198*^9}, {3.711803145124913*^9, 3.711803145300867*^9}, {
   3.7118033282869062`*^9, 3.711803353764391*^9}, {3.7118033937330112`*^9, 
   3.711803394187455*^9}, {3.711803519943961*^9, 3.7118035203192873`*^9}, {
   3.71180355765485*^9, 3.711803558062118*^9}, {3.7118064756926928`*^9, 
   3.7118065668481092`*^9}, {3.711806621895279*^9, 3.711806752579093*^9}, {
   3.711806804063676*^9, 3.711806804246913*^9}, {3.711806953941045*^9, 
   3.7118069827051773`*^9}, {3.711807325335123*^9, 3.71180735507304*^9}, {
   3.711863849056623*^9, 3.71186384956861*^9}, {3.711864018088746*^9, 
   3.711864034290105*^9}, {3.711865004863596*^9, 3.711865005817881*^9}, {
   3.7118652527947893`*^9, 3.711865252882113*^9}, 3.711865445012985*^9, {
   3.71186580456024*^9, 3.7118658051587563`*^9}, {3.711865921834813*^9, 
   3.711865923354885*^9}, {3.7118659856665983`*^9, 3.711866002594029*^9}, {
   3.7118906077837353`*^9, 3.7118907092501287`*^9}, {3.7118907685173903`*^9, 
   3.7118908465632257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"findTimeRoot", "[", 
   RowBox[{"t_", ",", "z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[CapitalDelta]", ",", "\[Xi]", ",", "\[Xi]Prime", ",", "p", ",", 
      "pLeft", ",", "pRight", ",", "count", ",", "threshold"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", "=", "0.01"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Xi]Prime", "=", 
      RowBox[{"\[Xi]", "+", "\[CapitalDelta]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"count", "=", "0"}], ";", "\[IndentingNewLine]", 
     RowBox[{"threshold", "=", 
      SuperscriptBox["10.", 
       RowBox[{"-", "5"}]]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"While", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{"\[Xi]", "-", "\[Xi]Prime"}], "]"}], ">", "threshold"}], "&&", 
        RowBox[{"count", "<", "1000"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"count", "++"}], ";", "\[IndentingNewLine]", 
        RowBox[{"\[Xi]", "=", "\[Xi]Prime"}], ";", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"params", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"\[Epsilon]", "\[Rule]", "\[Xi]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pLeft", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"params", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"\[Epsilon]", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"\[Xi]", "-", 
              FractionBox["\[CapitalDelta]", "2"]}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pRight", "=", 
         RowBox[{"Append", "[", 
          RowBox[{
           RowBox[{"Drop", "[", 
            RowBox[{"params", ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", 
           RowBox[{"\[Epsilon]", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"\[Xi]", "+", 
              FractionBox["\[CapitalDelta]", "2"]}], ")"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Xi]Prime", "=", 
         RowBox[{"\[Xi]", "-", 
          RowBox[{"0.01", 
           FractionBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"conditionalTime", "[", 
               RowBox[{"z0", ",", "\[Sigma]", ",", "p"}], "]"}], "-", "t"}], 
             ")"}], 
            FractionBox[
             RowBox[{
              RowBox[{"conditionalTime", "[", 
               RowBox[{"z0", ",", "\[Sigma]", ",", "pRight"}], "]"}], "-", 
              RowBox[{"conditionalTime", "[", 
               RowBox[{"z0", ",", "\[Sigma]", ",", "pLeft"}], "]"}]}], 
             "\[CapitalDelta]"]]}]}]}], ";"}]}], "\[IndentingNewLine]", "]"}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "\[Xi]Prime", "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.696067464412537*^9, 3.696067469476931*^9}, {
   3.6960678188286657`*^9, 3.696067880924098*^9}, {3.69606798871157*^9, 
   3.696068082440867*^9}, {3.696068118340144*^9, 3.696068367372038*^9}, {
   3.6960684134939547`*^9, 3.69606847895475*^9}, {3.696068511988678*^9, 
   3.696068532688129*^9}, {3.696068585645465*^9, 3.696068623926529*^9}, {
   3.696068883960189*^9, 3.696068920069503*^9}, {3.696143563269869*^9, 
   3.69614366931413*^9}, 3.696143741007523*^9, {3.696153536017632*^9, 
   3.6961536169110394`*^9}, {3.6961536738219*^9, 3.696153677340273*^9}, {
   3.696153777489009*^9, 3.696153777760638*^9}, {3.6961538771015244`*^9, 
   3.69615389937239*^9}, {3.6961539374279118`*^9, 3.696153939218893*^9}, {
   3.696154117877655*^9, 3.6961541182525387`*^9}, {3.6961542967506657`*^9, 
   3.69615432841332*^9}, {3.696154367580779*^9, 3.696154367939975*^9}, {
   3.696154428610166*^9, 3.696154438289575*^9}, {3.696154517118348*^9, 
   3.696154553309376*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getVarianceSigma", "[", 
   RowBox[{"z0_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Sigma]", ",", "mean", ",", "var", ",", "list"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Sigma]", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          SuperscriptBox["10", "log\[Sigma]"], ",", 
          RowBox[{"{", 
           RowBox[{"log\[Sigma]", ",", 
            RowBox[{"-", "3"}], ",", 
            RowBox[{"-", "1"}], ",", "0.1"}], "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{"i", ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "0.15", ",", "1", ",", "0.05"}], "}"}]}], 
         "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"mean", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"conditionalTime", "[", 
         RowBox[{"z0", ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "params"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Sigma]", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"variance", "[", 
         RowBox[{"z0", ",", 
          RowBox[{"\[Sigma]", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "params"}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Sigma]", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "mean", ",", "var"}], "}"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "list", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.711798889497107*^9, 3.7117989072489433`*^9}, {
  3.711799836400743*^9, 3.711799837656825*^9}, {3.711799926349678*^9, 
  3.711799940125153*^9}, {3.7118000930159073`*^9, 3.7118001556843243`*^9}, {
  3.711800186564823*^9, 3.711800232866934*^9}, {3.711800271002863*^9, 
  3.711800419396741*^9}, {3.711800532593895*^9, 3.711800679556037*^9}, {
  3.711800737450513*^9, 3.7118007998164473`*^9}, {3.711800848591629*^9, 
  3.711800892181364*^9}, {3.711807010143469*^9, 3.711807028710737*^9}, {
  3.7118074625770693`*^9, 3.711807562260868*^9}, {3.711807811501432*^9, 
  3.711807878338676*^9}, {3.711808196185423*^9, 3.7118082639336767`*^9}, {
  3.711808762773573*^9, 3.711808765717329*^9}, {3.711858081753467*^9, 
  3.711858130483636*^9}, {3.711858188113412*^9, 3.711858234695434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getVarianceEpsilon", "[", 
   RowBox[{"z0_", ",", "params_", ",", "\[Sigma]_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Epsilon]Vals", ",", "paramList", ",", "mean", ",", "var", ",", 
      "list"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Epsilon]Vals", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"\[Epsilon]", ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "5", ",", "0.1"}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"paramList", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{"params", ",", 
          RowBox[{"\[Epsilon]", "\[Rule]", 
           RowBox[{"\[Epsilon]Vals", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"mean", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"conditionalTime", "[", 
         RowBox[{"z0", ",", "\[Sigma]", ",", 
          RowBox[{"paramList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"variance", "[", 
         RowBox[{"z0", ",", "\[Sigma]", ",", 
          RowBox[{"paramList", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], "}"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"list", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]Vals", ",", "mean", ",", "var"}], "}"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "list", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7ftC/+zG5a8dI76nnwfRjy/1OG8C0ttYtoLpCQan
/UC0I2NLAIgOaFqQDKL/PC3NBtEcwkH5IPrNXulSEF0i/qASREttyukB0QaM
k2eBaL7TH9eA6FlZeltAdJjCr90gesE7oUMges/Z1uMg2me6y5GtQDpm37Rj
IDqq/NIfEM0R6cG5DUjv5i7QANH5104ZgOg/71ojQPS6B38TQLTMwYj5IDrm
yzYwnS5jseUckP5U6b8LRAstbD4Iov87hB0H0ZMykr6C6Hc9CT9B9OSVzn9B
9CblwP8gmsPqNMt5IO3nWsgLoo0iJctA9KmKKxUgenlb4yQQvWp6C5gGALGo
w2Y=
  "]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting", "Subsection",
 CellChangeTimes->{{3.695580345754384*^9, 3.69558034659223*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errorPlot", "[", 
   RowBox[{"x_", ",", "\[Sigma]_", ",", "col_", ",", "sym_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", "=", "0"}], ","}], "*)"}], 
     RowBox[{"num", ",", "points", ",", "lines", ",", 
      RowBox[{"(*", 
       RowBox[{"bars", ","}], "*)"}], "plot"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"num", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"points", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{"x", ",", 
        RowBox[{"PlotStyle", "\[Rule]", "col"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", "sym"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"col", ",", 
           RowBox[{"Thickness", "[", "0.002", "]"}]}], "]"}]}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bars", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"col", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
                    "]"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"col", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}],
                 "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"lines", ",", 
        RowBox[{"(*", 
         RowBox[{"bars", ","}], "*)"}], "points"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695587037685897*^9, 3.6955870499028597`*^9}, {
  3.6955871004473133`*^9, 3.695587117060816*^9}, {3.69558831908086*^9, 
  3.695588323102811*^9}, {3.695588430089944*^9, 3.695588436631132*^9}, {
  3.696066321469535*^9, 3.696066337515827*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errorLogLinearPlot", "[", 
   RowBox[{"x_", ",", "\[Sigma]_", ",", "col_", ",", "sym_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", "=", "0"}], ","}], "*)"}], 
     RowBox[{"num", ",", "points", ",", "lines", ",", 
      RowBox[{"(*", 
       RowBox[{"bars", ","}], "*)"}], "plot"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"num", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"points", "=", 
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{"x", ",", 
        RowBox[{"PlotStyle", "\[Rule]", "col"}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", "sym"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"col", ",", 
           RowBox[{"Thickness", "[", "0.002", "]"}]}], "]"}]}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bars", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"col", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
                    "]"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"col", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}],
                 "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"lines", ",", 
        RowBox[{"(*", 
         RowBox[{"bars", ","}], "*)"}], "points"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.690366361098097*^9, 3.6903663756568403`*^9}, {
  3.690447167338378*^9, 3.6904471748094587`*^9}, {3.690447221464448*^9, 
  3.6904472746779003`*^9}, {3.695586111033328*^9, 3.695586111687381*^9}, {
  3.695587121470046*^9, 3.695587133028921*^9}, {3.696064991579126*^9, 
  3.696065005400935*^9}, {3.696065145960115*^9, 3.696065151041655*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotVarianceSigma", "[", 
   RowBox[{"list_", ",", "col_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lower", ",", "upper", ",", "plot"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lower", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "]"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upper", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"list", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "]"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lower", ",", "upper"}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "None"}], ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", "\[Rule]", 
           RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"col", ",", 
           RowBox[{"Opacity", "[", "0.2", "]"}]}], " ", "]"}]}]}], " ", 
       "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.711798889497107*^9, 3.7117989072489433`*^9}, {
  3.711799836400743*^9, 3.711799837656825*^9}, {3.711799926349678*^9, 
  3.711799940125153*^9}, {3.7118000930159073`*^9, 3.7118001556843243`*^9}, {
  3.711800186564823*^9, 3.711800232866934*^9}, {3.711800271002863*^9, 
  3.711800419396741*^9}, {3.711800532593895*^9, 3.711800679556037*^9}, {
  3.711800737450513*^9, 3.7118007998164473`*^9}, {3.711800848591629*^9, 
  3.711800892181364*^9}, {3.711807010143469*^9, 3.711807028710737*^9}, {
  3.7118074625770693`*^9, 3.711807562260868*^9}, {3.711807811501432*^9, 
  3.711807878338676*^9}, {3.711808196185423*^9, 3.7118082639336767`*^9}, {
  3.711808762773573*^9, 3.711808765717329*^9}, {3.711858289917572*^9, 
  3.7118582941411552`*^9}, {3.711858465504318*^9, 3.711858533333317*^9}, {
  3.711861915529194*^9, 3.7118619164889097`*^9}, {3.711862761034284*^9, 
  3.711862765700082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"plotVarianceEpsilon", "[", 
   RowBox[{"list_", ",", "col_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"lower", ",", "upper", ",", "plot"}], "}"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lower", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "]"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"upper", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
           RowBox[{"Sqrt", "[", 
            RowBox[{"list", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "3"}], "]"}], "]"}], " ", "]"}]}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "list", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lower", ",", "upper"}], "}"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "None"}], ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", "\[Rule]", 
           RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
        RowBox[{"FillingStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"col", ",", 
           RowBox[{"Opacity", "[", "0.2", "]"}]}], " ", "]"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"1", ",", "6"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "5"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7118627469015837`*^9, 3.711862772045207*^9}, {
  3.711863655239511*^9, 3.711863657294509*^9}, {3.711863701390201*^9, 
  3.711863710340777*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot", "Section",
 CellChangeTimes->{{3.695582436976624*^9, 3.6955824375185127`*^9}}],

Cell[CellGroupData[{

Cell["Left: Time taken to reach \[Sigma]-level of clonality", "Subsection",
 CellChangeTimes->{{3.695582455376359*^9, 3.695582479197035*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "data", " ", "and", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"totalRuns", "=", 
     RowBox[{"{", "10000", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clonalLevels", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10.", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"0.1", "i"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dir00", "=", "\"\<zz-data/clonal-mouse/epsilon_00\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dir01", "=", "\"\<zz-data/clonal-mouse/epsilon_01\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dir05", "=", "\"\<zz-data/clonal-mouse/epsilon_05\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params00", "=", 
     RowBox[{
      RowBox[{"getPars", "[", "dir00", "]"}], "//", "First"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params01", "=", 
     RowBox[{
      RowBox[{"getPars", "[", "dir01", "]"}], "//", "First"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params05", "=", 
     RowBox[{
      RowBox[{"getPars", "[", "dir05", "]"}], "//", "First"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x00", ",", "\[Sigma]00"}], "}"}], "=", 
     RowBox[{"extractClonalStats", "[", 
      RowBox[{"dir00", ",", "totalRuns", ",", 
       RowBox[{"clonalLevels", "[", 
        RowBox[{"[", 
         RowBox[{"1", ";;", "16"}], "]"}], "]"}]}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x01", ",", "\[Sigma]01"}], "}"}], "=", 
     RowBox[{"extractClonalStats", "[", 
      RowBox[{"dir01", ",", "totalRuns", ",", "clonalLevels"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x05", ",", "\[Sigma]05"}], "}"}], "=", 
     RowBox[{"extractClonalStats", "[", 
      RowBox[{"dir05", ",", "totalRuns", ",", "clonalLevels"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Don", "'"}], "t", " ", "show", " ", "all", " ", "points", " ", 
     "as", " ", "cluttered"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"select0", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"x00", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], " ", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"select", "=", 
     RowBox[{"Select", "[", 
      RowBox[{
       RowBox[{"Range", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", 
          RowBox[{"x01", "[", 
           RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], " ", "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{"#", ",", "2"}], "]"}], "\[Equal]", "1"}], "&"}]}], "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x00", "=", 
     RowBox[{"x00", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "select0"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]00", "=", 
     RowBox[{"\[Sigma]00", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "select0"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x01", "=", 
     RowBox[{"x01", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "select"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]01", "=", 
     RowBox[{"\[Sigma]01", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "select"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"x05", "=", 
     RowBox[{"x05", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "select"}], "]"}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]05", "=", 
     RowBox[{"\[Sigma]05", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "select"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z0", "=", 
     RowBox[{"getZ0", "[", "params00", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6955829022354383`*^9, 3.6955829050451736`*^9}, {
   3.6955837865020447`*^9, 3.695583830692227*^9}, {3.6955838754794407`*^9, 
   3.695583901558071*^9}, {3.6955840368575363`*^9, 3.695584048665114*^9}, {
   3.695584110491275*^9, 3.695584124897375*^9}, 3.695584572907943*^9, {
   3.6955861920140467`*^9, 3.6955862465963497`*^9}, {3.6960652105675783`*^9, 
   3.696065282539715*^9}, {3.6960655241070633`*^9, 3.6960655708428183`*^9}, {
   3.696144369136277*^9, 3.696144388064481*^9}, {3.696144561009338*^9, 
   3.6961446744136057`*^9}, {3.6971806384364862`*^9, 3.69718063857157*^9}, {
   3.697180681426426*^9, 3.697180683362007*^9}, {3.6971807721780148`*^9, 
   3.697180772350831*^9}, {3.697180821342202*^9, 3.697180841628561*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Store", " ", "variance", " ", "as", " ", "it", " ", "takes", " ", "a", 
    " ", "long", " ", "time", " ", "to", " ", "calculate"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Comment", " ", "out", " ", "to", " ", "avoid", " ", "recomputing"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"export", "[", "label_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"name", ",", "dir", ",", "list"}], "}"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"name", "=", 
          RowBox[{"\"\<varianceSigma\>\"", "<>", "label"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dir", "=", "\"\<zz-data/clonal-mouse/\>\""}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"list", "=", 
          RowBox[{"getVarianceSigma", "[", 
           RowBox[{"z0", ",", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"\"\<params\>\"", "<>", "label"}], "]"}]}], " ", "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"Export", "[", 
          RowBox[{
           RowBox[{"dir", "<>", "name", "<>", "\"\<.dat\>\""}], ",", "list"}],
           "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Map", "[", 
       RowBox[{"export", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<00\>\"", ",", "\"\<01\>\"", ",", "\"\<05\>\""}], 
         "}"}]}], "]"}]}]}], ";"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.711855081953691*^9, 3.711855083846134*^9}, {
  3.7118579635285473`*^9, 3.7118579730233097`*^9}, {3.711859901429471*^9, 
  3.711859949348815*^9}, {3.711861438665924*^9, 3.711861491928409*^9}, {
  3.7118615491108637`*^9, 3.7118616034527884`*^9}, {3.711861850712454*^9, 
  3.7118618578113117`*^9}, {3.7118621258512917`*^9, 3.7118621710487022`*^9}, {
  3.711864364844269*^9, 3.711864366214472*^9}, {3.711864414981121*^9, 
  3.711864419420649*^9}, {3.711864501250905*^9, 3.7118645042578583`*^9}, {
  3.7118908698428392`*^9, 3.711890871065099*^9}, {3.711890925743285*^9, 
  3.711890929502825*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "variance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"variances", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{
        "\"\<zz-data/clonal-mouse/varianceSigma\>\"", "<>", "#", "<>", 
         "\"\<.dat\>\""}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"\"\<00\>\"", ",", "\"\<01\>\"", ",", "\"\<05\>\""}], "}"}]}], 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.711861679707357*^9, 3.711861739215123*^9}, {
   3.711861830325004*^9, 3.7118618368692102`*^9}, {3.711861869586241*^9, 
   3.711861884705677*^9}, 3.711861939624886*^9, 3.711862128442244*^9, {
   3.7118644216446533`*^9, 3.711864443588114*^9}, 3.711864477370696*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySym", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "0.7"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mySymBig", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "1"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linePlot", "=", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"conditionalTime", "[", 
            RowBox[{"z0", ",", "\[Sigma]", ",", "params00"}], "]"}], ",", " ", 
           RowBox[{"conditionalTime", "[", 
            RowBox[{"z0", ",", "\[Sigma]", ",", "params01"}], "]"}], ",", 
           RowBox[{"conditionalTime", "[", 
            RowBox[{"z0", ",", "\[Sigma]", ",", "params05"}], "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Sigma]", ",", 
           SuperscriptBox["10", 
            RowBox[{"-", "3"}]], ",", "1"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "3"}]], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "20"}], "}"}]}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", "params00"}],
                 ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", "params01"}],
                 ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", 
                 "params05"}]}], "}"}], ",", 
              RowBox[{
              "LegendLabel", "\[Rule]", 
               "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]\>\""}], 
              ",", 
              RowBox[{"LegendMarkers", "\[Rule]", "mySymBig"}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
              RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.12", ",", "0.55"}], "}"}], "]"}]}], "]"}]}]}], "]"}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"plotVarianceSigma", "[", 
          RowBox[{
           RowBox[{"variances", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"myCol", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.3"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"ticksSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Level of clonality\>\"", ",", "labelSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Mean time (years)\>\"", ",", "labelSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logTicks", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.1", ",", "100"}], "}"}], ",", "False", ",", "True", 
              ",", "False", ",", "True"}], "]"}], ",", 
            RowBox[{"logTicks", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"0.1", ",", "100"}], "}"}], ",", "False", ",", "False",
               ",", "False", ",", "True"}], "]"}]}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
      "]"}], "/.", "myPlotStyle"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dataPlot", "=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"errorLogLinearPlot", "[", 
      RowBox[{"x00", ",", "\[Sigma]00", ",", 
       RowBox[{"myCol", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"mySym", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"errorLogLinearPlot", "[", 
      RowBox[{"x01", ",", "\[Sigma]01", ",", 
       RowBox[{"myCol", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"mySym", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"errorLogLinearPlot", "[", 
      RowBox[{"x05", ",", "\[Sigma]05", ",", 
       RowBox[{"myCol", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"mySym", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}]}], " ", "]"}]}], 
  ";"}], "\n", 
 RowBox[{"leftPlot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"linePlot", ",", "dataPlot", ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(a)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
        "myPlotStyle"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}]}], " ", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.677916118080035*^9, 3.677916208052541*^9}, {
   3.677916258298935*^9, 3.677916259418841*^9}, {3.677916771466055*^9, 
   3.6779167794889107`*^9}, {3.677917099326137*^9, 3.6779171427643547`*^9}, {
   3.677924318672344*^9, 3.677924395101562*^9}, {3.67792514077217*^9, 
   3.677925143555801*^9}, {3.677925385348473*^9, 3.67792539341159*^9}, {
   3.677925552310631*^9, 3.677925553509976*^9}, {3.677925878331791*^9, 
   3.6779258797948236`*^9}, {3.677927311635248*^9, 3.677927389775907*^9}, {
   3.6779277298362722`*^9, 3.677927733556028*^9}, {3.677928885757535*^9, 
   3.677928984849393*^9}, {3.677929016128669*^9, 3.677929064270731*^9}, {
   3.6779292950388823`*^9, 3.677929324485771*^9}, {3.6779299054353437`*^9, 
   3.677929948944591*^9}, {3.677930007223274*^9, 3.677930019086225*^9}, {
   3.677930055037183*^9, 3.6779300605327673`*^9}, {3.6779301075715513`*^9, 
   3.677930107707312*^9}, {3.6779987757000837`*^9, 3.6779989084786587`*^9}, {
   3.677999038707144*^9, 3.677999144950542*^9}, {3.677999243851431*^9, 
   3.6779992440113487`*^9}, {3.677999599424268*^9, 3.677999659525065*^9}, {
   3.6786190721462727`*^9, 3.678619073361067*^9}, {3.678622641782282*^9, 
   3.6786226465978737`*^9}, {3.6786227286678658`*^9, 
   3.6786227294437037`*^9}, {3.6786228293192587`*^9, 3.678622830575287*^9}, {
   3.6815556075243607`*^9, 3.6815556221557913`*^9}, {3.6864875470337133`*^9, 
   3.6864875575535593`*^9}, {3.686487616840316*^9, 3.686487617151389*^9}, {
   3.6903662251514463`*^9, 3.690366242445799*^9}, {3.6903663162759247`*^9, 
   3.690366320533085*^9}, {3.69036643088758*^9, 3.6903666250640993`*^9}, {
   3.690366655359283*^9, 3.690366660454789*^9}, {3.6904457818984756`*^9, 
   3.690445783106982*^9}, {3.690447064878134*^9, 3.690447076900538*^9}, {
   3.690447299437601*^9, 3.690447299861094*^9}, {3.690448462013596*^9, 
   3.6904484703794117`*^9}, 3.690449520383689*^9, {3.6904509477950563`*^9, 
   3.6904509481629457`*^9}, {3.695370084526804*^9, 3.695370107876642*^9}, {
   3.695584589717746*^9, 3.6955845934535017`*^9}, {3.69558582998905*^9, 
   3.695585830963788*^9}, 3.6955858654051533`*^9, {3.6955859115043383`*^9, 
   3.695585952855996*^9}, {3.695585992310442*^9, 3.695586036731873*^9}, {
   3.6955861313298197`*^9, 3.6955861588624353`*^9}, {3.6955862662448683`*^9, 
   3.695586310235252*^9}, {3.695649386331769*^9, 3.695649389877201*^9}, {
   3.6960537616068*^9, 3.696053766574842*^9}, {3.696053811987389*^9, 
   3.696053852257805*^9}, {3.696055635951766*^9, 3.696055691852951*^9}, {
   3.696055834371499*^9, 3.696056073235878*^9}, {3.696064963755197*^9, 
   3.696064966378512*^9}, {3.696065168911439*^9, 3.696065179414555*^9}, {
   3.69606560008549*^9, 3.696065651984247*^9}, {3.6960657192789717`*^9, 
   3.69606573586139*^9}, 3.696144550843446*^9, {3.696144685398863*^9, 
   3.6961446985091953`*^9}, {3.69614473801931*^9, 3.696144747554928*^9}, {
   3.6961516481338043`*^9, 3.696151652957499*^9}, {3.696151694973927*^9, 
   3.6961517159105883`*^9}, {3.6961518247995253`*^9, 3.69615185645398*^9}, {
   3.697180698810095*^9, 3.6971807010977573`*^9}, {3.697180971826635*^9, 
   3.6971809804560003`*^9}, {3.711452088835411*^9, 3.71145208948431*^9}, {
   3.711452324859931*^9, 3.711452350138906*^9}, {3.711452438384635*^9, 
   3.711452519686976*^9}, {3.711453222311255*^9, 3.7114532670827417`*^9}, {
   3.71179217309523*^9, 3.7117921892370663`*^9}, {3.711800433719986*^9, 
   3.711800510036565*^9}, {3.711806899221843*^9, 3.711806915275424*^9}, {
   3.711807156851274*^9, 3.711807170937956*^9}, {3.711807298006548*^9, 
   3.71180729869368*^9}, {3.711807388191731*^9, 3.7118073896037407`*^9}, 
   3.711807441730809*^9, {3.711807570594692*^9, 3.7118075709899387`*^9}, {
   3.7118078891389513`*^9, 3.7118078893239927`*^9}, {3.71180818285837*^9, 
   3.711808188312931*^9}, {3.711861947048793*^9, 3.711861979810544*^9}, 
   3.71186218191616*^9, {3.7118644514369373`*^9, 3.7118644743321247`*^9}, {
   3.712134927335659*^9, 3.712134990436595*^9}, {3.712135058420175*^9, 
   3.7121350612900877`*^9}, {3.712135097954515*^9, 3.712135122063802*^9}, {
   3.7121356350015783`*^9, 3.712135698068397*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Right: Selective effect required to reach \[Sigma]-clonality in given time\
\>", "Subsection",
 CellChangeTimes->{{3.695582455376359*^9, 3.695582516244021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "data", " ", "and", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"dir", "=", "\"\<zz-data/clonal-mouse/epsilon_vary\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nFiles", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<chimerismData_*.dat\>\"", ",", "dir"}], "]"}], " ", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"getPars", "[", "dir", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\n", 
   RowBox[{
    RowBox[{"totalRuns", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1000", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"clonalLevels", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10.", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"0.1", "i"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "\[Sigma]"}], "}"}], "=", 
     RowBox[{"extractClonalStats", "[", 
      RowBox[{"dir", ",", "totalRuns", ",", "clonalLevels"}], "]"}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"z0", "=", 
     RowBox[{"getZ0", "[", 
      RowBox[{"params", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"\[Sigma]Index", "=", 
     RowBox[{"{", 
      RowBox[{"1", ",", "11", ",", "21", ",", "31"}], "}"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "Select", " ", "certain", " ", "levels", " ", "of", " ", "clonality"}], 
     ",", " ", 
     RowBox[{"i", ".", "e", ".", " ", "0.001"}], ",", " ", "0.01", ",", " ", 
     "0.1", ",", " ", "1.0"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]Vals", "=", 
     RowBox[{"x", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "\[Sigma]Index", ",", "1"}], "]"}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.690448606838677*^9, 3.690448723346026*^9}, {
   3.690448938550281*^9, 3.6904489407141027`*^9}, {3.6904490700222883`*^9, 
   3.690449070125379*^9}, {3.690450858008995*^9, 3.69045088735635*^9}, {
   3.6923690132438717`*^9, 3.692369015866384*^9}, {3.6955867936345387`*^9, 
   3.6955868425694304`*^9}, {3.6955869108885202`*^9, 
   3.6955869150953197`*^9}, {3.695586948256383*^9, 3.6955869811131687`*^9}, {
   3.6955872098757763`*^9, 3.695587262927326*^9}, 3.6955873800142307`*^9, {
   3.695587443136087*^9, 3.6955874667376547`*^9}, {3.6955880669091473`*^9, 
   3.695588073460517*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Store", " ", "variance", " ", "as", " ", "it", " ", "takes", " ", "a", 
    " ", "long", " ", "time", " ", "to", " ", "calculate"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Comment", " ", "out", " ", "to", " ", "avoid", " ", "recomputing"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"export", "[", "label_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "name", ",", "dir", ",", "list"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Sigma]", "=", 
         RowBox[{"\[Sigma]Vals", "[", 
          RowBox[{"[", "label", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"\"\<varianceEpsilon\>\"", "<>", 
          RowBox[{"ToString", "[", "label", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dir", "=", "\"\<zz-data/clonal-mouse/\>\""}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"list", "=", 
         RowBox[{"getVarianceEpsilon", "[", 
          RowBox[{"z0", ",", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"params", "[", 
              RowBox[{"[", "1", "]"}], "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}], ",", "\[Sigma]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"dir", "<>", "name", "<>", "\"\<.dat\>\""}], ",", "list"}], 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{"export", ",", 
       RowBox[{"Range", "[", 
        RowBox[{"Length", "[", "\[Sigma]Vals", "]"}], " ", "]"}]}], " ", 
      "]"}]}]}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.711855081953691*^9, 3.711855083846134*^9}, {
  3.7118579635285473`*^9, 3.7118579730233097`*^9}, {3.711859901429471*^9, 
  3.711859949348815*^9}, {3.711861438665924*^9, 3.711861491928409*^9}, {
  3.7118615491108637`*^9, 3.7118616034527884`*^9}, {3.711861850712454*^9, 
  3.7118618578113117`*^9}, {3.7118621258512917`*^9, 3.711862224687482*^9}, {
  3.711862274397234*^9, 3.711862357251113*^9}, {3.711862401369664*^9, 
  3.711862454951056*^9}, {3.711862498574451*^9, 3.711862498861411*^9}, {
  3.711866348260968*^9, 3.7118663509967413`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Import", " ", "variance"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"variances", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"\"\<zz-data/clonal-mouse/varianceEpsilon\>\"", "<>", 
         RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], "]"}], 
       "&"}], ",", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "\[Sigma]Vals", "]"}], " ", "]"}]}], " ", 
     "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.711861679707357*^9, 3.711861739215123*^9}, {
   3.711861830325004*^9, 3.7118618368692102`*^9}, {3.711861869586241*^9, 
   3.711861884705677*^9}, 3.711861939624886*^9, 3.711862128442244*^9, {
   3.711862527523933*^9, 3.711862631048571*^9}, {3.7118627086786823`*^9, 
   3.711862725855975*^9}, {3.7118633868884773`*^9, 3.711863414070572*^9}, 
   3.711865631500929*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySym", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "0.7"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mySymBig", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"symFull", "/.", "myPlotStyle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "1"}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"linePlot", "=", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"1", "+", "0"}], ",", 
                RowBox[{"conditionalTime", "[", 
                 RowBox[{"z0", ",", "\[Sigma]", ",", 
                  RowBox[{"Append", "[", 
                   RowBox[{
                    RowBox[{"Drop", "[", 
                    RowBox[{
                    RowBox[{"params", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], ",", 
                    RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], "]"}]}], " ", 
                 "]"}]}], "}"}], "}"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", 
                  RowBox[{"params", "[", 
                   RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                 RowBox[{"conditionalTime", "[", 
                  RowBox[{"z0", ",", "\[Sigma]", ",", 
                   RowBox[{"params", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}]}], "}"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], " ",
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "\[Sigma]Vals"}], "}"}]}], "]"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"ToString", "[", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "\[GreaterEqual]", "0.01"}], ",", 
                    RowBox[{"Round", "[", 
                    RowBox[{"100", "\[Sigma]"}], "]"}], ",", 
                    RowBox[{"100", "\[Sigma]"}]}], "]"}], " ", "]"}], "<>", 
                 "\"\<%\>\""}], ",", 
                RowBox[{"{", 
                 RowBox[{"\[Sigma]", ",", "\[Sigma]Vals"}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"LegendMarkers", "\[Rule]", "mySymBig"}], ",", 
              RowBox[{"LegendLabel", "\[Rule]", "\"\<Clonality\>\""}], ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
              RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.86", ",", "0.63"}], "}"}], "]"}]}], " ", "]"}]}]}], 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "6"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "4"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AxesOrigin", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"ticksSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<Fold advantage, \!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\
\[Beta]\>\"", ",", "labelSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Mean time (years)\>\"", ",", "labelSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
      "]"}], "/.", "myPlotStyle"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"varPlot", "=", 
    RowBox[{"Show", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"plotVarianceEpsilon", "[", 
        RowBox[{
         RowBox[{"variances", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", 
         RowBox[{"myCol", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Sigma]Vals", "]"}]}], "}"}]}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[CapitalDelta]", "=", "10"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"dataPlot", "=", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"errorPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", 
              RowBox[{"params", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"x", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"\[Sigma]Index", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nFiles", ",", "\[CapitalDelta]"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", 
              RowBox[{"params", "[", 
               RowBox[{"[", "i", "]"}], "]"}]}], ",", 
             RowBox[{"\[Sigma]", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", 
                RowBox[{"\[Sigma]Index", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", "2"}], "]"}], "]"}]}], 
            "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "nFiles", ",", "\[CapitalDelta]"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"myCol", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"mySym", "[", 
          RowBox[{"[", "j", "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", 
         RowBox[{"Length", "[", "\[Sigma]Index", "]"}]}], "}"}]}], "]"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timeFix", "=", 
   RowBox[{"{", 
    RowBox[{"0.5", ",", "2.0", ",", "2.0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]Fix", "=", 
   RowBox[{"{", 
    RowBox[{"1.0", ",", "1.0", ",", "0.01"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Root", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"findTimeRoot", "[", 
      RowBox[{
       RowBox[{"timeFix", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "z0", ",", 
       RowBox[{"\[Sigma]Fix", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{"params", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "timeFix", "]"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"examplePlot", "=", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "t"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Epsilon]"}], ")"}], ",", "t"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "+", "\[Epsilon]"}], ")"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"t", "\[Rule]", 
            RowBox[{"timeFix", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], ",", 
           RowBox[{"\[Epsilon]", "\[Rule]", 
            RowBox[{"\[Epsilon]Root", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "timeFix", "]"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"Joined", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"Black", ",", "Dotted", ",", 
         RowBox[{"Thickness", "[", "0.003", "]"}]}], " ", "]"}]}]}], " ", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"rightPlot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
   "linePlot", ",", "varPlot", ",", "dataPlot", ",", "examplePlot", ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(b)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
        "myPlotStyle"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}]}], " ", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.69044902417835*^9, 3.69044905473464*^9}, {
   3.690449085788896*^9, 3.690449127475423*^9}, {3.6904491750194283`*^9, 
   3.69044919528903*^9}, {3.6904492902063723`*^9, 3.690449309412921*^9}, {
   3.6904493971232557`*^9, 3.690449626681532*^9}, {3.6904496635532503`*^9, 
   3.690449730822081*^9}, 3.690449850006855*^9, {3.6904506255748243`*^9, 
   3.69045062571809*^9}, {3.690450890069005*^9, 3.690450890252689*^9}, {
   3.690450922445623*^9, 3.690450938251157*^9}, {3.6904510226330233`*^9, 
   3.690451023616387*^9}, {3.6904512883908854`*^9, 3.690451334061041*^9}, {
   3.690451762742738*^9, 3.690451801436171*^9}, {3.690451836490991*^9, 
   3.690451849170507*^9}, {3.690451961743293*^9, 3.6904519633590508`*^9}, {
   3.690452003285797*^9, 3.6904520813470163`*^9}, {3.690452360313458*^9, 
   3.690452477716146*^9}, {3.690452511786903*^9, 3.690452584936167*^9}, {
   3.690452780234929*^9, 3.690452832263406*^9}, {3.692357337057042*^9, 
   3.6923573414407873`*^9}, 3.692426017241672*^9, {3.695370185217869*^9, 
   3.695370248790696*^9}, {3.6953705361440487`*^9, 3.695370608337878*^9}, {
   3.695587554831306*^9, 3.695587634722918*^9}, {3.6955876891650457`*^9, 
   3.69558769664318*^9}, {3.69558791537848*^9, 3.695587996125842*^9}, {
   3.695588083277522*^9, 3.695588084651593*^9}, {3.695588353766358*^9, 
   3.695588365001317*^9}, {3.695588397932398*^9, 3.6955884107697477`*^9}, {
   3.69606603094932*^9, 3.69606607542069*^9}, {3.696066246956717*^9, 
   3.696066281545814*^9}, {3.696066452076923*^9, 3.69606647803065*^9}, 
   3.6960667949627132`*^9, {3.6961440720677013`*^9, 3.696144128369269*^9}, {
   3.6961441891278763`*^9, 3.696144212350272*^9}, {3.696144267892179*^9, 
   3.696144306738615*^9}, {3.69615187475073*^9, 3.6961518769251966`*^9}, 
   3.696152195805696*^9, {3.696152343949586*^9, 3.69615248077638*^9}, {
   3.6961530519004498`*^9, 3.696153094841416*^9}, {3.696153257004941*^9, 
   3.6961532589560757`*^9}, {3.696154071896015*^9, 3.696154073007996*^9}, {
   3.696154593764984*^9, 3.6961545964279203`*^9}, {3.711808824411964*^9, 
   3.71180883381666*^9}, {3.7118096778956957`*^9, 3.711809715949231*^9}, {
   3.711862818581156*^9, 3.7118628570017014`*^9}, {3.711863426112012*^9, 
   3.711863434982298*^9}, {3.711866309182687*^9, 3.711866310294179*^9}, {
   3.7121357610838947`*^9, 3.7121357881863537`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Combine leftPlot and rightPlot into two-panel plot", "Subsection",
 CellChangeTimes->{{3.695582455376359*^9, 3.695582479197035*^9}, {
  3.695582521316635*^9, 3.695582522188035*^9}, {3.695586382064013*^9, 
  3.695586395461956*^9}, {3.695588479669037*^9, 3.695588493295998*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Row", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"leftPlot", ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "pad"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"rightPlot", ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "pad"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"pad", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"47", ",", "18"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", "5"}], "}"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6904528489773817`*^9, 3.690453033143361*^9}, {
  3.6955825457106667`*^9, 3.695582549325396*^9}, {3.7087783095385227`*^9, 
  3.708778309809368*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["CDF incidence curves", "Subsection",
 CellChangeTimes->{{3.711953529370816*^9, 3.711953534549067*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "data", " ", "and", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"totalRuns", "=", 
     RowBox[{"{", "10000", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clonalLevels", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10.", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"0.1", "i"}]}]], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "30"}], "}"}]}], "]"}]}], ";"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Only", " ", "look", " ", "at", " ", "4", "%", " ", "clonality"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"clonalIndex", "=", "17"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6955829022354383`*^9, 3.6955829050451736`*^9}, {
   3.6955837865020447`*^9, 3.695583830692227*^9}, {3.6955838754794407`*^9, 
   3.695583901558071*^9}, {3.6955840368575363`*^9, 3.695584048665114*^9}, {
   3.695584110491275*^9, 3.695584124897375*^9}, 3.695584572907943*^9, {
   3.6955861920140467`*^9, 3.6955862465963497`*^9}, {3.6960652105675783`*^9, 
   3.696065282539715*^9}, {3.6960655241070633`*^9, 3.6960655708428183`*^9}, {
   3.696144369136277*^9, 3.696144388064481*^9}, {3.696144561009338*^9, 
   3.6961446744136057`*^9}, {3.6971806384364862`*^9, 3.69718063857157*^9}, {
   3.697180681426426*^9, 3.697180683362007*^9}, {3.6971807721780148`*^9, 
   3.697180772350831*^9}, {3.697180821342202*^9, 3.697180841628561*^9}, {
   3.7119551982462397`*^9, 3.711955300265978*^9}, {3.711955351697122*^9, 
   3.711955354683716*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dir", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\<zz-data/clonal-mouse/epsilon_\>\"", "<>", "#"}], "&"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\"\<00\>\"", ",", "\"\<01\>\"", ",", "\"\<05\>\""}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"First", "[", 
        RowBox[{"getPars", "[", "#", "]"}], " ", "]"}], "&"}], ",", "dir"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"z0", "=", 
    RowBox[{"getZ0", "[", 
     RowBox[{"params", "[", 
      RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timeData", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getClonalData", "[", 
          RowBox[{"#", ",", "totalRuns"}], "]"}], "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1", ",", "clonalIndex"}], "]"}], "]"}], "/", 
        "365.25"}], "&"}], ",", "dir"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tMin", "=", "0.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tMax", "=", 
    RowBox[{"Max", "[", "timeData", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"incidenceCurveList", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"getIncidenceCurve", "[", 
        RowBox[{"#", ",", "tMin", ",", "tMax"}], "]"}], "&"}], ",", 
      "timeData"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mean", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"conditionalTime", "[", 
       RowBox[{"z0", ",", 
        RowBox[{"clonalLevels", "[", 
         RowBox[{"[", "clonalIndex", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
     ",", "params"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"var", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"variance", "[", 
       RowBox[{"z0", ",", 
        RowBox[{"clonalLevels", "[", 
         RowBox[{"[", "clonalIndex", "]"}], "]"}], ",", "#"}], "]"}], "&"}], 
     ",", "params"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6955829022354383`*^9, 3.6955829050451736`*^9}, {
   3.6955837865020447`*^9, 3.695583830692227*^9}, {3.6955838754794407`*^9, 
   3.695583901558071*^9}, {3.6955840368575363`*^9, 3.695584048665114*^9}, {
   3.695584110491275*^9, 3.695584124897375*^9}, 3.695584572907943*^9, {
   3.6955861920140467`*^9, 3.6955862465963497`*^9}, {3.6960652105675783`*^9, 
   3.696065282539715*^9}, {3.6960655241070633`*^9, 3.6960655708428183`*^9}, {
   3.696144369136277*^9, 3.696144388064481*^9}, {3.696144561009338*^9, 
   3.6961446744136057`*^9}, {3.6971806384364862`*^9, 3.69718063857157*^9}, {
   3.697180681426426*^9, 3.697180683362007*^9}, {3.6971807721780148`*^9, 
   3.697180772350831*^9}, {3.697180821342202*^9, 3.697180841628561*^9}, {
   3.7119551982462397`*^9, 3.711955300265978*^9}, {3.711955351697122*^9, 
   3.7119554812208357`*^9}, {3.711955568481041*^9, 3.711955593192033*^9}, {
   3.711955640855406*^9, 3.711955686981801*^9}, {3.711955742915868*^9, 
   3.7119557794579268`*^9}, {3.71196561349971*^9, 3.7119656673530912`*^9}, {
   3.711969559093872*^9, 3.711969559677593*^9}, {3.711969606932816*^9, 
   3.711969607086102*^9}, {3.711969656299844*^9, 3.711969656418415*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Predicted", " ", "incidence", " ", "curve", " ", "based", " ", "on", " ", 
    "normally", " ", "distributed", " ", "data", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mean", "=", "\[Mu]"}], ",", " ", 
      RowBox[{"variance", "=", "v"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"t_", ",", "\[Mu]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"0.5", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"t", "-", "\[Mu]"}], 
         RowBox[{
          RowBox[{"Sqrt", "[", "v", "]"}], 
          SqrtBox["2"]}]], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Show", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{"incidenceCurveList", ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", "Thin"}], ",", 
        RowBox[{"Filling", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"1", "->", "Bottom"}], ",", 
           RowBox[{"2", "\[Rule]", 
            RowBox[{"{", "1", "}"}]}], ",", 
           RowBox[{"3", "\[Rule]", 
            RowBox[{"{", "2", "}"}]}]}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"LogLinearPlot", "[", 
       RowBox[{
        RowBox[{"Evaluate", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"f", "[", 
            RowBox[{"t", ",", 
             RowBox[{"mean", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ",", 
             RowBox[{"var", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "mean", "]"}]}], "}"}]}], "]"}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotLegends", "\[Rule]", 
         RowBox[{"Placed", "[", 
          RowBox[{
           RowBox[{"LineLegend", "[", 
            RowBox[{
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", "#"}], "&"}],
                ",", "params"}], "]"}], ",", 
             RowBox[{
             "LegendLabel", "\[Rule]", 
              "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]\>\""}], 
             ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"18", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
             RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
             RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.85", ",", "0.35"}], "}"}], "]"}]}], "]"}]}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"1", "-", 
             RowBox[{"Exp", "[", 
              RowBox[{"-", 
               FractionBox["t", 
                RowBox[{"mean", "[", 
                 RowBox[{"[", "i", "]"}], "]"}]]}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "mean", "]"}]}], "}"}]}], "]"}], "]"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0.001", ",", 
           RowBox[{"Max", "[", "timeData", "]"}]}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Dotted"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameTicksStyle", "\[Rule]", 
       RowBox[{"Directive", "[", 
        RowBox[{"ticksSize", ",", 
         RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], ",",
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["i", 
                  RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
                 RowBox[{
                  RowBox[{"ToString", "[", 
                   RowBox[{"N", "[", 
                    RowBox[{"100", " ", 
                    SuperscriptBox["10", "i"]}], "]"}], "]"}], "<>", 
                  "\"\<%\>\""}]}], 
                RowBox[{"(*", 
                 RowBox[{"Superscript", "[", 
                  RowBox[{"\"\<10\>\"", ",", "i"}], "]"}], "*)"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "4"}], ",", "0"}], "}"}]}], "]"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 FractionBox["i", 
                  RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
                 "\"\<\>\""}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"-", "4"}], ",", "0"}], "}"}]}], "]"}]}], "}"}]}], 
          "}"}]}], ","}], "\[IndentingNewLine]", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", "]"}],
     "/.", "myPlotStyle"}]}]}]], "Input",
 CellChangeTimes->{{3.7119549398584347`*^9, 3.711954949006321*^9}, {
  3.7119550240919437`*^9, 3.71195503941847*^9}, {3.7119550854012003`*^9, 
  3.711955086889786*^9}, {3.711955690492942*^9, 3.711955718179945*^9}, {
  3.7119557891535387`*^9, 3.7119558047864027`*^9}, {3.711955836559843*^9, 
  3.7119561082955027`*^9}, {3.711963935518661*^9, 3.7119639375007973`*^9}, {
  3.711963968868813*^9, 3.711963982763153*^9}, {3.71196470675812*^9, 
  3.711964725473855*^9}, {3.711964764113021*^9, 3.7119649474901743`*^9}, {
  3.711965029512555*^9, 3.7119650597598867`*^9}, {3.711965122605541*^9, 
  3.7119651330841017`*^9}, {3.711965195139632*^9, 3.7119652160971193`*^9}, {
  3.711965441418807*^9, 3.711965441807372*^9}, {3.711965565998166*^9, 
  3.711965572004717*^9}, {3.711969566463187*^9, 3.711969603502037*^9}, {
  3.711969644031961*^9, 3.711969648123452*^9}, {3.711970427296702*^9, 
  3.711970438416059*^9}}]
}, Closed]]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["4. Clonal dominance in man", "Chapter",
 CellChangeTimes->{{3.695588645175877*^9, 3.695588659541484*^9}, {
  3.695707692135887*^9, 3.695707692503851*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.6955890897629538`*^9, 3.695589090800853*^9}}],

Cell[CellGroupData[{

Cell["Parameter defintions", "Subsection",
 CellChangeTimes->{{3.6955894927407713`*^9, 3.695589497804264*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"paramFunc", "[", 
   RowBox[{
   "\[Section]\[ScriptCapitalN]_", ",", "\[Section]\[ScriptL]_", ",", 
    "\[Section]\[Beta]_", ",", "\[Section]\[Epsilon]_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "\[Section]\[ScriptCapitalN]"}], 
     ",", 
     RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
     RowBox[{"nStar", "\[Rule]", "\[Section]nStar"}], ",", 
     RowBox[{"\[ScriptCapitalS]", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", "\[Section]\[Beta]"}], ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", "\[Section]\[ScriptL]"}], ",", 
     RowBox[{"\[Delta]", "\[Rule]", 
      FractionBox[
       RowBox[{"\[Section]\[Beta]", " ", "\[Section]nStar"}], 
       "\[Section]sStar"]}], ",", 
     RowBox[{"d", "\[Rule]", 
      RowBox[{
       FractionBox["\[Section]sStar", 
        RowBox[{"\[Section]\[ScriptL]", " ", "\[Section]nStar"}]], "-", 
       "\[Section]\[Beta]"}]}], ",", 
     RowBox[{"a", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox["1", "\[Section]\[ScriptL]"], "-", 
         FractionBox[
          RowBox[{"\[Section]\[Beta]", " ", "\[Section]nStar"}], 
          "\[Section]sStar"]}], ")"}], 
       FractionBox["\[Section]\[ScriptCapitalN]", 
        RowBox[{"\[Section]\[ScriptCapitalN]", "-", "\[Section]nStar"}]]}]}], 
     ",", 
     RowBox[{"\[Epsilon]", "\[Rule]", "\[Section]\[Epsilon]"}], ",", 
     RowBox[{"\[Gamma]\[Beta]", "\[Rule]", "1"}], ",", 
     RowBox[{"\[Gamma]\[Delta]", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Gamma]d", "\[Rule]", "0"}], ",", 
     RowBox[{"\[Gamma]a", "\[Rule]", "0"}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Section]sStar", "\[Rule]", 
      RowBox[{"0.01", "\[Section]\[ScriptCapitalN]"}]}], ",", 
     RowBox[{"\[Section]nStar", "\[Rule]", 
      RowBox[{"0.99", "\[Section]\[ScriptCapitalN]"}]}]}], "}"}]}]}]], "Input",\

 CellChangeTimes->{{3.677307197501821*^9, 3.6773072432914267`*^9}, {
  3.677310717751606*^9, 3.677310789044224*^9}, {3.677330574617743*^9, 
  3.6773305825373774`*^9}, {3.677408378027923*^9, 3.6774083809541483`*^9}, {
  3.6856943011248693`*^9, 3.685694301660049*^9}, {3.685694885616394*^9, 
  3.68569501059559*^9}, {3.6856950527855988`*^9, 3.6856951082236147`*^9}, {
  3.685695162949751*^9, 3.685695172272966*^9}, {3.685695218523745*^9, 
  3.685695255106802*^9}, {3.686375971738752*^9, 3.6863760218009367`*^9}, {
  3.6955895150223*^9, 3.695589515788673*^9}, {3.6955896280958233`*^9, 
  3.6955896323264017`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Analytical results", "Subsection",
 CellChangeTimes->{{3.695588617015256*^9, 3.69558861988592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getZ0", "[", "params_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "z0", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"z0", "=", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"a", 
          FractionBox[
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], 
           "\[ScriptCapitalN]"]}], 
         RowBox[{"\[Delta]", "+", 
          RowBox[{"a", 
           FractionBox[
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], 
            "\[ScriptCapitalN]"]}]}]], 
        FractionBox["1", "\[ScriptCapitalN]"]}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "z0", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.668841539600287*^9, 3.668841561906837*^9}, {
   3.668841616682199*^9, 3.668841619345768*^9}, {3.668841746797442*^9, 
   3.668841752108912*^9}, 3.66884188208971*^9, {3.668842044618889*^9, 
   3.668842049849934*^9}, {3.6688420839213943`*^9, 3.6688422549568567`*^9}, {
   3.67749076451233*^9, 3.677490781687209*^9}, {3.677490828637987*^9, 
   3.677490828927264*^9}, {3.677490875829639*^9, 3.6774908779562693`*^9}, {
   3.677490928098897*^9, 3.677490968104032*^9}, {3.677492918547641*^9, 
   3.6774929346022387`*^9}, {3.695584308088787*^9, 3.6955843251507587`*^9}, {
   3.695584381989959*^9, 3.695584398074939*^9}, {3.695584451565102*^9, 
   3.6955845298680887`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conditionalProb", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "prob"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"prob", "=", 
        FractionBox["z0", 
         RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"prob", "=", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
             "\[Xi]"}], "]"}]}]], ")"}]}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "prob", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695586504409417*^9, 3.6955866467615223`*^9}, {
   3.695586702077282*^9, 3.695586720452691*^9}, {3.711889333614003*^9, 
   3.711889368398201*^9}, 3.7118895614805183`*^9, {3.711889593406344*^9, 
   3.711889678475431*^9}, {3.7118897960392103`*^9, 3.7118899657300158`*^9}, {
   3.71189003902357*^9, 3.7118900407838087`*^9}, {3.711890092901648*^9, 
   3.711890164562224*^9}, {3.711890203186524*^9, 3.711890261958644*^9}, 
   3.711890297310302*^9, 3.7118903452206783`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conditionalTime", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "time"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"time", "=", 
           RowBox[{
            FractionBox["\[Section]\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
            FractionBox[
             RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Xi]", "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[Xi]", "-", "z0"}], "]"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"time", "=", 
           RowBox[{
            FractionBox["\[Section]\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
            FractionBox[
             RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Xi]", "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[Xi]", "-", "z0"}], "]"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Sigma]"}], ")"}], "z0"}], 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]], 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "\[Sigma]"}], "]"}]}]}], ")"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"time", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Section]\[ScriptCapitalN]", 
                RowBox[{" ", 
                 RowBox[{
                 "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", 
                  "\[Xi]"}]}]]}], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
                  "1"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"EulerGamma", "+", 
                   RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
                   RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"3", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "-", 
                   
                   RowBox[{"3", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", "z", "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}],
                   ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                    
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"ExpIntegralEi", "[", 
                  RowBox[{
                   RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"2", "\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                   "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                 RowBox[{"ExpIntegralEi", "[", 
                  RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "-", 
                   RowBox[{"2", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}], ")"}], "/.", 
            RowBox[{"z", "\[Rule]", "z0"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"time", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["\[Section]\[ScriptCapitalN]", 
               RowBox[{
               "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", "\[Xi]"}]], 
              
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                   "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], "]"}],
                   "-", "1"}], ")"}], " "}]], 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"EulerGamma", "+", 
                   RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
                   RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}]}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", "z", "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
                    "]"}]}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], " ", 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", "1"}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                    
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "+", 
                   
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], 
                    "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}], 
                    " ", 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}],
                    "+", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}],
                    "-", 
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Xi]", " ", "\[Sigma]"}], 
                    "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                    "\[Xi]"}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}],
                   ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"1", "-", "\[Sigma]"}], "]"}], "-", 
                   RowBox[{"Log", "[", "\[Sigma]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
                    "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/.", 
            RowBox[{"z", "\[Rule]", "z0"}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"time", "/", "365.25"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.69558468484597*^9, 3.695584718769825*^9}, {
   3.6955848037398043`*^9, 3.695584899448827*^9}, {3.695584955617128*^9, 
   3.695584980574943*^9}, {3.6955852085987377`*^9, 3.6955852577202473`*^9}, {
   3.6955852985182047`*^9, 3.6955854012801228`*^9}, {3.695585492999866*^9, 
   3.695585494576703*^9}, {3.6955855448124933`*^9, 3.6955855695475492`*^9}, {
   3.6955856712545137`*^9, 3.695585707584066*^9}, 3.695585763156383*^9, {
   3.6955858753117113`*^9, 3.695585879204714*^9}, {3.71179422580057*^9, 
   3.7117942529755573`*^9}, {3.7117943741420517`*^9, 3.711794375703191*^9}, {
   3.711794414425766*^9, 3.711794435872561*^9}, {3.7117976755762863`*^9, 
   3.7117977025990257`*^9}, {3.711797775887155*^9, 3.71179777938892*^9}, 
   3.711798326498131*^9, {3.711798520250523*^9, 3.711798530086753*^9}, {
   3.7118026866630583`*^9, 3.711802713019799*^9}, {3.711802966435885*^9, 
   3.7118029825063972`*^9}, {3.711890362280406*^9, 3.711890510761325*^9}, 
   3.7118906265092897`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"variance", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "sec", ",", "var", ",", "sol", ",", 
      "\[CapitalDelta]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sec", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"2", 
              SuperscriptBox["\[Section]\[ScriptCapitalN]", "2"]}], 
             SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"\[Xi]", "-", "z0"}], "\[Xi]"], "]"}]}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", "1"}], "]"}], "-", 
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", 
                  FractionBox["z0", "\[Xi]"]}], "]"}]}], ")"}]}], ")"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"sec", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[Section]\[ScriptCapitalN]", "2"]}], 
             SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"\[Xi]", "-", "z0"}], "z0"], " ", 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"\[Xi]", "-", "z0"}], "\[Xi]"], "]"}]}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", "\[Sigma]"}], "]"}], "-", " ", 
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", 
                  FractionBox["z0", "\[Xi]"]}], "]"}]}], ")"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], " ", 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "\[Sigma]"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
                  RowBox[{"Log", "[", 
                   FractionBox["\[Xi]", 
                    RowBox[{"\[Xi]", "-", "z0"}]], "]"}]}], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], 
                  RowBox[{"Log", "[", 
                   RowBox[{"1", "-", "\[Sigma]"}], "]"}]}], "-", "1"}], 
                ")"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"Requires", " ", "numerical", " ", "solution", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "here", " ", "we", " ", "solve", " ", "the", " ", "first", " ", 
            "and", " ", "second", " ", "moments"}], ",", " ", 
           RowBox[{"because", " ", "we", " ", "can"}]}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "=", 
         SuperscriptBox["10.", 
          RowBox[{"-", "12"}]]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Move", " ", "away", " ", "from", " ", "the", " ", "singular", " ", 
           
           RowBox[{"boundaries", ".", " ", "Not"}], " ", "perfect"}], ",", 
          " ", 
          RowBox[{"but", " ", "good", " ", "enough"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", 
                 RowBox[{
                  RowBox[{"\[Theta]1", "'"}], "[", "z", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Theta]1", "''"}], "[", "z", "]"}]}], "\[Equal]", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Section]\[ScriptCapitalN]", 
                  RowBox[{"\[ScriptCapitalB]", " ", "z", 
                   RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
                FractionBox[
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                    "\[Xi]"}], "]"}]}]]}]}], ",", 
              RowBox[{
               RowBox[{"\[Theta]1", "[", "\[CapitalDelta]", "]"}], "\[Equal]",
                "0"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]1", "[", 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}], "]"}], 
               "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", 
                 RowBox[{
                  RowBox[{"\[Theta]2", "'"}], "[", "z", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Theta]2", "''"}], "[", "z", "]"}]}], "\[Equal]", 
               RowBox[{
                RowBox[{"-", "2"}], 
                FractionBox["\[Section]\[ScriptCapitalN]", 
                 RowBox[{"\[ScriptCapitalB]", " ", "z", 
                  RowBox[{"(", 
                   RowBox[{"\[Xi]", "-", "z"}], ")"}]}]], 
                RowBox[{"\[Theta]1", "[", "z", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"\[Theta]2", "[", "\[CapitalDelta]", "]"}], "\[Equal]",
                "0"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]2", "[", 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}], "]"}], 
               "\[Equal]", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Theta]1", "[", "z", "]"}], ",", 
              RowBox[{"\[Theta]2", "[", "z", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "\[CapitalDelta]", ",", 
              RowBox[{"\[Sigma]", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}]}], "}"}], 
            ",", 
            RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}], "//", 
          "First"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"sec", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Theta]2", "[", "z", "]"}], "/.", "sol"}], ")"}], "/", 
            FractionBox[
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                "\[Xi]"}], "]"}]}]]}], ")"}], "/.", 
          RowBox[{"z", "\[Rule]", "z0"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{
       FractionBox["sec", 
        SuperscriptBox["365.25", "2"]], "-", 
       SuperscriptBox[
        RowBox[{"conditionalTime", "[", 
         RowBox[{"z0", ",", "\[Sigma]", ",", "params"}], "]"}], "2"]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "var", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.711446478802761*^9, 3.7114465828170633`*^9}, {
   3.711446738841564*^9, 3.711446754720251*^9}, {3.711446813086996*^9, 
   3.71144690628032*^9}, {3.711446950281795*^9, 3.711446957173641*^9}, {
   3.711446993336164*^9, 3.711447046956019*^9}, 3.7114472068375797`*^9, {
   3.711451969649268*^9, 3.711452022357366*^9}, {3.711452256222262*^9, 
   3.711452300180933*^9}, {3.711453174625086*^9, 3.711453183174818*^9}, {
   3.711691724516521*^9, 3.7116917550179987`*^9}, {3.7116917981043873`*^9, 
   3.711691841087152*^9}, {3.711791758524539*^9, 3.711791795956662*^9}, {
   3.711791832882471*^9, 3.71179184631597*^9}, {3.711791893385562*^9, 
   3.71179194199135*^9}, {3.711791980213264*^9, 3.711791982429175*^9}, {
   3.71179206230791*^9, 3.711792076293066*^9}, {3.711797868947214*^9, 
   3.711797871207541*^9}, {3.711797992683066*^9, 3.7117980978311787`*^9}, {
   3.711798133473428*^9, 3.711798136936211*^9}, 3.711798555304923*^9, {
   3.711798599536109*^9, 3.7117986057742977`*^9}, {3.711798649531909*^9, 
   3.71179870357178*^9}, {3.711798840278583*^9, 3.7117988601097317`*^9}, {
   3.7117997785339823`*^9, 3.711799820412499*^9}, {3.711799857445311*^9, 
   3.711799863227083*^9}, 3.711801078316558*^9, {3.711801184759046*^9, 
   3.7118011875418673`*^9}, {3.711801543986307*^9, 3.7118015820914717`*^9}, 
   3.711802735430949*^9, 3.711802995694175*^9, {3.7118031064862633`*^9, 
   3.711803110825198*^9}, {3.711803145124913*^9, 3.711803145300867*^9}, {
   3.7118033282869062`*^9, 3.711803353764391*^9}, {3.7118033937330112`*^9, 
   3.711803394187455*^9}, {3.711803519943961*^9, 3.7118035203192873`*^9}, {
   3.71180355765485*^9, 3.711803558062118*^9}, {3.7118064756926928`*^9, 
   3.7118065668481092`*^9}, {3.711806621895279*^9, 3.711806752579093*^9}, {
   3.711806804063676*^9, 3.711806804246913*^9}, {3.711806953941045*^9, 
   3.7118069827051773`*^9}, {3.711807325335123*^9, 3.71180735507304*^9}, {
   3.711863849056623*^9, 3.71186384956861*^9}, {3.711864018088746*^9, 
   3.711864034290105*^9}, {3.711865004863596*^9, 3.711865005817881*^9}, {
   3.7118652527947893`*^9, 3.711865252882113*^9}, 3.711865445012985*^9, {
   3.71186580456024*^9, 3.7118658051587563`*^9}, {3.711865921834813*^9, 
   3.711865923354885*^9}, {3.7118659856665983`*^9, 3.711866002594029*^9}, {
   3.7118906077837353`*^9, 3.7118907092501287`*^9}, {3.7118907685173903`*^9, 
   3.7118908465632257`*^9}, 3.711945341668536*^9}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot", "Section",
 CellChangeTimes->{{3.6955888715976963`*^9, 3.6955888852985*^9}}],

Cell[CellGroupData[{

Cell["Left panel: time to 4% clonality while varying N", "Subsection",
 CellChangeTimes->{{3.6955889835676126`*^9, 3.695589018132989*^9}, {
  3.697178782677712*^9, 3.697178794356946*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\n", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Section]\[Section]\[ScriptL]", "=", 
   FractionBox["60.", "1440."]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Section]\[Section]\[Beta]", "=", 
    FractionBox["1.", 
     RowBox[{"40.", "\[Times]", "7."}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Section]\[Section]\[Sigma]", "=", "0.04"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalN]Vals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["10.", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "9", ",", "0.05"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"n\[ScriptCapitalN]", "=", 
    RowBox[{"Length", "[", "\[ScriptCapitalN]Vals", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Vals", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.1", ",", "0.5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n\[Epsilon]", "=", 
   RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"paramFunc", "[", 
        RowBox[{
         RowBox[{"\[ScriptCapitalN]Vals", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         "\[Section]\[Section]\[ScriptL]", ",", "\[Section]\[Section]\[Beta]",
          ",", 
         RowBox[{"\[Epsilon]Vals", "[", 
          RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";", 
  RowBox[{"(*", 
   RowBox[{"paramFunc", "[", 
    RowBox[{
    "\[ScriptCapitalN]", ",", "\[ScriptL]", ",", "\[Beta]", ",", 
     "\[Epsilon]"}], "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6955892735947247`*^9, 3.695589280245528*^9}, {
   3.695589544699678*^9, 3.695589725330764*^9}, {3.695590058083886*^9, 
   3.6955900636680517`*^9}, 3.696155918840119*^9, {3.6961559670672503`*^9, 
   3.696155967179043*^9}, {3.696156068320134*^9, 3.696156085134693*^9}, {
   3.696156427947268*^9, 3.696156428138509*^9}, {3.6961564669373693`*^9, 
   3.696156544206696*^9}, {3.696161469792405*^9, 3.6961615549501762`*^9}, {
   3.712136317104512*^9, 3.7121363178079433`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Theory", " ", "predictions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"z0Tab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getZ0", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "j"}], "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"timePrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptCapitalN]", "/.", 
            RowBox[{"params", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"conditionalTime", "[", 
            RowBox[{
             RowBox[{"z0Tab", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             "\[Section]\[Section]\[Sigma]", ",", 
             RowBox[{"params", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Calculate", " ", "variance", " ", "and", " ", "export", " ", "for", " ", 
     "speed"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Comment", " ", "out", " ", "to", " ", "avoid", " ", "costly", " ", 
     "recalculations"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"analyticVariance", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[ScriptCapitalN]", "/.", 
             RowBox[{"params", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
            RowBox[{"conditionalTime", "[", 
             RowBox[{
              RowBox[{"z0Tab", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              "\[Section]\[Section]\[Sigma]", ",", 
              RowBox[{"params", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
            RowBox[{"variance", "[", 
             RowBox[{
              RowBox[{"z0Tab", "[", 
               RowBox[{"[", "j", "]"}], "]"}], ",", 
              "\[Section]\[Section]\[Sigma]", ",", 
              RowBox[{"params", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}],
         ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";", 
     "\n", 
     RowBox[{"SetDirectory", "@", 
      RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Export", "[", 
         RowBox[{
          RowBox[{"\"\<zz-data/clonal-human/variance\>\"", "<>", 
           RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], ",", 
          RowBox[{"analyticVariance", "[", 
           RowBox[{"[", "#", "]"}], "]"}]}], " ", "]"}], "&"}], ",", 
       RowBox[{"Range", "[", "n\[Epsilon]", "]"}]}], " ", "]"}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"analyticVariance", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{"\"\<zz-data/clonal-human/variance\>\"", "<>", 
          RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], "]"}], 
        "&"}], ",", 
       RowBox[{"Range", "[", "n\[Epsilon]", "]"}]}], " ", "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6904632692331457`*^9, 3.690463273800323*^9}, {
   3.6904633052638407`*^9, 3.690463309278974*^9}, 3.695589755301725*^9, {
   3.695590066970168*^9, 3.695590072711014*^9}, {3.695590208923634*^9, 
   3.695590256182686*^9}, {3.6961559261253033`*^9, 3.696155995226655*^9}, {
   3.6961560312196217`*^9, 3.696156124253413*^9}, {3.6961561830193443`*^9, 
   3.6961562063064337`*^9}, {3.696156439195855*^9, 3.696156444602887*^9}, {
   3.6961565852052794`*^9, 3.69615659194901*^9}, {3.696161548904463*^9, 
   3.696161550606512*^9}, {3.6961624773864613`*^9, 3.696162484906294*^9}, 
   3.711948487062718*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"linePlot", "=", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"timePrediction", "[", 
          RowBox[{"[", "j", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", 
           RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", "\[IndentingNewLine]", 
       
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"LineLegend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"NumberForm", "[", 
               RowBox[{
                RowBox[{"1", "+", 
                 RowBox[{"\[Epsilon]Vals", "[", 
                  RowBox[{"[", "i", "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "1"}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], "}"}]}], 
             "]"}], ",", 
            RowBox[{
            "LegendLabel", "\[Rule]", 
             "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]\>\""}], 
            ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"ticksSize", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
               RowBox[{"GrayLevel", "[", "0.4", "]"}]}], " ", "]"}]}], ",", 
            RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", "20"}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
            RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.9", ",", "0.73"}], "}"}], "]"}]}], " ", "]"}]}]}], " ",
       "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLogLinearPlot", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"analyticVariance", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"analyticVariance", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "-", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"analyticVariance", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], " ", 
                 "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"analyticVariance", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], "}"}]}], "]"}],
            ",", "\[IndentingNewLine]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"analyticVariance", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{
                RowBox[{"analyticVariance", "[", 
                 RowBox[{"[", 
                  RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "+", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{"analyticVariance", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], " ", 
                 "]"}]}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", 
               RowBox[{"Length", "[", 
                RowBox[{"analyticVariance", "[", 
                 RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
            "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "None"}], ",", 
         RowBox[{"Filling", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"1", "\[Rule]", 
            RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
         RowBox[{"FillingStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"myCol", "[", 
             RowBox[{"[", "i", "]"}], "]"}], ",", 
            RowBox[{"Opacity", "[", "0.2", "]"}]}], " ", "]"}]}]}], " ", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox["2", 
           RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
          FractionBox["9", 
           RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "90"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"Scaled", "[", "0.02", "]"}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<Mean time (years)\>\"", ",", "labelSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", "None"}],
          "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<System size,  \!\(\*
StyleBox[\"N\",
FontSlant->\"Italic\"]\)\>\"", ",", "labelSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", "None"}],
          "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "2"], ",", 
              SuperscriptBox["10", "9"]}], "}"}], ",", "False", ",", "True", 
            ",", "True", ",", "False"}], "]"}], ",", 
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "2"], ",", 
              SuperscriptBox["10", "9"]}], "}"}], ",", "False", ",", "False", 
            ",", "True", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"ticksSize", ",", 
        RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"AspectRatio", "\[Rule]", 
        RowBox[{
         FractionBox["1", "GoldenRatio"], "\[Times]", 
         FractionBox["400", "600"]}]}], ","}], "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", 
    "\[IndentingNewLine]", "]"}], "/.", "myPlotStyle"}]}]}], "Input",
 CellChangeTimes->{{3.685860653039406*^9, 3.685860654380707*^9}, {
   3.685860694378886*^9, 3.6858607118092813`*^9}, {3.6858613279076977`*^9, 
   3.685861332587285*^9}, {3.685862249584676*^9, 3.6858625121436167`*^9}, {
   3.685862579349402*^9, 3.685862598468575*^9}, {3.685862702545871*^9, 
   3.6858627127125072`*^9}, {3.685863688820616*^9, 3.6858636924178123`*^9}, {
   3.686293076024486*^9, 3.686293078807382*^9}, {3.6863754904924183`*^9, 
   3.6863757423307056`*^9}, {3.686376039592869*^9, 3.686376257840508*^9}, {
   3.686377285709462*^9, 3.686377525460105*^9}, {3.686377563970949*^9, 
   3.686377574154319*^9}, {3.686377642527919*^9, 3.686377646359543*^9}, {
   3.6863778882152967`*^9, 3.6863778923988256`*^9}, {3.6863780270741673`*^9, 
   3.686378193484436*^9}, {3.6863782290437403`*^9, 3.686378294121036*^9}, {
   3.6863785961832867`*^9, 3.686378646460758*^9}, {3.6863791831066427`*^9, 
   3.686379192553739*^9}, {3.686380228805229*^9, 3.6863802397250233`*^9}, {
   3.6864024243395777`*^9, 3.686402428810791*^9}, 3.686402580014575*^9, {
   3.686646642032658*^9, 3.686646662503133*^9}, {3.686648323134224*^9, 
   3.6866483422448883`*^9}, {3.686649145801855*^9, 3.686649206646247*^9}, {
   3.686649267309105*^9, 3.686649273859928*^9}, {3.686649467797632*^9, 
   3.686649541170877*^9}, {3.686649589625564*^9, 3.68664959592067*^9}, {
   3.686649629913076*^9, 3.68664977321183*^9}, {3.6866499462140512`*^9, 
   3.68665002537844*^9}, {3.686650066680772*^9, 3.686650375573316*^9}, {
   3.686650494178249*^9, 3.686650683875194*^9}, {3.686650725530733*^9, 
   3.686650736313149*^9}, {3.686650779840146*^9, 3.686650794878701*^9}, {
   3.686650830757923*^9, 3.686650833103372*^9}, 3.690463337319343*^9, {
   3.690463519425106*^9, 3.690463542655642*^9}, {3.692358643106851*^9, 
   3.692358645753737*^9}, {3.692360346741235*^9, 3.6923603523569202`*^9}, {
   3.695382935983808*^9, 3.695382959513227*^9}, {3.695590303368299*^9, 
   3.695590314964652*^9}, {3.6955903560036*^9, 3.695590385327395*^9}, {
   3.695590475734643*^9, 3.695590478801902*^9}, {3.695590548136286*^9, 
   3.695590567086792*^9}, {3.6955906256161413`*^9, 3.695590706374649*^9}, {
   3.695591063427348*^9, 3.695591083608902*^9}, 3.695649542742794*^9, {
   3.696156300697195*^9, 3.696156328310823*^9}, {3.696156624101235*^9, 
   3.6961566241856117`*^9}, {3.696156655596562*^9, 3.696156765384254*^9}, {
   3.696156795807089*^9, 3.696156830021326*^9}, {3.696156870077898*^9, 
   3.696156880459425*^9}, {3.6961569141241627`*^9, 3.696156958056724*^9}, {
   3.696161760164963*^9, 3.6961617603552628`*^9}, {3.6971792061363173`*^9, 
   3.69717923527952*^9}, {3.7119451664030647`*^9, 3.7119451687637672`*^9}, {
   3.7119452430806627`*^9, 3.7119452432960253`*^9}, 3.711948456339809*^9, {
   3.712136341497209*^9, 3.712136392350177*^9}, {3.7121364236707087`*^9, 
   3.7121364290206413`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalN]Fix", "=", 
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["10", "4"], ",", 
     SuperscriptBox["10", "4"], ",", 
     SuperscriptBox["10", "4"], ",", 
     SuperscriptBox["10", "7"], ",", 
     SuperscriptBox["10", "7"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Fix", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1.0", ",", "1.1", ",", "1.5", ",", "1.1", ",", "1.5"}], "}"}], 
    "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramFix", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"paramFunc", "[", 
      RowBox[{
       RowBox[{"\[ScriptCapitalN]Fix", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", "\[Section]\[Section]\[ScriptL]",
        ",", "\[Section]\[Section]\[Beta]", ",", " ", 
       RowBox[{"\[Epsilon]Fix", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[ScriptCapitalN]Fix", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tRoot", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"conditionalTime", "[", 
      RowBox[{
       RowBox[{"getZ0", "[", 
        RowBox[{"paramFix", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       "\[Section]\[Section]\[Sigma]", ",", 
       RowBox[{"paramFix", "[", 
        RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", 
       RowBox[{"Length", "[", "\[ScriptCapitalN]Fix", "]"}]}], "}"}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"examplePlot", "=", 
   RowBox[{"ListLogLinearPlot", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptCapitalN]", ",", "t"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[ScriptCapitalN]", ",", 
            RowBox[{"-", "10"}]}], "}"}]}], "}"}], "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"t", "\[Rule]", 
           RowBox[{"tRoot", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"\[ScriptCapitalN]", "\[Rule]", 
           RowBox[{"\[ScriptCapitalN]Fix", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}]}], "}"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "\[ScriptCapitalN]Fix", "]"}]}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"Joined", "\[Rule]", "True"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"Black", ",", "Dotted", ",", 
        RowBox[{"Thickness", "[", "0.003", "]"}]}], " ", "]"}]}]}], " ", 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.685860653039406*^9, 3.685860654380707*^9}, {
   3.685860694378886*^9, 3.6858607118092813`*^9}, {3.6858613279076977`*^9, 
   3.685861332587285*^9}, {3.685862249584676*^9, 3.6858625121436167`*^9}, {
   3.685862579349402*^9, 3.685862598468575*^9}, {3.685862702545871*^9, 
   3.6858627127125072`*^9}, {3.685863688820616*^9, 3.6858636924178123`*^9}, {
   3.686293076024486*^9, 3.686293078807382*^9}, {3.6863754904924183`*^9, 
   3.6863757423307056`*^9}, {3.686376039592869*^9, 3.686376257840508*^9}, {
   3.686377285709462*^9, 3.686377525460105*^9}, {3.686377563970949*^9, 
   3.686377574154319*^9}, {3.686377642527919*^9, 3.686377646359543*^9}, {
   3.6863778882152967`*^9, 3.6863778923988256`*^9}, {3.6863780270741673`*^9, 
   3.686378193484436*^9}, {3.6863782290437403`*^9, 3.686378294121036*^9}, {
   3.6863785961832867`*^9, 3.686378646460758*^9}, {3.6863791831066427`*^9, 
   3.686379192553739*^9}, {3.686380228805229*^9, 3.6863802397250233`*^9}, {
   3.6864024243395777`*^9, 3.686402428810791*^9}, 3.686402580014575*^9, {
   3.686646642032658*^9, 3.686646662503133*^9}, {3.686648323134224*^9, 
   3.6866483422448883`*^9}, {3.686649145801855*^9, 3.686649206646247*^9}, {
   3.686649267309105*^9, 3.686649273859928*^9}, {3.686649467797632*^9, 
   3.686649541170877*^9}, {3.686649589625564*^9, 3.68664959592067*^9}, {
   3.686649629913076*^9, 3.68664977321183*^9}, {3.6866499462140512`*^9, 
   3.68665002537844*^9}, {3.686650066680772*^9, 3.686650375573316*^9}, {
   3.686650494178249*^9, 3.686650683875194*^9}, {3.686650725530733*^9, 
   3.686650736313149*^9}, {3.686650779840146*^9, 3.686650794878701*^9}, {
   3.686650830757923*^9, 3.686650833103372*^9}, 3.690463337319343*^9, {
   3.690463519425106*^9, 3.690463542655642*^9}, {3.692358643106851*^9, 
   3.692358645753737*^9}, {3.692360346741235*^9, 3.6923603523569202`*^9}, {
   3.695382935983808*^9, 3.695382959513227*^9}, {3.695590303368299*^9, 
   3.695590314964652*^9}, {3.6955903560036*^9, 3.695590385327395*^9}, {
   3.695590475734643*^9, 3.695590478801902*^9}, {3.695590548136286*^9, 
   3.695590567086792*^9}, {3.6955906256161413`*^9, 3.695590706374649*^9}, {
   3.695591063427348*^9, 3.695591083608902*^9}, 3.695649542742794*^9, {
   3.696156300697195*^9, 3.696156328310823*^9}, {3.696156624101235*^9, 
   3.6961566241856117`*^9}, {3.696156655596562*^9, 3.696156765384254*^9}, {
   3.696156795807089*^9, 3.696156830021326*^9}, {3.696156870077898*^9, 
   3.696156880459425*^9}, {3.6961569141241627`*^9, 3.6961569301568003`*^9}, {
   3.696156964744255*^9, 3.6961569959188137`*^9}, {3.6961570317666683`*^9, 
   3.696157088339641*^9}, {3.696157125250162*^9, 3.696157304068532*^9}, {
   3.696161570510277*^9, 3.6961616005277243`*^9}, {3.696161653960443*^9, 
   3.69616173400949*^9}}],

Cell[BoxData[
 RowBox[{"leftPlot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"linePlot", ",", "examplePlot", ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(a)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
        "myPlotStyle"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}]}], " ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696156939849504*^9, 3.6961569495202208`*^9}, {
  3.696157292244528*^9, 3.6961572937083197`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Right panel: time to clonality levels for to values of N", "Subsection",
 CellChangeTimes->{{3.6955889835676126`*^9, 3.695589030108212*^9}, {
  3.697178814525124*^9, 3.697178824867886*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "parameters"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Section]\[Section]\[ScriptL]", "=", 
     FractionBox["60.", "1440."]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Section]\[Section]\[Beta]", "=", 
     FractionBox["1.", 
      RowBox[{"40.", "\[Times]", "7."}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalN]Vals", "=", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["10", "4"], ",", 
       SuperscriptBox["10", "7"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[ScriptCapitalN]", "=", 
     RowBox[{"Length", "[", "\[ScriptCapitalN]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]Vals", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.1", ",", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Epsilon]", "=", 
     RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"paramFunc", "[", 
          RowBox[{
           RowBox[{"\[ScriptCapitalN]Vals", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           "\[Section]\[Section]\[ScriptL]", ",", 
           "\[Section]\[Section]\[Beta]", ",", 
           RowBox[{"\[Epsilon]Vals", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Sigma]Vals", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "i"], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"-", "3"}], ",", "0", ",", "0.01"}], "}"}]}], "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"z0Tab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getZ0", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "j"}], "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"timePrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", 
             RowBox[{"conditionalTime", "[", 
              RowBox[{
               RowBox[{"z0Tab", "[", 
                RowBox[{"[", "j", "]"}], "]"}], ",", "\[Sigma]", ",", 
               RowBox[{"params", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "\[Sigma]Vals"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6904626390212917`*^9, 3.690462798673328*^9}, {
   3.690463311431048*^9, 3.690463325948842*^9}, {3.690463552623497*^9, 
   3.690463569214551*^9}, {3.690463608589966*^9, 3.690463608724942*^9}, {
   3.692358680784771*^9, 3.6923586841199017`*^9}, {3.692360041574909*^9, 
   3.692360147674964*^9}, {3.692360245200191*^9, 3.6923602453754053`*^9}, {
   3.692426339244911*^9, 3.6924263392782173`*^9}, 3.692426454987349*^9, {
   3.695590746638335*^9, 3.695590790529025*^9}, {3.696161894078248*^9, 
   3.696161932497436*^9}, {3.6961619647094707`*^9, 3.6961619973153687`*^9}, {
   3.6961620476498117`*^9, 3.696162048407043*^9}, {3.696162389784279*^9, 
   3.696162541500926*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"linePlot", "=", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{
       RowBox[{"timePrediction", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "3"}]], ",", 
            SuperscriptBox["10", "0"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "90"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"myCol", "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "s"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"Line", ",", "Dashed"}], "}"}]}], "}"}]}], "]"}]}], ",", 
       
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"LineLegend", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{"Black", ",", "s"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"s", ",", 
                RowBox[{"{", 
                 RowBox[{"Line", ",", "Dashed"}], "}"}]}], "}"}]}], "]"}], 
            ",", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Superscript", "[", 
               RowBox[{"\"\<10\>\"", ",", 
                RowBox[{"Log10", "[", "\[ScriptCapitalN]", "]"}]}], " ", 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[ScriptCapitalN]", ",", "\[ScriptCapitalN]Vals"}], 
               "}"}]}], "]"}], ",", 
            RowBox[{"LegendMarkerSize", "\[Rule]", "20"}], ",", 
            RowBox[{"LegendLabel", "\[Rule]", "\"\<\!\(\*
StyleBox[\"N\",
FontSlant->\"Italic\"]\)\>\""}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{"ticksSize", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
               RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
            RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
            RowBox[{"Background", "\[Rule]", "White"}]}], 
           RowBox[{"(*", 
            RowBox[{",", 
             RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "*)"}], 
           "]"}], ",", 
          RowBox[{"Scaled", "[", 
           RowBox[{"{", 
            RowBox[{"0.7", ",", "0.77"}], "}"}], "]"}]}], "]"}]}]}], "]"}], 
     ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{
       RowBox[{"timePrediction", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "3"}]], ",", 
            SuperscriptBox["10", "0"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "90"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"myCol", "[", 
             RowBox[{"[", "2", "]"}], "]"}], ",", "s"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"Line", ",", "Dashed"}], "}"}]}], "}"}]}], "]"}]}]}], 
      " ", "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{
       RowBox[{"timePrediction", "[", 
        RowBox[{"[", "3", "]"}], "]"}], ",", 
       RowBox[{"Joined", "\[Rule]", "True"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox["10", 
             RowBox[{"-", "3"}]], ",", 
            SuperscriptBox["10", "0"]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "90"}], "}"}]}], "}"}]}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"myCol", "[", 
             RowBox[{"[", "3", "]"}], "]"}], ",", "s"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{"{", 
             RowBox[{"Line", ",", "Dashed"}], "}"}]}], "}"}]}], "]"}]}]}], 
      " ", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.1", ",", "0.3"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"ticksSize", ",", 
        RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Level of clonality\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Mean time (years)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.1", ",", "100"}], "}"}], ",", "False", ",", "True", 
            ",", "False", ",", "True"}], "]"}], ",", 
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0.1", ",", "100"}], "}"}], ",", "False", ",", "False", 
            ",", "False", ",", "True"}], "]"}]}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", "]"}], 
   "/.", "myPlotStyle"}]}]}], "Input",
 CellChangeTimes->{{3.6904626390212917`*^9, 3.690462798673328*^9}, {
   3.690463311431048*^9, 3.690463325948842*^9}, {3.690463552623497*^9, 
   3.690463569214551*^9}, {3.690463608589966*^9, 3.690463608724942*^9}, {
   3.692358680784771*^9, 3.6923586841199017`*^9}, {3.692360041574909*^9, 
   3.692360147674964*^9}, {3.692360245200191*^9, 3.6923602453754053`*^9}, {
   3.692426339244911*^9, 3.6924263392782173`*^9}, {3.692426454987349*^9, 
   3.6924265142462893`*^9}, {3.695590993365769*^9, 3.695591022292749*^9}, {
   3.6955912315657*^9, 3.695591304404726*^9}, {3.695591365861002*^9, 
   3.695591387732689*^9}, {3.696161956648435*^9, 3.6961619685282907`*^9}, {
   3.696162012941122*^9, 3.6961620140111103`*^9}, {3.6961620679842167`*^9, 
   3.6961621401348057`*^9}, {3.6961622460540733`*^9, 
   3.6961622478994303`*^9}, {3.6961622910046253`*^9, 
   3.6961623393484983`*^9}, {3.696162549701907*^9, 3.6961625911407843`*^9}, {
   3.697178913210877*^9, 3.697179008878406*^9}, {3.697179043526246*^9, 
   3.697179062781006*^9}, {3.6971791069638767`*^9, 3.6971791874092712`*^9}, 
   3.697179244222124*^9, {3.7121365030989923`*^9, 3.712136551922039*^9}}],

Cell[BoxData[
 RowBox[{"rightPlot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"linePlot", ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(b)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
        "myPlotStyle"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}]}], " ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.696156939849504*^9, 3.6961569495202208`*^9}, {
  3.696157292244528*^9, 3.6961572937083197`*^9}, {3.696162302786743*^9, 
  3.696162313736137*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Combine left and right panels", "Subsection",
 CellChangeTimes->{{3.695589058230056*^9, 3.695589061948196*^9}, {
   3.6961622699693537`*^9, 3.696162271944592*^9}, 3.697179289661044*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Row", "[", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{"leftPlot", ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "pad"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Show", "[", 
      RowBox[{"rightPlot", ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "400"}], ",", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "pad"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}], "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{"pad", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"47", ",", "16"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", "5"}], "}"}]}], "}"}]}], "}"}]}]], "Input"]
}, Closed]],

Cell[CellGroupData[{

Cell["CDF plots", "Subsection",
 CellChangeTimes->{{3.6955889835676126`*^9, 3.695589018132989*^9}, {
  3.697178782677712*^9, 3.697178794356946*^9}, {3.71213621491042*^9, 
  3.712136216114592*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Define", " ", "parameters"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Section]\[Section]\[ScriptL]", "=", 
     FractionBox["60.", "1440."]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Section]\[Section]\[Beta]", "=", 
     FractionBox["1.", 
      RowBox[{"40.", "\[Times]", "7."}]]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Section]\[Section]\[Sigma]", "=", "0.04"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptCapitalN]Vals", "=", 
     RowBox[{"{", 
      RowBox[{
       SuperscriptBox["10", "3"], ",", 
       SuperscriptBox["10", "6"], ",", 
       SuperscriptBox["10", "9"]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[ScriptCapitalN]", "=", 
     RowBox[{"Length", "[", "\[ScriptCapitalN]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Epsilon]Vals", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.1", ",", "0.5"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Epsilon]", "=", 
     RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"paramFunc", "[", 
          RowBox[{
           RowBox[{"\[ScriptCapitalN]Vals", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           "\[Section]\[Section]\[ScriptL]", ",", 
           "\[Section]\[Section]\[Beta]", ",", 
           RowBox[{"\[Epsilon]Vals", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   
   RowBox[{"(*", 
    RowBox[{"paramFunc", "[", 
     RowBox[{
     "\[ScriptCapitalN]", ",", "\[ScriptL]", ",", "\[Beta]", ",", 
      "\[Epsilon]"}], "]"}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.6955892735947247`*^9, 3.695589280245528*^9}, {
   3.695589544699678*^9, 3.695589725330764*^9}, {3.695590058083886*^9, 
   3.6955900636680517`*^9}, 3.696155918840119*^9, {3.6961559670672503`*^9, 
   3.696155967179043*^9}, {3.696156068320134*^9, 3.696156085134693*^9}, {
   3.696156427947268*^9, 3.696156428138509*^9}, {3.6961564669373693`*^9, 
   3.696156544206696*^9}, {3.696161469792405*^9, 3.6961615549501762`*^9}, {
   3.711970480255061*^9, 3.7119704804736967`*^9}, {3.711970579691536*^9, 
   3.711970590810173*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Theory", " ", "predictions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"z0Tab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getZ0", "[", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "j"}], "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"prediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"conditionalTime", "[", 
            RowBox[{
             RowBox[{"z0Tab", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             "\[Section]\[Section]\[Sigma]", ",", 
             RowBox[{"params", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
           RowBox[{"variance", "[", 
            RowBox[{
             RowBox[{"z0Tab", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             "\[Section]\[Section]\[Sigma]", ",", 
             RowBox[{"params", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6904632692331457`*^9, 3.690463273800323*^9}, {
   3.6904633052638407`*^9, 3.690463309278974*^9}, 3.695589755301725*^9, {
   3.695590066970168*^9, 3.695590072711014*^9}, {3.695590208923634*^9, 
   3.695590256182686*^9}, {3.6961559261253033`*^9, 3.696155995226655*^9}, {
   3.6961560312196217`*^9, 3.696156124253413*^9}, {3.6961561830193443`*^9, 
   3.6961562063064337`*^9}, {3.696156439195855*^9, 3.696156444602887*^9}, {
   3.6961565852052794`*^9, 3.69615659194901*^9}, {3.696161548904463*^9, 
   3.696161550606512*^9}, {3.6961624773864613`*^9, 3.696162484906294*^9}, 
   3.711948487062718*^9, {3.7119706177696447`*^9, 3.71197063576184*^9}, 
   3.711970759397455*^9}],

Cell[CellGroupData[{

Cell["Row plot", "Subsubsection",
 CellChangeTimes->{{3.712300972849752*^9, 3.712300976104775*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Predicted", " ", "incidence", " ", "curve", " ", "based", " ", "on", " ", 
    "normally", " ", "distributed", " ", "data", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mean", "=", "\[Mu]"}], ",", " ", 
      RowBox[{"variance", "=", "v"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"t_", ",", "\[Mu]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"0.5", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"t", "-", "\[Mu]"}], 
         RowBox[{
          RowBox[{"Sqrt", "[", "v", "]"}], 
          SqrtBox["2"]}]], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myCol", "=", 
     RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tMin", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tMax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotRange", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tMin", ",", "tMax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotRangePadding", "=", 
     RowBox[{"{", 
      RowBox[{"0.22", ",", "0.04"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Row", "[", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"t", ",", 
              RowBox[{"prediction", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"prediction", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}]}], " ", "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
           "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"s", ",", 
              RowBox[{"myCol", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"{", 
               RowBox[{"Line", ",", "Dashed", ",", "Dotted"}], "}"}]}], 
             "}"}]}], "]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRangePadding", "\[Rule]", "plotRangePadding"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]=\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"1", "+", "\[Epsilon]"}], "/.", 
                   RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], 
                ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}],
            "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"logTicks", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "True", 
                ",", "False", ",", "False"}], "]"}], ",", 
              RowBox[{"logTicks", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False", 
                ",", "False", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"55", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "32"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"t", ",", 
              RowBox[{"prediction", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"prediction", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "j", ",", "2"}], "]"}], "]"}]}], " ", "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
           "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"s", ",", 
              RowBox[{"myCol", "[", 
               RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"{", 
               RowBox[{"Line", ",", "Dashed", ",", "Dotted"}], "}"}]}], 
             "}"}]}], "]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRangePadding", "\[Rule]", "plotRangePadding"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", 
              RowBox[{"(*", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "*)"}], 
              ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]=\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"1", "+", "\[Epsilon]"}], "/.", 
                   RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], 
                ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}],
            "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"logTicks", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "True", 
                ",", "False", ",", "False"}], "]"}], ",", 
              RowBox[{"logTicks", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False", 
                ",", "False", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "32"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "247"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"LogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"f", "[", 
             RowBox[{"t", ",", 
              RowBox[{"prediction", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"prediction", "[", 
               RowBox[{"[", 
                RowBox[{"3", ",", "j", ",", "2"}], "]"}], "]"}]}], " ", "]"}],
             ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
           "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"s", ",", 
              RowBox[{"myCol", "[", 
               RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{"{", 
               RowBox[{"Line", ",", "Dashed", ",", "Dotted"}], "}"}]}], 
             "}"}]}], "]"}]}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRangePadding", "\[Rule]", "plotRangePadding"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", 
              RowBox[{"(*", 
               RowBox[{"Style", "[", 
                RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "*)"}], 
              ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              RowBox[{"Style", "[", 
               RowBox[{
                RowBox[{
                "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]=\>\"", "<>", 
                 RowBox[{"ToString", "[", 
                  RowBox[{
                   RowBox[{"1", "+", "\[Epsilon]"}], "/.", 
                   RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], 
                ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}],
            "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"logTicks", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "True", 
                ",", "False", ",", "False"}], "]"}], ",", 
              RowBox[{"logTicks", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False", 
                ",", "False", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "32"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "247"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{"\"\< \>\"", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "2"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"LineLegend", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Line"}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Dashed"}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", "Dotted"}], "]"}]}], "}"}], ",", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Superscript", "[", 
             RowBox[{"\"\<10\>\"", ",", 
              RowBox[{"Log10", "[", "#", "]"}]}], " ", "]"}], "&"}], ",", 
           "\[ScriptCapitalN]Vals"}], "]"}], ",", 
         RowBox[{"LegendLabel", "\[Rule]", "\"\<\!\(\*
StyleBox[\"N\",
FontSlant->\"Italic\"]\)\>\""}], ",", 
         RowBox[{"LabelStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
            RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
         RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
         RowBox[{"Background", "\[Rule]", "White"}]}], "]"}]}], 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}], "/.", 
    "myPlotStyle"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"plotRange", ",", "plotRangePadding"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.685860653039406*^9, 3.685860654380707*^9}, {
   3.685860694378886*^9, 3.6858607118092813`*^9}, {3.6858613279076977`*^9, 
   3.685861332587285*^9}, {3.685862249584676*^9, 3.6858625121436167`*^9}, {
   3.685862579349402*^9, 3.685862598468575*^9}, {3.685862702545871*^9, 
   3.6858627127125072`*^9}, {3.685863688820616*^9, 3.6858636924178123`*^9}, {
   3.686293076024486*^9, 3.686293078807382*^9}, {3.6863754904924183`*^9, 
   3.6863757423307056`*^9}, {3.686376039592869*^9, 3.686376257840508*^9}, {
   3.686377285709462*^9, 3.686377525460105*^9}, {3.686377563970949*^9, 
   3.686377574154319*^9}, {3.686377642527919*^9, 3.686377646359543*^9}, {
   3.6863778882152967`*^9, 3.6863778923988256`*^9}, {3.6863780270741673`*^9, 
   3.686378193484436*^9}, {3.6863782290437403`*^9, 3.686378294121036*^9}, {
   3.6863785961832867`*^9, 3.686378646460758*^9}, {3.6863791831066427`*^9, 
   3.686379192553739*^9}, {3.686380228805229*^9, 3.6863802397250233`*^9}, {
   3.6864024243395777`*^9, 3.686402428810791*^9}, 3.686402580014575*^9, {
   3.686646642032658*^9, 3.686646662503133*^9}, {3.686648323134224*^9, 
   3.6866483422448883`*^9}, {3.686649145801855*^9, 3.686649206646247*^9}, {
   3.686649267309105*^9, 3.686649273859928*^9}, {3.686649467797632*^9, 
   3.686649541170877*^9}, {3.686649589625564*^9, 3.68664959592067*^9}, {
   3.686649629913076*^9, 3.68664977321183*^9}, {3.6866499462140512`*^9, 
   3.68665002537844*^9}, {3.686650066680772*^9, 3.686650375573316*^9}, {
   3.686650494178249*^9, 3.686650683875194*^9}, {3.686650725530733*^9, 
   3.686650736313149*^9}, {3.686650779840146*^9, 3.686650794878701*^9}, {
   3.686650830757923*^9, 3.686650833103372*^9}, 3.690463337319343*^9, {
   3.690463519425106*^9, 3.690463542655642*^9}, {3.692358643106851*^9, 
   3.692358645753737*^9}, {3.692360346741235*^9, 3.6923603523569202`*^9}, {
   3.695382935983808*^9, 3.695382959513227*^9}, {3.695590303368299*^9, 
   3.695590314964652*^9}, {3.6955903560036*^9, 3.695590385327395*^9}, {
   3.695590475734643*^9, 3.695590478801902*^9}, {3.695590548136286*^9, 
   3.695590567086792*^9}, {3.6955906256161413`*^9, 3.695590706374649*^9}, {
   3.695591063427348*^9, 3.695591083608902*^9}, 3.695649542742794*^9, {
   3.696156300697195*^9, 3.696156328310823*^9}, {3.696156624101235*^9, 
   3.6961566241856117`*^9}, {3.696156655596562*^9, 3.696156765384254*^9}, {
   3.696156795807089*^9, 3.696156830021326*^9}, {3.696156870077898*^9, 
   3.696156880459425*^9}, {3.6961569141241627`*^9, 3.696156958056724*^9}, {
   3.696161760164963*^9, 3.6961617603552628`*^9}, {3.6971792061363173`*^9, 
   3.69717923527952*^9}, {3.7119451664030647`*^9, 3.7119451687637672`*^9}, {
   3.7119452430806627`*^9, 3.7119452432960253`*^9}, 3.711948456339809*^9, {
   3.711970690645649*^9, 3.711970711455888*^9}, {3.711970767037573*^9, 
   3.711970799195491*^9}, {3.711970846842822*^9, 3.711970916503469*^9}, {
   3.711970951503151*^9, 3.711970952966449*^9}, {3.7119709990618362`*^9, 
   3.7119711307926817`*^9}, {3.711971763259494*^9, 3.711971909037772*^9}, {
   3.7119719559089603`*^9, 3.7119721415235033`*^9}, {3.7119721817339363`*^9, 
   3.7119722855696783`*^9}, {3.71205014560471*^9, 3.7120504103390617`*^9}, {
   3.7120505799262333`*^9, 3.712050582317378*^9}, {3.7120506198130302`*^9, 
   3.7120506710598707`*^9}, {3.712050747000153*^9, 3.712050751201849*^9}, {
   3.712050793672027*^9, 3.712050794565625*^9}, {3.712050825306147*^9, 
   3.712050839766513*^9}, {3.712050871332884*^9, 3.712050945609661*^9}, {
   3.712057953889276*^9, 3.712057974270501*^9}, {3.712058020822281*^9, 
   3.712058035759116*^9}, {3.712058070645668*^9, 3.712058161664604*^9}, {
   3.712058204040413*^9, 3.7120583251977158`*^9}, {3.7120585369978867`*^9, 
   3.712058537252418*^9}, {3.712136628400284*^9, 3.7121367283004007`*^9}, {
   3.712136758980063*^9, 3.7121367689105177`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Column plot", "Subsubsection",
 CellChangeTimes->{{3.712300983305099*^9, 3.7123009847764177`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Predicted", " ", "incidence", " ", "curve", " ", "based", " ", "on", " ", 
    "normally", " ", "distributed", " ", "data", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"mean", "=", "\[Mu]"}], ",", " ", 
      RowBox[{"variance", "=", "v"}]}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", "[", 
     RowBox[{"t_", ",", "\[Mu]_", ",", "v_"}], "]"}], ":=", 
    RowBox[{"0.5", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"Erf", "[", 
        FractionBox[
         RowBox[{"t", "-", "\[Mu]"}], 
         RowBox[{
          RowBox[{"Sqrt", "[", "v", "]"}], 
          SqrtBox["2"]}]], "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"myCol", "=", 
     RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tMin", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tMax", "=", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotRange", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tMin", ",", "tMax"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotRangePadding", "=", 
     RowBox[{"{", 
      RowBox[{"0.22", ",", "0.04"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Column", "[", 
     RowBox[{
      RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Show", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{"Text", "[", 
               RowBox[{"\"\< \>\"", ",", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], ",", 
             RowBox[{"ImageSize", "\[Rule]", "35"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"LineLegend", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "Line"}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "Dashed"}], "]"}], ",", 
               RowBox[{"Directive", "[", 
                RowBox[{"Black", ",", "Dotted"}], "]"}]}], "}"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Superscript", "[", 
                 RowBox[{"\"\<10\>\"", ",", 
                  RowBox[{"Log10", "[", "#", "]"}]}], " ", "]"}], "&"}], ",", 
               "\[ScriptCapitalN]Vals"}], "]"}], ",", 
             RowBox[{"LegendLabel", "\[Rule]", "\"\<\!\(\*
StyleBox[\"N\",
FontSlant->\"Italic\"]\)\>\""}], ",", 
             RowBox[{"LabelStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{"ticksSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
             RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
             RowBox[{"Background", "\[Rule]", "White"}], ",", 
             RowBox[{"LegendLayout", "\[Rule]", "\"\<Row\>\""}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], "]"}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"t", ",", 
               RowBox[{"prediction", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"prediction", "[", 
                RowBox[{"[", 
                 RowBox[{"1", ",", "j", ",", "2"}], "]"}], "]"}]}], " ", 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"s", ",", 
               RowBox[{"myCol", "[", 
                RowBox[{"[", "1", "]"}], "]"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{"Line", ",", "Dashed", ",", "Dotted"}], "}"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangePadding", "\[Rule]", "plotRangePadding"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"ticksSize", ",", 
             RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"None", 
               RowBox[{"(*", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "*)"}], 
               ",", "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"logTicks", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False",
                  ",", "False", ",", "False"}], "]"}], ",", 
               RowBox[{"logTicks", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False",
                  ",", "False", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]=\>\"",
                    "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "\[Epsilon]"}], "/.", 
                    RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], 
                  ",", "labelSize", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "]"}], ",", 
               RowBox[{"ImageSize", "\[Rule]", "90"}]}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.16", ",", "0.85"}], "}"}], "]"}]}], " ", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"55", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "5"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"t", ",", 
               RowBox[{"prediction", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"prediction", "[", 
                RowBox[{"[", 
                 RowBox[{"2", ",", "j", ",", "2"}], "]"}], "]"}]}], " ", 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"s", ",", 
               RowBox[{"myCol", "[", 
                RowBox[{"[", "2", "]"}], "]"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{"Line", ",", "Dashed", ",", "Dotted"}], "}"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangePadding", "\[Rule]", "plotRangePadding"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"ticksSize", ",", 
             RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"None", 
               RowBox[{"(*", 
                RowBox[{"Style", "[", 
                 RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "*)"}], 
               ",", "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"logTicks", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False",
                  ",", "False", ",", "False"}], "]"}], ",", 
               RowBox[{"logTicks", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False",
                  ",", "False", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]=\>\"",
                    "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "\[Epsilon]"}], "/.", 
                    RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"2", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], 
                  ",", "labelSize", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], " ", "]"}],
                ",", 
               RowBox[{"ImageSize", "\[Rule]", "90"}]}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.2", ",", "0.85"}], "}"}], "]"}]}], " ", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"55", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "5"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"LogLinearPlot", "[", 
         RowBox[{
          RowBox[{"Evaluate", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"f", "[", 
              RowBox[{"t", ",", 
               RowBox[{"prediction", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
               RowBox[{"prediction", "[", 
                RowBox[{"[", 
                 RowBox[{"3", ",", "j", ",", "2"}], "]"}], "]"}]}], " ", 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
            "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "tMin", ",", "tMax"}], "}"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Directive", "[", 
              RowBox[{"s", ",", 
               RowBox[{"myCol", "[", 
                RowBox[{"[", "3", "]"}], "]"}]}], " ", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"s", ",", 
               RowBox[{"{", 
                RowBox[{"Line", ",", "Dashed", ",", "Dotted"}], "}"}]}], 
              "}"}]}], "]"}]}], ",", 
          RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", "plotRange"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"PlotRangePadding", "\[Rule]", "plotRangePadding"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameTicksStyle", "\[Rule]", 
           RowBox[{"Directive", "[", 
            RowBox[{"ticksSize", ",", 
             RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<CDF\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Time (years)\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"FrameTicks", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"logTicks", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "True", 
                 ",", "False", ",", "False"}], "]"}], ",", 
               RowBox[{"logTicks", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"1", ",", "100"}], "}"}], ",", "True", ",", "False",
                  ",", "False", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"Inset", "[", 
            RowBox[{
             RowBox[{"Graphics", "[", 
              RowBox[{
               RowBox[{"Text", "[", 
                RowBox[{"Style", "[", 
                 RowBox[{
                  RowBox[{
                  "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]=\>\"",
                    "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "\[Epsilon]"}], "/.", 
                    RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"3", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], 
                  ",", "labelSize", ",", 
                  RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                  RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], " ", "]"}],
                ",", 
               RowBox[{"ImageSize", "\[Rule]", "90"}]}], "]"}], ",", 
             RowBox[{"Scaled", "[", 
              RowBox[{"{", 
               RowBox[{"0.2", ",", "0.85"}], "}"}], "]"}]}], " ", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"ImagePadding", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"55", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"50", ",", "5"}], "}"}]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ImageSize", "\[Rule]", "300"}]}], "]"}]}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], ",", "Center"}], 
     "]"}], "/.", "myPlotStyle"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"plotRange", ",", "plotRangePadding"}], "]"}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.685860653039406*^9, 3.685860654380707*^9}, {
   3.685860694378886*^9, 3.6858607118092813`*^9}, {3.6858613279076977`*^9, 
   3.685861332587285*^9}, {3.685862249584676*^9, 3.6858625121436167`*^9}, {
   3.685862579349402*^9, 3.685862598468575*^9}, {3.685862702545871*^9, 
   3.6858627127125072`*^9}, {3.685863688820616*^9, 3.6858636924178123`*^9}, {
   3.686293076024486*^9, 3.686293078807382*^9}, {3.6863754904924183`*^9, 
   3.6863757423307056`*^9}, {3.686376039592869*^9, 3.686376257840508*^9}, {
   3.686377285709462*^9, 3.686377525460105*^9}, {3.686377563970949*^9, 
   3.686377574154319*^9}, {3.686377642527919*^9, 3.686377646359543*^9}, {
   3.6863778882152967`*^9, 3.6863778923988256`*^9}, {3.6863780270741673`*^9, 
   3.686378193484436*^9}, {3.6863782290437403`*^9, 3.686378294121036*^9}, {
   3.6863785961832867`*^9, 3.686378646460758*^9}, {3.6863791831066427`*^9, 
   3.686379192553739*^9}, {3.686380228805229*^9, 3.6863802397250233`*^9}, {
   3.6864024243395777`*^9, 3.686402428810791*^9}, 3.686402580014575*^9, {
   3.686646642032658*^9, 3.686646662503133*^9}, {3.686648323134224*^9, 
   3.6866483422448883`*^9}, {3.686649145801855*^9, 3.686649206646247*^9}, {
   3.686649267309105*^9, 3.686649273859928*^9}, {3.686649467797632*^9, 
   3.686649541170877*^9}, {3.686649589625564*^9, 3.68664959592067*^9}, {
   3.686649629913076*^9, 3.68664977321183*^9}, {3.6866499462140512`*^9, 
   3.68665002537844*^9}, {3.686650066680772*^9, 3.686650375573316*^9}, {
   3.686650494178249*^9, 3.686650683875194*^9}, {3.686650725530733*^9, 
   3.686650736313149*^9}, {3.686650779840146*^9, 3.686650794878701*^9}, {
   3.686650830757923*^9, 3.686650833103372*^9}, 3.690463337319343*^9, {
   3.690463519425106*^9, 3.690463542655642*^9}, {3.692358643106851*^9, 
   3.692358645753737*^9}, {3.692360346741235*^9, 3.6923603523569202`*^9}, {
   3.695382935983808*^9, 3.695382959513227*^9}, {3.695590303368299*^9, 
   3.695590314964652*^9}, {3.6955903560036*^9, 3.695590385327395*^9}, {
   3.695590475734643*^9, 3.695590478801902*^9}, {3.695590548136286*^9, 
   3.695590567086792*^9}, {3.6955906256161413`*^9, 3.695590706374649*^9}, {
   3.695591063427348*^9, 3.695591083608902*^9}, 3.695649542742794*^9, {
   3.696156300697195*^9, 3.696156328310823*^9}, {3.696156624101235*^9, 
   3.6961566241856117`*^9}, {3.696156655596562*^9, 3.696156765384254*^9}, {
   3.696156795807089*^9, 3.696156830021326*^9}, {3.696156870077898*^9, 
   3.696156880459425*^9}, {3.6961569141241627`*^9, 3.696156958056724*^9}, {
   3.696161760164963*^9, 3.6961617603552628`*^9}, {3.6971792061363173`*^9, 
   3.69717923527952*^9}, {3.7119451664030647`*^9, 3.7119451687637672`*^9}, {
   3.7119452430806627`*^9, 3.7119452432960253`*^9}, 3.711948456339809*^9, {
   3.711970690645649*^9, 3.711970711455888*^9}, {3.711970767037573*^9, 
   3.711970799195491*^9}, {3.711970846842822*^9, 3.711970916503469*^9}, {
   3.711970951503151*^9, 3.711970952966449*^9}, {3.7119709990618362`*^9, 
   3.7119711307926817`*^9}, {3.711971763259494*^9, 3.711971909037772*^9}, {
   3.7119719559089603`*^9, 3.7119721415235033`*^9}, {3.7119721817339363`*^9, 
   3.7119722855696783`*^9}, {3.71205014560471*^9, 3.7120504103390617`*^9}, {
   3.7120505799262333`*^9, 3.712050582317378*^9}, {3.7120506198130302`*^9, 
   3.7120506710598707`*^9}, {3.712050747000153*^9, 3.712050751201849*^9}, {
   3.712050793672027*^9, 3.712050794565625*^9}, {3.712050825306147*^9, 
   3.712050839766513*^9}, {3.712050871332884*^9, 3.712050945609661*^9}, {
   3.7120510105932407`*^9, 3.712051421010355*^9}, {3.712051464473606*^9, 
   3.712051467368425*^9}, {3.712051526311372*^9, 3.712051551581478*^9}, {
   3.712058336132338*^9, 3.712058527687859*^9}, {3.712136795594927*^9, 
   3.712136830386901*^9}, {3.712301076775725*^9, 3.7123011495646133`*^9}, {
   3.7123011983161583`*^9, 3.71230121303428*^9}, {3.71230124368265*^9, 
   3.71230159145371*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Parameter sweep for time to 4% clonality while varying N", "Subsection",
 CellChangeTimes->{{3.6955889835676126`*^9, 3.695589018132989*^9}, {
  3.697178782677712*^9, 3.697178794356946*^9}, {3.7123016645532312`*^9, 
  3.71230166959241*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"SetDirectory", "@", 
    RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"paramFunc", "[", 
    RowBox[{
    "\[Section]\[ScriptCapitalN]_", ",", "\[Section]\[Epsilon]_", ",", 
     "\[Section]\[ScriptL]_", ",", "\[Section]sStarScale_", ",", 
     "\[Section]\[Beta]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[ScriptCapitalN]", "\[Rule]", "\[Section]\[ScriptCapitalN]"}],
       ",", 
      RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
      RowBox[{"nStar", "\[Rule]", "\[Section]nStar"}], ",", 
      RowBox[{"\[ScriptCapitalS]", "\[Rule]", "1"}], ",", 
      RowBox[{"\[Beta]", "\[Rule]", "\[Section]\[Beta]"}], ",", 
      RowBox[{"\[ScriptL]", "\[Rule]", "\[Section]\[ScriptL]"}], ",", 
      RowBox[{"\[Delta]", "\[Rule]", 
       FractionBox[
        RowBox[{"\[Section]\[Beta]", " ", "\[Section]nStar"}], 
        "\[Section]sStar"]}], ",", 
      RowBox[{"d", "\[Rule]", 
       RowBox[{
        FractionBox["\[Section]sStar", 
         RowBox[{"\[Section]\[ScriptL]", " ", "\[Section]nStar"}]], "-", 
        "\[Section]\[Beta]"}]}], ",", 
      RowBox[{"a", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", "\[Section]\[ScriptL]"], "-", 
          FractionBox[
           RowBox[{"\[Section]\[Beta]", " ", "\[Section]nStar"}], 
           "\[Section]sStar"]}], ")"}], 
        FractionBox["\[Section]\[ScriptCapitalN]", 
         RowBox[{"\[Section]\[ScriptCapitalN]", "-", "\[Section]nStar"}]]}]}],
       ",", 
      RowBox[{"\[Epsilon]", "\[Rule]", "\[Section]\[Epsilon]"}], ",", 
      RowBox[{"\[Gamma]\[Beta]", "\[Rule]", "1"}], ",", 
      RowBox[{"\[Gamma]\[Delta]", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Gamma]d", "\[Rule]", "0"}], ",", 
      RowBox[{"\[Gamma]a", "\[Rule]", "0"}]}], "}"}], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"\[Section]sStar", "\[Rule]", 
       RowBox[{
       "\[Section]sStarScale", "\[Times]", "\[Section]\[ScriptCapitalN]"}]}], 
      ",", 
      RowBox[{"\[Section]nStar", "\[Rule]", 
       RowBox[{"0.99", "\[Section]\[ScriptCapitalN]"}]}]}], "}"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Define", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptCapitalN]Vals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["10.", "i"], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "2", ",", "9", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Epsilon]Vals", "=", 
   RowBox[{"{", 
    RowBox[{"0.", ",", "0.1", ",", "0.5"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptL]Vals", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"6.", ",", "60.", ",", "600."}], "}"}], "/", "1440."}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"sStarScale", "=", 
   RowBox[{"{", 
    RowBox[{"0.01", ",", "0.001", ",", "0.0001"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Beta]Val", "=", 
    FractionBox["1.", 
     RowBox[{"40.", "\[Times]", "7."}]]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n\[ScriptCapitalN]", "=", 
   RowBox[{"Length", "[", "\[ScriptCapitalN]Vals", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n\[Epsilon]", "=", 
   RowBox[{"Length", "[", "\[Epsilon]Vals", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n\[ScriptL]", "=", 
   RowBox[{"Length", "[", "\[ScriptL]Vals", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nS", "=", 
    RowBox[{"Length", "[", "sStarScale", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"params", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"paramFunc", "[", 
       RowBox[{
        RowBox[{"\[ScriptCapitalN]Vals", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        RowBox[{"\[Epsilon]Vals", "[", 
         RowBox[{"[", "j", "]"}], "]"}], ",", 
        RowBox[{"\[ScriptL]Vals", "[", 
         RowBox[{"[", "k", "]"}], "]"}], ",", 
        RowBox[{"sStarScale", "[", 
         RowBox[{"[", "l", "]"}], "]"}], ",", "\[Beta]Val"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n\[ScriptL]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]Val", "=", "0.04"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6955892735947247`*^9, 3.695589280245528*^9}, {
   3.695589544699678*^9, 3.695589725330764*^9}, {3.695590058083886*^9, 
   3.6955900636680517`*^9}, 3.696155918840119*^9, {3.6961559670672503`*^9, 
   3.696155967179043*^9}, {3.696156068320134*^9, 3.696156085134693*^9}, {
   3.696156427947268*^9, 3.696156428138509*^9}, {3.6961564669373693`*^9, 
   3.696156544206696*^9}, {3.696161469792405*^9, 3.6961615549501762`*^9}, {
   3.712136317104512*^9, 3.7121363178079433`*^9}, {3.712309624505206*^9, 
   3.712309705653572*^9}, {3.712309811234437*^9, 3.7123098175775347`*^9}, {
   3.712310312321397*^9, 3.712310402877701*^9}, {3.7123107525388737`*^9, 
   3.712310809424149*^9}, {3.712310938660426*^9, 3.712310957818583*^9}, {
   3.712311150980583*^9, 3.712311327037861*^9}, {3.7123113810761337`*^9, 
   3.7123114009536343`*^9}, {3.712312181785475*^9, 3.7123122166151*^9}, {
   3.712312360293085*^9, 3.712312404632661*^9}, 3.71231351662969*^9, {
   3.7123196707416077`*^9, 3.712319693007846*^9}, 3.712322004304706*^9, {
   3.712324086608624*^9, 3.7123241055039587`*^9}, {3.712389092578124*^9, 
   3.71238909265*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Theory", " ", "predictions"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"z0Tab", "=", 
     RowBox[{"Map", "[", 
      RowBox[{"getZ0", ",", "params", ",", 
       RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"test", "=", 
     RowBox[{"Map", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"#", "\[GreaterEqual]", "0"}], "&"}], ",", "z0Tab", ",", 
       RowBox[{"{", "4", "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"timePrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"test", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
         RowBox[{"conditionalTime", "[", 
          RowBox[{
           RowBox[{"z0Tab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
           "\[Sigma]Val", ",", 
           RowBox[{"params", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], " ",
           "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n\[ScriptL]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"variancePrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"test", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
         RowBox[{"variance", "[", 
          RowBox[{
           RowBox[{"z0Tab", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}], ",", 
           "\[Sigma]Val", ",", 
           RowBox[{"params", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}]}], " ",
           "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n\[ScriptL]"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6904632692331457`*^9, 3.690463273800323*^9}, {
   3.6904633052638407`*^9, 3.690463309278974*^9}, 3.695589755301725*^9, {
   3.695590066970168*^9, 3.695590072711014*^9}, {3.695590208923634*^9, 
   3.695590256182686*^9}, {3.6961559261253033`*^9, 3.696155995226655*^9}, {
   3.6961560312196217`*^9, 3.696156124253413*^9}, {3.6961561830193443`*^9, 
   3.6961562063064337`*^9}, {3.696156439195855*^9, 3.696156444602887*^9}, {
   3.6961565852052794`*^9, 3.69615659194901*^9}, {3.696161548904463*^9, 
   3.696161550606512*^9}, {3.6961624773864613`*^9, 3.696162484906294*^9}, 
   3.711948487062718*^9, {3.7123135527972107`*^9, 3.7123135573189907`*^9}, {
   3.712314316731248*^9, 3.7123143204750566`*^9}, {3.712319679461101*^9, 
   3.712319684224791*^9}, {3.712389084826372*^9, 3.712389100360978*^9}, {
   3.712392502337514*^9, 3.712392504464493*^9}, {3.712393390354679*^9, 
   3.7123933925775137`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "variance", " ", "and", " ", "export", " ", "for", " ", 
    "speed"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Comment", " ", "out", " ", "to", " ", "avoid", " ", "costly", " ", 
    "recalculations"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"analyticVariance", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptCapitalN]", "/.", 
            RowBox[{"params", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"conditionalTime", "[", 
            RowBox[{
             RowBox[{"z0Tab", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             "\[Section]\[Section]\[Sigma]", ",", 
             RowBox[{"params", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
           RowBox[{"variance", "[", 
            RowBox[{
             RowBox[{"z0Tab", "[", 
              RowBox[{"[", "j", "]"}], "]"}], ",", 
             "\[Section]\[Section]\[Sigma]", ",", 
             RowBox[{"params", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";", 
    "\n", 
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<zz-data/clonal-human/variance\>\"", "<>", 
          RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], ",", 
         RowBox[{"analyticVariance", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], " ", "]"}], "&"}], ",", 
      RowBox[{"Range", "[", "n\[Epsilon]", "]"}]}], " ", "]"}], ";"}], "*)"}],
   "\n", 
  RowBox[{
   RowBox[{"analyticVariance", "=", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Import", "[", 
        RowBox[{"\"\<zz-data/clonal-human/variance\>\"", "<>", 
         RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], "]"}], 
       "&"}], ",", 
      RowBox[{"Range", "[", "n\[Epsilon]", "]"}]}], " ", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6904632692331457`*^9, 3.690463273800323*^9}, {
   3.6904633052638407`*^9, 3.690463309278974*^9}, 3.695589755301725*^9, {
   3.695590066970168*^9, 3.695590072711014*^9}, {3.695590208923634*^9, 
   3.695590256182686*^9}, {3.6961559261253033`*^9, 3.696155995226655*^9}, {
   3.6961560312196217`*^9, 3.696156124253413*^9}, {3.6961561830193443`*^9, 
   3.6961562063064337`*^9}, {3.696156439195855*^9, 3.696156444602887*^9}, {
   3.6961565852052794`*^9, 3.69615659194901*^9}, {3.696161548904463*^9, 
   3.696161550606512*^9}, {3.6961624773864613`*^9, 3.696162484906294*^9}, 
   3.711948487062718*^9, {3.7123135527972107`*^9, 3.712313561166348*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"linTicks", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"x", ",", "20"}], "]"}], "\[Equal]", "0"}], ",", 
         RowBox[{"ToString", "[", "x", "]"}], ",", "\"\<\>\""}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"x", ",", "20"}], "]"}], "\[Equal]", "0"}], ",", "0.015",
            ",", "0.01"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "90", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"linTicksBlank", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x", ",", "\"\<\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Mod", "[", 
             RowBox[{"x", ",", "20"}], "]"}], "\[Equal]", "0"}], ",", "0.015",
            ",", "0.01"}], "]"}], ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", "0", ",", "90", ",", "5"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"myTicks", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"l", "\[Equal]", "1"}], ",", "linTicks", ",", 
            "linTicksBlank"}], "]"}], ",", "linTicksBlank"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "2"], ",", 
              SuperscriptBox["10", "9"]}], "}"}], ",", "False", ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"k", "\[Equal]", "n\[ScriptL]"}], ",", "True", ",", 
              "False"}], "]"}], ",", "True", ",", "False"}], "]"}], ",", 
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", "2"], ",", 
              SuperscriptBox["10", "9"]}], "}"}], ",", "False", ",", "False", 
            ",", "True", ",", "False"}], "]"}]}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", "1", ",", "n\[ScriptL]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"l", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sLabels", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{
            RowBox[{"\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)=\>\"", "<>", 
             RowBox[{"ToString", "[", 
              RowBox[{
               RowBox[{"Superscript", "[", 
                RowBox[{"\"\<10\>\"", ",", 
                 RowBox[{"Round", "[", 
                  RowBox[{"Log10", "[", 
                   RowBox[{"sStarScale", "[", 
                    RowBox[{"[", "l", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
                " ", "]"}], ",", 
               RowBox[{"FormatType", "\[Rule]", "StandardForm"}]}], "]"}], 
             "<>", "\"\<\!\(\*\nStyleBox[\\\"N\\\",\\nFontSlant->\\\"Italic\\\
\"]\)\>\""}], ",", "labelSize", ",", 
            RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "/.", 
          "myPlotStyle"}], " ", "]"}], " ", "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"275", ",", "25"}], "}"}]}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[ScriptL]Labels", "=", 
   RowBox[{"Prepend", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"Graphics", "[", 
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<\[ScriptL]=\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"Round", "[", 
                 RowBox[{"1440", 
                  RowBox[{"\[ScriptL]Vals", "[", 
                   RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], " ", "]"}], 
               "<>", "\"\< mins\>\""}], ",", "labelSize", ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "/.", 
            "myPlotStyle"}], " ", "]"}], " ", "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"110", ",", "25"}], "}"}]}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
     RowBox[{"Graphics", "[", 
      RowBox[{
       RowBox[{"Text", "[", "\"\<\>\"", "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"110", ",", "30"}], "}"}]}]}], "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.712396580573594*^9, 3.71239676989366*^9}, {
   3.712396983311307*^9, 3.7123970660992603`*^9}, 3.7123976950431213`*^9, {
   3.712398901422146*^9, 3.712398901581189*^9}, {3.712399180020465*^9, 
   3.712399180267742*^9}, {3.712399254009951*^9, 3.7123992573221684`*^9}, {
   3.712399295489057*^9, 3.71239929561611*^9}, {3.712399627329733*^9, 
   3.7123996457159357`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plots", "=", 
   RowBox[{"Table", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Show", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"ListLogLinearPlot", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\[ScriptCapitalN]", "/.", 
                  RowBox[{"params", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                   "]"}]}], ",", 
                 RowBox[{"timePrediction", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                  "]"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], 
           ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"k", "\[Equal]", "l", "\[Equal]", "1"}], ",", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"LineLegend", "[", 
                 RowBox[{
                  RowBox[{"Map", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"NumberForm", "[", 
                    RowBox[{
                    RowBox[{"1", "+", "#"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"2", ",", "1"}], "}"}]}], "]"}], "&"}], ",", 
                    "\[Epsilon]Vals"}], "]"}], ",", 
                  RowBox[{
                  "LegendLabel", "\[Rule]", 
                   "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \
\(2\)]\)/\[Beta]\>\""}], ",", 
                  RowBox[{"LabelStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{"ticksSize", ",", 
                    RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                    RowBox[{"GrayLevel", "[", "0.4", "]"}]}], " ", "]"}]}], 
                  ",", 
                  RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
                  RowBox[{"LegendMarkerSize", "\[Rule]", "20"}], ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
                  RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                RowBox[{"Scaled", "[", 
                 RowBox[{"{", 
                  RowBox[{"0.87", ",", "0.65"}], "}"}], "]"}]}], " ", "]"}], 
              " ", ",", "None"}], "]"}]}]}], " ", "]"}], "/.", 
         "myPlotStyle"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"ListLogLinearPlot", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[ScriptCapitalN]", "/.", 
                    RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                    "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"timePrediction", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}],
                     "-", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"variancePrediction", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}],
                     " ", "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}],
                 "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"\[ScriptCapitalN]", "/.", 
                    RowBox[{"params", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], 
                    "]"}]}], ",", 
                   RowBox[{
                    RowBox[{"timePrediction", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}],
                     "+", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"variancePrediction", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "k", ",", "l"}], "]"}], "]"}],
                     " ", "]"}]}]}], "}"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalN]"}], "}"}]}],
                 "]"}]}], "}"}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}], ",", 
             RowBox[{"PlotStyle", "\[Rule]", "None"}], ",", 
             RowBox[{"Filling", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"1", "\[Rule]", 
                RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
             RowBox[{"FillingStyle", "\[Rule]", 
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"myCol", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Opacity", "[", "0.2", "]"}]}], " ", "]"}]}]}], " ", 
            "]"}], "/.", "myPlotStyle"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "\[Equal]", "1"}], ",", "300", ",", "282"}], "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"ImagePadding", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"l", "\[Equal]", "1"}], ",", "25", ",", "7"}], "]"}], 
             ",", "7"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"k", "\[Equal]", "nS"}], ",", "25", ",", "5"}], "]"}], 
             ",", "5"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"FrameLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<Mean time (years)\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Style", "[", 
                RowBox[{"\"\<System size,  \!\(\*
StyleBox[\"N\",
FontSlant->\"Italic\"]\)\>\"", ",", "labelSize", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
               "None"}], "}"}]}], "}"}]}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"FrameTicks", "\[Rule]", 
         RowBox[{"myTicks", "[", 
          RowBox[{"[", 
           RowBox[{"k", ",", "l"}], "]"}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FrameTicksStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"ticksSize", ",", 
           RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             FractionBox["2", 
              RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
             FractionBox["9", 
              RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "90"}], "}"}]}], "}"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/.", "myPlotStyle"}], ",", 
     RowBox[{"{", 
      RowBox[{"k", ",", "1", ",", "n\[ScriptL]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"l", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.712317017052958*^9, 3.7123171045109262`*^9}, {
   3.712317192805015*^9, 3.7123172397716093`*^9}, {3.7123174968585463`*^9, 
   3.712317525433178*^9}, {3.712317924180832*^9, 3.712317958546586*^9}, {
   3.712318028809326*^9, 3.712318037576726*^9}, {3.712318543327127*^9, 
   3.712318687410254*^9}, {3.712318718985424*^9, 3.712318758728343*^9}, {
   3.712319630587387*^9, 3.71231964508987*^9}, {3.712320526876899*^9, 
   3.712320572922921*^9}, {3.712321735291367*^9, 3.7123217597447968`*^9}, {
   3.7123218146801043`*^9, 3.7123218548300877`*^9}, {3.712324050419136*^9, 
   3.712324057089945*^9}, 3.712391981347335*^9, {3.712392094255583*^9, 
   3.71239209558335*^9}, {3.712392143253566*^9, 3.712392157622178*^9}, {
   3.712392282465376*^9, 3.712392322192355*^9}, {3.7123925652873497`*^9, 
   3.712392566463057*^9}, {3.7123931951214113`*^9, 3.712393196673087*^9}, {
   3.712393271086104*^9, 3.712393294389593*^9}, {3.712393331724738*^9, 
   3.7123933780425253`*^9}, {3.712396128378518*^9, 3.712396242057476*^9}, {
   3.712396518871139*^9, 3.712396521013692*^9}, {3.71239672343232*^9, 
   3.712396724458143*^9}, {3.712396774198678*^9, 3.712396778342716*^9}, {
   3.712397096525092*^9, 3.712397106819964*^9}, {3.712397190593174*^9, 
   3.712397193336029*^9}, {3.712397247606648*^9, 3.712397264069614*^9}, {
   3.712399217900311*^9, 3.712399244074657*^9}, {3.712399338759997*^9, 
   3.712399458923045*^9}, {3.712399489111889*^9, 3.7123995971393623`*^9}, 
   3.712399675692176*^9, {3.7123997058657103`*^9, 3.7123997466733828`*^9}, 
   3.7123998672705097`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"grid", "=", 
   RowBox[{"Grid", "[", " ", 
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Append", "[", 
       RowBox[{
        RowBox[{"Transpose", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{"plots", ",", "sLabels"}], "]"}], " ", "]"}], ",", 
        "\[ScriptL]Labels"}], "]"}], "]"}], ",", 
     RowBox[{"Spacings", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0.5", ",", "0"}], "}"}]}]}], "]"}]}], ";"}], "\n", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"Rotate", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
             "\"\<Time to 4% clonlity (years)\>\"", ",", "labelSize", ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
            RowBox[{"90", "Degree"}]}], "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"30", ",", "300"}], "}"}]}]}], "]"}], "/.", 
       "myPlotStyle"}], ",", "grid"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{"Null", ",", 
      RowBox[{
       RowBox[{"Graphics", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"Style", "[", 
           RowBox[{
           "\"\<System size,  \!\(\*\n\
StyleBox[\\\"N\\\",\\nFontSlant->\\\"Italic\\\"]\)\>\"", ",", "labelSize", 
            ",", 
            RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"200", ",", "30"}], "}"}]}]}], "]"}], "/.", 
       "myPlotStyle"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.712397971863497*^9, 3.712398073249707*^9}, {
  3.712398923525165*^9, 3.712398924224766*^9}, {3.712399764215768*^9, 
  3.712399807588571*^9}, {3.712399843061198*^9, 3.712399848472899*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["5. Reconstitution of preconditioned host", "Chapter",
 CellChangeTimes->{{3.695623613252121*^9, 3.695623619512342*^9}, {
  3.695707693935843*^9, 3.695707694223825*^9}}],

Cell[CellGroupData[{

Cell["Analysis", "Section",
 CellChangeTimes->{{3.7089290699546003`*^9, 3.708929071831161*^9}}],

Cell[BoxData[
 RowBox[{"fSol", "=", 
  RowBox[{"First", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"f", "\[Equal]", 
          RowBox[{
           FractionBox[
            RowBox[{"\[Alpha]", " ", "\[Delta]"}], 
            RowBox[{"d", "+", "\[Beta]", "+", 
             RowBox[{"\[Alpha]", " ", "\[Delta]"}]}]], "+", 
           RowBox[{
            FractionBox["d", 
             RowBox[{"d", "+", "\[Beta]", "+", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}]], "\[Psi]"}], "+", 
           RowBox[{
            FractionBox["\[Beta]", 
             RowBox[{"d", "+", "\[Beta]", "+", 
              RowBox[{"\[Alpha]", " ", "\[Delta]"}]}]], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", "\[Rho]"}], ")"}], "\[Psi]", " ", "f"}], 
              "+", 
              RowBox[{"\[Rho]", " ", 
               SuperscriptBox["f", "2"]}]}], ")"}]}]}]}], ")"}], "/.", 
        RowBox[{"\[Rho]", "\[Rule]", "0"}]}], "]"}], ",", "f"}], "]"}], "]"}],
    "]"}]}]], "Input",
 CellChangeTimes->{{3.7089290797837133`*^9, 3.7089291874436483`*^9}, {
  3.708929237084651*^9, 3.7089292678168383`*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Psi]", "==", 
       RowBox[{
        FractionBox["\[Delta]", 
         RowBox[{"\[Delta]", "+", "a"}]], "+", 
        RowBox[{
         FractionBox["a", 
          RowBox[{"\[Delta]", "+", "a"}]], "f"}]}]}], ")"}], "/.", "fSol"}], 
    ",", "\[Psi]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.708929214860365*^9, 3.7089292997835407`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.673249745359564*^9, 3.6732497462709723`*^9}}],

Cell[CellGroupData[{

Cell["Data analysis", "Subsection",
 CellChangeTimes->{{3.690719784380838*^9, 3.690719785331936*^9}, {
  3.6956238472649813`*^9, 3.695623851319709*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPars", "[", "form_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "i", ",", "data", ",", "parsBase", ",", 
      "parsPars", ",", "pars"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", "form", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"parsBase", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Section]\[ScriptCapitalN]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]sStar", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]nStar", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]\[ScriptL]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]\[ScriptCapitalS]", "\[Rule]", "1"}]}], "}"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"parsPars", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Section]\[Beta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]\[Delta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]a", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Section]d", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4"}], "]"}], "]"}]}], ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"data", "[", 
                RowBox[{"[", "2", "]"}], "]"}], " ", "]"}], "\[Equal]", "5"}],
              ",", 
             RowBox[{"\[Section]\[Alpha]", "\[Rule]", 
              RowBox[{"data", "[", 
               RowBox[{"[", 
                RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ",", 
             RowBox[{"\[Section]\[Alpha]", "\[Rule]", "0"}]}], "]"}]}], 
          "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pars", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"parsBase", ",", "parsPars"}], "}"}], "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "pars", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695583714787603*^9, 3.695583723715773*^9}, {
  3.695583954441474*^9, 3.6955840232506523`*^9}, {3.6956253540012302`*^9, 
  3.695625360040989*^9}, {3.695625423687889*^9, 3.69562544530217*^9}, {
  3.695625476700931*^9, 3.695625529730783*^9}, {3.695627341578754*^9, 
  3.695627354561433*^9}, {3.6956281038166933`*^9, 3.695628132621253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getReconstProb", "[", "form_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "prob", ",", "data", ",", "\[ScriptL]", ",",
       "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", "form", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptL]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prob", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[ScriptL]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"1440.", "\[Times]", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "4"}], "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"data", ",", "2"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prob", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptL]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"N", "[", 
            RowBox[{"Mean", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
          "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "prob", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.676700979324822*^9, 3.6767013256883993`*^9}, {
  3.676701397054736*^9, 3.67670140358974*^9}, {3.684755982180838*^9, 
  3.6847560740324163`*^9}, {3.684757182041049*^9, 3.6847571821849318`*^9}, {
  3.69562602844175*^9, 3.695626124877328*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getReconstProbAlt", "[", "form_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "prob", ",", "data", ",", "\[Alpha]", ",", 
      "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", "form", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Alpha]", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prob", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Alpha]", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", " ", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"data", ",", "2"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prob", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Alpha]", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"N", "[", 
            RowBox[{"Mean", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
          "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "prob", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.676700979324822*^9, 3.6767013256883993`*^9}, {
  3.676701397054736*^9, 3.67670140358974*^9}, {3.684667314852365*^9, 
  3.684667346986517*^9}, {3.684667406625225*^9, 3.684667442463169*^9}, {
  3.684667479086219*^9, 3.684667479405816*^9}, {3.684667532524184*^9, 
  3.684667536403904*^9}, {3.6847519808996696`*^9, 3.684751982634819*^9}, {
  3.684752037480791*^9, 3.684752038168833*^9}, {3.6847522484910383`*^9, 
  3.684752248961372*^9}, {3.68475517492204*^9, 3.6847551757532263`*^9}, {
  3.684763107388145*^9, 3.684763108386552*^9}, {3.684763145473881*^9, 
  3.684763170824417*^9}, {3.6907197301269417`*^9, 3.6907197304779663`*^9}, {
  3.6956282596496363`*^9, 3.695628292983626*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getReconstProbS", "[", "form_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "prob", ",", "data", ",", "sStar", ",", 
      "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", "form", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"sStar", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"prob", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"sStar", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Transpose", "[", 
          RowBox[{"Drop", "[", 
           RowBox[{"data", ",", "2"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"prob", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"sStar", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"N", "[", 
            RowBox[{"Mean", "[", 
             RowBox[{"data", "[", 
              RowBox[{"[", "1", "]"}], "]"}], " ", "]"}], " ", "]"}]}], 
          "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "prob", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.707481406578659*^9, 3.707481450617272*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Analytical predictions", "Subsection",
 CellChangeTimes->{{3.690719784380838*^9, 3.690719785331936*^9}, {
  3.6956238472649813`*^9, 3.695623862583226*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Original", " ", 
    RowBox[{"model", ":", " ", 
     RowBox[{"First", " ", "approximation"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"reconstProb0", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           FractionBox["\[Delta]", 
            RowBox[{"a", "+", "\[Delta]"}]], ")"}], "\[ScriptCapitalS]"]}], 
        ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           RowBox[{
            FractionBox["1", "\[ScriptL]"], 
            FractionBox["sStar", "nStar"]}], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], 
      ")"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"Original", " ", 
     RowBox[{"model", ":", " ", 
      RowBox[{"Full", " ", "solution"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reconstProb", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox[
             RowBox[{" ", "\[Delta]"}], 
             RowBox[{"a", "+", "\[Delta]"}]], 
            FractionBox[
             RowBox[{"d", "+", "\[Beta]"}], "\[Beta]"]}], ")"}], 
          "\[ScriptCapitalS]"]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           RowBox[{
            FractionBox["1", "\[ScriptL]"], 
            FractionBox["sStar", "nStar"]}], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Alternative", " ", 
     RowBox[{"model", ":", " ", 
      RowBox[{"Full", " ", "solution"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"reconstProbAlt", "=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            FractionBox["\[Delta]", 
             RowBox[{"a", "+", "\[Delta]"}]], 
            FractionBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Beta]", "+", "d", "+", 
                RowBox[{"\[Alpha]", " ", "\[Delta]"}]}], ")"}], "+", 
              RowBox[{"a", " ", "\[Alpha]"}]}], "\[Beta]"]}], ")"}], 
          "\[ScriptCapitalS]"]}], ")"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[Delta]", "\[Rule]", 
          FractionBox[
           RowBox[{"\[Beta]", " ", "nStar"}], 
           RowBox[{"sStar", "+", 
            RowBox[{"\[Alpha]", " ", "nStar"}]}]]}], ",", 
         RowBox[{"d", "\[Rule]", 
          RowBox[{
           RowBox[{
            FractionBox["1", "\[ScriptL]"], 
            FractionBox["sStar", "nStar"]}], "-", "\[Beta]"}]}], ",", 
         RowBox[{"a", "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FractionBox["1", "\[ScriptL]"], "-", 
             FractionBox[
              RowBox[{"\[Beta]", " ", "nStar"}], 
              RowBox[{"sStar", "+", 
               RowBox[{"\[Alpha]", " ", "nStar"}]}]]}], ")"}], 
           FractionBox["\[ScriptCapitalN]", 
            RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.690718933187565*^9, 3.690718942002735*^9}, {
  3.6907196820567713`*^9, 3.6907197240624933`*^9}, {3.695624855347665*^9, 
  3.695624874546155*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Plots", "Section",
 CellChangeTimes->{{3.695624769470821*^9, 3.695624769958005*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "Main panel: original model vs ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", "*"], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Subsection",
 CellChangeTimes->{{3.690719793156396*^9, 3.6907198018355217`*^9}, {
  3.6907198751617107`*^9, 3.690719875496697*^9}, {3.695624779902974*^9, 
  3.695624785933456*^9}, {3.697182625127001*^9, 3.697182627020895*^9}, {
  3.7074749645456047`*^9, 3.707474966829118*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "parameters", " ", "and", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"form", "[", "x_", "]"}], ":=", 
    RowBox[{
    "\"\<./zz-data/preconditioned/original/engraftProb_\>\"", "<>", "x", 
     "<>", "\"\<.dat\>\""}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indices", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<*_00_999\>\"", ",", "\"\<*_01_999\>\"", ",", "\"\<*_02_999\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"num", "=", 
     RowBox[{"Length", "[", "indices", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.69562559554852*^9, 3.695625598399873*^9}, {
  3.6956256524393883`*^9, 3.695625677941085*^9}, {3.695625739162807*^9, 
  3.695626020264777*^9}, {3.69562610207803*^9, 3.695626107649383*^9}, {
  3.695626144656904*^9, 3.695626147525078*^9}, {3.6956273670335083`*^9, 
  3.695627384807953*^9}, {3.6956277179967213`*^9, 3.6956277251244164`*^9}, {
  3.6956282014424562`*^9, 3.695628205370554*^9}, {3.707474976832458*^9, 
  3.707474980816287*^9}, {3.7074751122610807`*^9, 3.7074751124117517`*^9}, {
  3.707475151338168*^9, 3.707475151450409*^9}, {3.707480856822098*^9, 
  3.7074808605411787`*^9}, {3.707480925403261*^9, 3.7074809271149683`*^9}, {
  3.707481044818842*^9, 3.70748107551956*^9}, {3.707555213231751*^9, 
  3.707555228206036*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"params", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"getPars", "[", 
      RowBox[{"form", "[", 
       RowBox[{"indices", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramsSFunc", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\[ScriptCapitalN]", "\[Rule]", "\[Section]\[ScriptCapitalN]"}], ",", 
        
        RowBox[{
        "\[ScriptCapitalS]", "\[Rule]", "\[Section]\[ScriptCapitalS]"}], ",", 
        
        RowBox[{"nStar", "\[Rule]", "\[Section]nStar"}], ",", 
        RowBox[{"sStar", "\[Rule]", "\[Section]\[Section]sStar"}], ",", 
        RowBox[{"\[Beta]", "\[Rule]", "\[Section]\[Beta]"}], ",", 
        RowBox[{"\[ScriptL]", "\[Rule]", "\[Section]\[ScriptL]"}], ",", 
        RowBox[{"\[Alpha]", "\[Rule]", "\[Section]\[Alpha]"}]}], "}"}], "/.", 
      
      RowBox[{"params", "[", 
       RowBox[{"[", 
        RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[ScriptL]Vals", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Round", "[", 
       RowBox[{
        RowBox[{"1440.", "\[Section]\[ScriptL]"}], "/.", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], " ", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"getReconstProbS", "[", 
      RowBox[{"form", "[", 
       RowBox[{"indices", "[", 
        RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.69562559554852*^9, 3.695625598399873*^9}, {
   3.6956256524393883`*^9, 3.695625677941085*^9}, {3.695625739162807*^9, 
   3.695626020264777*^9}, {3.69562610207803*^9, 3.695626107649383*^9}, {
   3.695626144656904*^9, 3.695626147525078*^9}, {3.6956273670335083`*^9, 
   3.695627384807953*^9}, {3.6956277179967213`*^9, 3.6956277251244164`*^9}, {
   3.6956282014424562`*^9, 3.695628205370554*^9}, {3.707474976832458*^9, 
   3.707474980816287*^9}, {3.7074751122610807`*^9, 3.7074751124117517`*^9}, {
   3.707475151338168*^9, 3.707475151450409*^9}, {3.707480856822098*^9, 
   3.7074808605411787`*^9}, {3.707480925403261*^9, 3.7074809271149683`*^9}, {
   3.707481044818842*^9, 3.707481154699875*^9}, {3.7074812442410173`*^9, 
   3.70748127720686*^9}, 3.707481457368823*^9}],

Cell[BoxData["data"], "Input",
 CellChangeTimes->{{3.7074813782028513`*^9, 3.707481378443056*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySym", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "0.7"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mySymBig", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "1.1"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"mainPanel", "=", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LogLinearPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"reconstProb", "/.", 
           RowBox[{"paramsSFunc", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Section]sStar", ",", "1", ",", "128"}], "}"}], 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"LineLegend", "[", 
           RowBox[{"\[ScriptL]Vals", ",", 
            RowBox[{"LegendMarkers", "\[Rule]", "mySymBig"}], ",", 
            RowBox[{"LegendLabel", "\[Rule]", "\"\<\[ScriptL] (mins)\>\""}], 
            ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "18", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
            RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
            RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.3"}], "}"}]}], "]"}]}]}], " ", "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"LogLinearPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"reconstProb0", "/.", 
           RowBox[{"paramsSFunc", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Section]sStar", ",", "1", ",", "128"}], "}"}], 
       ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Dotted", ",", 
            RowBox[{"myCol", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotMarkers", "\[Rule]", "mySymBig"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
         "\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)\>\"", ",", "labelSize", 
          ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Reconstitution Prob.\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"ticksSize", ",", 
        RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"Log10", "[", "1", "]"}], 
           RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
          FractionBox[
           RowBox[{"Log10", "[", "128", "]"}], 
           RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.92", ",", "1"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "350"}]}], "\[IndentingNewLine]", "]"}], 
   "/.", "myPlotStyle"}]}]}], "Input",
 CellChangeTimes->{{3.676187167751549*^9, 3.6761872791955147`*^9}, {
   3.67618745950136*^9, 3.676187469540773*^9}, {3.676187506363727*^9, 
   3.676187528043665*^9}, {3.676187584521097*^9, 3.676187586944746*^9}, {
   3.676193468367508*^9, 3.676193501564136*^9}, {3.676193546204811*^9, 
   3.676193789604044*^9}, {3.676194390951418*^9, 3.67619439113517*^9}, {
   3.676194531835161*^9, 3.6761945867523937`*^9}, {3.676194743020062*^9, 
   3.676194743354826*^9}, {3.676194867943478*^9, 3.676194900221445*^9}, {
   3.676195307336607*^9, 3.676195318176538*^9}, {3.676195366765708*^9, 
   3.676195464185676*^9}, {3.6761967561092453`*^9, 3.676196795522889*^9}, {
   3.676701715156272*^9, 3.676701716499498*^9}, {3.676704251477838*^9, 
   3.676704296723969*^9}, {3.6767044787967176`*^9, 3.676704483964714*^9}, {
   3.676704616064863*^9, 3.676704701965728*^9}, 3.676704765781336*^9, {
   3.6767048065301323`*^9, 3.6767048514962463`*^9}, 3.676704886065534*^9, {
   3.676705131383449*^9, 3.6767051543021097`*^9}, {3.67670527908226*^9, 
   3.6767053183757*^9}, {3.676707080699407*^9, 3.6767071066331367`*^9}, {
   3.676707152801051*^9, 3.67670715963946*^9}, {3.676707254618391*^9, 
   3.676707278019137*^9}, {3.67671664164213*^9, 3.676716641849145*^9}, {
   3.676716676193823*^9, 3.6767167247983*^9}, {3.676716765997422*^9, 
   3.6767168005155983`*^9}, {3.676716882176817*^9, 3.676716945294902*^9}, {
   3.6767170459251747`*^9, 3.6767170607788143`*^9}, {3.676718574367128*^9, 
   3.6767186497567997`*^9}, {3.681535695134433*^9, 3.681535698590333*^9}, {
   3.681535744285284*^9, 3.681535890927622*^9}, {3.6815359809893713`*^9, 
   3.681535981780435*^9}, {3.68153604429919*^9, 3.681536045402277*^9}, {
   3.681536089137332*^9, 3.6815360892886066`*^9}, {3.681536198749497*^9, 
   3.681536261466614*^9}, {3.681536654430881*^9, 3.681536722932189*^9}, {
   3.681537142501647*^9, 3.6815371578606157`*^9}, {3.681537338334341*^9, 
   3.6815373397972507`*^9}, 3.681537858555859*^9, {3.68153792608152*^9, 
   3.681537987678331*^9}, {3.684659947078411*^9, 3.6846599908844357`*^9}, {
   3.684660701917544*^9, 3.684660711307166*^9}, {3.684750426321916*^9, 
   3.684750456152512*^9}, 3.6847505354624767`*^9, 3.6847505885484467`*^9, {
   3.684756538849083*^9, 3.6847565396015043`*^9}, {3.6847567484574413`*^9, 
   3.684756869837099*^9}, {3.684756909835198*^9, 3.6847569355299053`*^9}, {
   3.6847572559432287`*^9, 3.684757267390047*^9}, {3.690720026381978*^9, 
   3.690720225189761*^9}, {3.690720478732951*^9, 3.690720478899685*^9}, {
   3.690720531419169*^9, 3.690720550713361*^9}, {3.695626165820869*^9, 
   3.695626179627293*^9}, {3.695627272525612*^9, 3.695627290372546*^9}, {
   3.695627554858206*^9, 3.69562764509546*^9}, {3.695627744444347*^9, 
   3.6956277687865973`*^9}, {3.695627850936256*^9, 3.6956279176689453`*^9}, {
   3.695628728792872*^9, 3.695628728896248*^9}, {3.6971826738362837`*^9, 
   3.697182673956007*^9}, {3.697182705716474*^9, 3.697182717330534*^9}, {
   3.6971827614272833`*^9, 3.697182803751441*^9}, {3.697182834847155*^9, 
   3.697182836718484*^9}, {3.697182968026033*^9, 3.6971829736576767`*^9}, {
   3.6971830327686853`*^9, 3.697183033767529*^9}, {3.69718311399776*^9, 
   3.697183120668326*^9}, {3.697183392539839*^9, 3.697183427537856*^9}, {
   3.697183507750389*^9, 3.697183524886215*^9}, {3.707481227097074*^9, 
   3.707481235072578*^9}, {3.70748130226254*^9, 3.707481365300267*^9}, {
   3.707481466449724*^9, 3.707481530183185*^9}, {3.707555861728775*^9, 
   3.707555898808272*^9}, {3.707555947334725*^9, 3.707556016707588*^9}, {
   3.707556350768302*^9, 3.707556351023938*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Main panel: original model vs \[ScriptL]", "Subsection",
 CellChangeTimes->{{3.690719793156396*^9, 3.6907198018355217`*^9}, {
  3.6907198751617107`*^9, 3.690719875496697*^9}, {3.695624779902974*^9, 
  3.695624785933456*^9}, {3.697182625127001*^9, 3.697182627020895*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "parameters", " ", "and", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"form", "[", "x_", "]"}], ":=", 
    RowBox[{
    "\"\<./zz-data/preconditioned/original/engraftProb_\>\"", "<>", "x", 
     "<>", "\"\<.dat\>\""}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indices", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<00_*_001\>\"", ",", "\"\<01_*_001\>\"", ",", "\"\<02_*_001\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"num", "=", 
     RowBox[{"Length", "[", "indices", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getPars", "[", 
        RowBox[{"form", "[", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params\[ScriptL]Func", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[ScriptCapitalN]", "\[Rule]", "\[Section]\[ScriptCapitalN]"}], 
          ",", 
          RowBox[{
          "\[ScriptCapitalS]", "\[Rule]", "\[Section]\[ScriptCapitalS]"}], 
          ",", 
          RowBox[{"nStar", "\[Rule]", "\[Section]nStar"}], ",", 
          RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
          RowBox[{"\[Beta]", "\[Rule]", "\[Section]\[Beta]"}], ",", 
          RowBox[{"\[ScriptL]", "\[Rule]", 
           RowBox[{"\[Section]\[Section]\[ScriptL]", "/", "1440."}]}], ",", 
          RowBox[{"\[Alpha]", "\[Rule]", "\[Section]\[Alpha]"}]}], "}"}], "/.", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sStarVals", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\[Section]sStar", "/.", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getReconstProb", "[", 
        RowBox[{"form", "[", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.69562559554852*^9, 3.695625598399873*^9}, {
  3.6956256524393883`*^9, 3.695625677941085*^9}, {3.695625739162807*^9, 
  3.695626020264777*^9}, {3.69562610207803*^9, 3.695626107649383*^9}, {
  3.695626144656904*^9, 3.695626147525078*^9}, {3.6956273670335083`*^9, 
  3.695627384807953*^9}, {3.6956277179967213`*^9, 3.6956277251244164`*^9}, {
  3.6956282014424562`*^9, 3.695628205370554*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySym", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "0.7"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mySymBig", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "1.1"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"mainPanel", "=", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"reconstProb", "/.", 
           RowBox[{"params\[ScriptL]Func", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Section]\[ScriptL]", ",", "1", ",", "5"}], "}"}],
        ",", 
       RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"Placed", "[", 
         RowBox[{
          RowBox[{"LineLegend", "[", 
           RowBox[{"sStarVals", ",", 
            RowBox[{"LegendMarkers", "\[Rule]", "mySymBig"}], ",", 
            RowBox[{
            "LegendLabel", "\[Rule]", 
             "\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)\>\""}], ",", 
            RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"Directive", "[", 
              RowBox[{
               RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "18", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
            RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
            RowBox[{"Spacings", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
            RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.72", ",", "0.25"}], "}"}]}], "]"}]}]}], " ", "]"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"reconstProb0", "/.", 
           RowBox[{"params\[ScriptL]Func", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Section]\[ScriptL]", ",", "1", ",", "5"}], "}"}],
        ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Dotted", ",", 
            RowBox[{"myCol", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListPlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotMarkers", "\[Rule]", "mySym"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[ScriptL] (minutes)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{"\"\<Reconstitution Prob.\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"ticksSize", ",", 
        RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.92", ",", "1"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "500"}]}], "\[IndentingNewLine]", "]"}], 
   "/.", "myPlotStyle"}]}]}], "Input",
 CellChangeTimes->{{3.676187167751549*^9, 3.6761872791955147`*^9}, {
   3.67618745950136*^9, 3.676187469540773*^9}, {3.676187506363727*^9, 
   3.676187528043665*^9}, {3.676187584521097*^9, 3.676187586944746*^9}, {
   3.676193468367508*^9, 3.676193501564136*^9}, {3.676193546204811*^9, 
   3.676193789604044*^9}, {3.676194390951418*^9, 3.67619439113517*^9}, {
   3.676194531835161*^9, 3.6761945867523937`*^9}, {3.676194743020062*^9, 
   3.676194743354826*^9}, {3.676194867943478*^9, 3.676194900221445*^9}, {
   3.676195307336607*^9, 3.676195318176538*^9}, {3.676195366765708*^9, 
   3.676195464185676*^9}, {3.6761967561092453`*^9, 3.676196795522889*^9}, {
   3.676701715156272*^9, 3.676701716499498*^9}, {3.676704251477838*^9, 
   3.676704296723969*^9}, {3.6767044787967176`*^9, 3.676704483964714*^9}, {
   3.676704616064863*^9, 3.676704701965728*^9}, 3.676704765781336*^9, {
   3.6767048065301323`*^9, 3.6767048514962463`*^9}, 3.676704886065534*^9, {
   3.676705131383449*^9, 3.6767051543021097`*^9}, {3.67670527908226*^9, 
   3.6767053183757*^9}, {3.676707080699407*^9, 3.6767071066331367`*^9}, {
   3.676707152801051*^9, 3.67670715963946*^9}, {3.676707254618391*^9, 
   3.676707278019137*^9}, {3.67671664164213*^9, 3.676716641849145*^9}, {
   3.676716676193823*^9, 3.6767167247983*^9}, {3.676716765997422*^9, 
   3.6767168005155983`*^9}, {3.676716882176817*^9, 3.676716945294902*^9}, {
   3.6767170459251747`*^9, 3.6767170607788143`*^9}, {3.676718574367128*^9, 
   3.6767186497567997`*^9}, {3.681535695134433*^9, 3.681535698590333*^9}, {
   3.681535744285284*^9, 3.681535890927622*^9}, {3.6815359809893713`*^9, 
   3.681535981780435*^9}, {3.68153604429919*^9, 3.681536045402277*^9}, {
   3.681536089137332*^9, 3.6815360892886066`*^9}, {3.681536198749497*^9, 
   3.681536261466614*^9}, {3.681536654430881*^9, 3.681536722932189*^9}, {
   3.681537142501647*^9, 3.6815371578606157`*^9}, {3.681537338334341*^9, 
   3.6815373397972507`*^9}, 3.681537858555859*^9, {3.68153792608152*^9, 
   3.681537987678331*^9}, {3.684659947078411*^9, 3.6846599908844357`*^9}, {
   3.684660701917544*^9, 3.684660711307166*^9}, {3.684750426321916*^9, 
   3.684750456152512*^9}, 3.6847505354624767`*^9, 3.6847505885484467`*^9, {
   3.684756538849083*^9, 3.6847565396015043`*^9}, {3.6847567484574413`*^9, 
   3.684756869837099*^9}, {3.684756909835198*^9, 3.6847569355299053`*^9}, {
   3.6847572559432287`*^9, 3.684757267390047*^9}, {3.690720026381978*^9, 
   3.690720225189761*^9}, {3.690720478732951*^9, 3.690720478899685*^9}, {
   3.690720531419169*^9, 3.690720550713361*^9}, {3.695626165820869*^9, 
   3.695626179627293*^9}, {3.695627272525612*^9, 3.695627290372546*^9}, {
   3.695627554858206*^9, 3.69562764509546*^9}, {3.695627744444347*^9, 
   3.6956277687865973`*^9}, {3.695627850936256*^9, 3.6956279176689453`*^9}, {
   3.695628728792872*^9, 3.695628728896248*^9}, {3.6971826738362837`*^9, 
   3.697182673956007*^9}, {3.697182705716474*^9, 3.697182717330534*^9}, {
   3.6971827614272833`*^9, 3.697182803751441*^9}, {3.697182834847155*^9, 
   3.697182836718484*^9}, {3.697182968026033*^9, 3.6971829736576767`*^9}, {
   3.6971830327686853`*^9, 3.697183033767529*^9}, {3.69718311399776*^9, 
   3.697183120668326*^9}, {3.697183392539839*^9, 3.697183427537856*^9}, {
   3.697183507750389*^9, 3.697183524886215*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Show", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"reconstProb", "/.", 
          RowBox[{"params\[ScriptL]Func", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Section]\[Section]\[ScriptL]", ",", "1", ",", "5"}], "}"}], 
      ",", 
      RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotLegends", "\[Rule]", 
       RowBox[{"Placed", "[", 
        RowBox[{
         RowBox[{"LineLegend", "[", 
          RowBox[{"sStarVals", ",", 
           RowBox[{"LegendMarkers", "\[Rule]", "mySymBig"}], ",", 
           RowBox[{
           "LegendLabel", "\[Rule]", 
            "\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)\>\""}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "18", ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
           RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
           RowBox[{"Spacings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
           RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.15", ",", "0.3"}], "}"}]}], "]"}]}]}], " ", "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"reconstProb0", "/.", 
          RowBox[{"params\[ScriptL]Func", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Section]\[Section]\[ScriptL]", ",", "1", ",", "5"}], "}"}], 
      ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Directive", "[", 
          RowBox[{"Dotted", ",", 
           RowBox[{"myCol", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"data", ",", 
      RowBox[{"PlotMarkers", "\[Rule]", "mySymBig"}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<\[ScriptL] (minutes)\>\"", ",", "labelSize", ",", 
         RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Reconstitution Prob.\>\"", ",", "labelSize", ",", 
         RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"FrameTicksStyle", "\[Rule]", 
     RowBox[{"Directive", "[", 
      RowBox[{"ticksSize", ",", 
       RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "5"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0.92", ",", "1"}], "}"}]}], "}"}]}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "400"}]}], "\[IndentingNewLine]", "]"}], "/.",
   "myPlotStyle"}]], "Input",
 CellChangeTimes->{{3.707474734769412*^9, 3.7074747406333447`*^9}, {
  3.7074747876413393`*^9, 3.70747485684553*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Inset: alternative model vs \[Alpha] (for fixed \[ScriptL])", \
"Subsection",
 CellChangeTimes->{{3.695624795165737*^9, 3.695624805724781*^9}, {
  3.6971826312608957`*^9, 3.697182649300214*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "parameters", " ", "and", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"form", "[", "x_", "]"}], ":=", 
    RowBox[{
    "\"\<./zz-data/preconditioned/alternative/engraftProb_\>\"", "<>", "x", 
     "<>", "\"\<.dat\>\""}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"indices", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<000_004_*_001\>\"", ",", "\"\<001_004_*_001\>\"", ",", 
       "\"\<002_004_*_001\>\""}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"num", "=", 
     RowBox[{"Length", "[", "indices", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getPars", "[", 
        RowBox[{"form", "[", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"params\[ScriptL]Func", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[ScriptCapitalN]", "\[Rule]", "\[Section]\[ScriptCapitalN]"}], 
          ",", 
          RowBox[{
          "\[ScriptCapitalS]", "\[Rule]", "\[Section]\[ScriptCapitalS]"}], 
          ",", 
          RowBox[{"nStar", "\[Rule]", "\[Section]nStar"}], ",", 
          RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
          RowBox[{"\[Beta]", "\[Rule]", "\[Section]\[Beta]"}], ",", 
          RowBox[{"\[ScriptL]", "\[Rule]", "\[Section]\[ScriptL]"}], ",", 
          RowBox[{"\[Alpha]", "\[Rule]", "\[Section]\[Section]\[Alpha]"}]}], 
         "}"}], "/.", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sStarVals", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"\[Section]sStar", "/.", 
        RowBox[{"params", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getReconstProbAlt", "[", 
        RowBox[{"form", "[", 
         RowBox[{"indices", "[", 
          RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.69562559554852*^9, 3.695625598399873*^9}, {
   3.6956256524393883`*^9, 3.695625677941085*^9}, {3.695625739162807*^9, 
   3.695626020264777*^9}, {3.69562610207803*^9, 3.695626107649383*^9}, {
   3.695626144656904*^9, 3.695626147525078*^9}, {3.6956273670335083`*^9, 
   3.695627384807953*^9}, {3.6956277179967213`*^9, 3.6956277251244164`*^9}, {
   3.6956279381087837`*^9, 3.695627986812807*^9}, 3.6956287701151037`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mySym", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "0.7"}]}], "}"}],
      ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"mySymBig", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "\[Times]", "1.5"}]}], 
       "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"inset", "=", 
  RowBox[{
   RowBox[{"Show", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LogLinearPlot", "[", 
      RowBox[{
       RowBox[{"Evaluate", "[", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"reconstProbAlt", "/.", 
           RowBox[{"params\[ScriptL]Func", "[", 
            RowBox[{"[", "i", "]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], " ", "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"\[Section]\[Section]\[Alpha]", ",", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]], ",", "1"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLogLinearPlot", "[", 
      RowBox[{"data", ",", 
       RowBox[{"PlotMarkers", "\[Rule]", "mySymBig"}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<\[Alpha]\>\"", ",", 
          RowBox[{"labelSize", "-", "2"}], ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", "None"}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{
        RowBox[{"ticksSize", "-", "2"}], ",", 
        RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["i", 
               RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
              RowBox[{"Superscript", "[", 
               RowBox[{"\"\<10\>\"", ",", "i"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "8"}], ",", "0", ",", "2"}], "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              FractionBox["i", 
               RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
              "\"\<\>\""}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", 
              RowBox[{"-", "8"}], ",", "0", ",", "2"}], "}"}]}], "]"}]}], 
         "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          FractionBox[
           RowBox[{"-", "8"}], 
           RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
          FractionBox["0", 
           RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0.0", ",", "1"}], "}"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", "220"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Background", "\[Rule]", "White"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ImagePadding", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"23", ",", "5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"45", ",", "3"}], "}"}]}], "}"}]}]}], "\[IndentingNewLine]", 
    "]"}], "/.", "myPlotStyle"}]}]}], "Input",
 CellChangeTimes->{{3.695628573782344*^9, 3.695628590972674*^9}, {
   3.695628621236765*^9, 3.695628703137442*^9}, 3.697182753434794*^9, {
   3.6971830036337013`*^9, 3.6971830207854757`*^9}, {3.697183056616581*^9, 
   3.697183089717883*^9}, {3.697183131124155*^9, 3.697183131564025*^9}, {
   3.697183254571341*^9, 3.697183338364699*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Combined fig", "Subsection",
 CellChangeTimes->{{3.690720323620864*^9, 3.690720338352648*^9}, {
  3.6907203978142147`*^9, 3.690720402757575*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"mainPanel", ",", 
   RowBox[{"Epilog", "\[Rule]", 
    RowBox[{"Inset", "[", 
     RowBox[{"inset", ",", 
      RowBox[{"Scaled", "[", 
       RowBox[{"{", 
        RowBox[{"0.28", ",", "0.36"}], "}"}], "]"}]}], " ", "]"}]}]}], " ", 
  "]"}]], "Input",
 CellChangeTimes->{{3.6907204043627977`*^9, 3.69072041705309*^9}, {
  3.690720572480157*^9, 3.690720667068509*^9}, {3.6956248225569057`*^9, 
  3.695624839891564*^9}, {3.69718310409339*^9, 3.697183106143763*^9}, {
  3.6971831413160048`*^9, 3.6971831602184896`*^9}, {3.697183238384974*^9, 
  3.697183251047353*^9}, {3.6971833292846212`*^9, 3.697183375170753*^9}}]
}, Closed]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["6. Non-preconditioned host", "Chapter",
 CellChangeTimes->{{3.695628824924637*^9, 3.6956288285636673`*^9}, {
  3.695707696263802*^9, 3.695707696847687*^9}}],

Cell[CellGroupData[{

Cell["Functions", "Section",
 CellChangeTimes->{{3.69562883542819*^9, 3.69562883629123*^9}}],

Cell[CellGroupData[{

Cell["ODE integration and approximations", "Subsection",
 CellChangeTimes->{{3.673249745359564*^9, 3.6732497462709723`*^9}, {
  3.695634026084848*^9, 3.6956340327711763`*^9}}],

Cell[CellGroupData[{

Cell["Integrators", "Subsubsection",
 CellChangeTimes->{{3.695640799265752*^9, 3.69564080384892*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solveODEs", "[", 
   RowBox[{"params_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paramSub", ",", "initialCondition", ",", "eqs", ",", "dSol"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paramSub", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Delta]", "\[Rule]", 
         FractionBox[
          RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
        RowBox[{"d", "\[Rule]", 
         RowBox[{
          FractionBox["sStar", 
           RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
        RowBox[{"a", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "\[ScriptL]"], "-", 
            FractionBox[
             RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
          FractionBox["\[ScriptCapitalN]", 
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"initialCondition", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"s1", "[", "0", "]"}], "\[Equal]", "sStar"}], ",", 
        RowBox[{
         RowBox[{"s2", "[", "0", "]"}], "\[Equal]", "\[ScriptCapitalS]"}], 
        ",", 
        RowBox[{
         RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "nStar"}], ",", 
        RowBox[{
         RowBox[{"n2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d1", "+", "\[Beta]1"}], ")"}], 
              RowBox[{"n1", "[", "t", "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", 
                RowBox[{"a1", 
                 FractionBox[
                  RowBox[{"\[ScriptCapitalN]", "-", 
                   RowBox[{"n1", "[", "t", "]"}], "-", 
                   RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}], 
               ")"}], 
              RowBox[{"s1", "[", "t", "]"}]}]}]}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"s2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d2", "+", "\[Beta]2"}], ")"}], 
              RowBox[{"n2", "[", "t", "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Delta]2", "+", 
                RowBox[{"a2", 
                 FractionBox[
                  RowBox[{"\[ScriptCapitalN]", "-", 
                   RowBox[{"n1", "[", "t", "]"}], "-", 
                   RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}], 
               ")"}], 
              RowBox[{"s2", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d1"}], " ", 
              RowBox[{"n1", "[", "t", "]"}]}], "+", 
             RowBox[{"a1", 
              FractionBox[
               RowBox[{"\[ScriptCapitalN]", "-", 
                RowBox[{"n1", "[", "t", "]"}], "-", 
                RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
              RowBox[{"s1", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d2"}], " ", 
              RowBox[{"n2", "[", "t", "]"}]}], "+", 
             RowBox[{"a2", 
              FractionBox[
               RowBox[{"\[ScriptCapitalN]", "-", 
                RowBox[{"n1", "[", "t", "]"}], "-", 
                RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
              RowBox[{"s2", "[", "t", "]"}]}]}]}]}], "\[IndentingNewLine]", 
          "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a1", "\[Rule]", "a"}], ",", 
           RowBox[{"d1", "\[Rule]", "d"}], ",", 
           RowBox[{"\[Beta]1", "\[Rule]", "\[Beta]"}], ",", 
           RowBox[{"\[Delta]1", "\[Rule]", "\[Delta]"}], ",", 
           RowBox[{"a2", "\[Rule]", "a"}], ",", 
           RowBox[{"d2", "\[Rule]", "d"}], ",", 
           RowBox[{"\[Beta]2", "\[Rule]", "\[Beta]"}], ",", 
           RowBox[{"\[Delta]2", "\[Rule]", "\[Delta]"}]}], "}"}]}], ")"}], "/.",
        "paramSub"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"dSol", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"eqs", "/.", "params"}], ",", 
            RowBox[{"initialCondition", "/.", "params"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s1", "[", "t", "]"}], ",", 
           RowBox[{"s2", "[", "t", "]"}], ",", 
           RowBox[{"n1", "[", "t", "]"}], ",", 
           RowBox[{"n2", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "dSol", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695633729703937*^9, 3.695633736142619*^9}, 
   3.695634325705853*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solveLinearODEs", "[", 
   RowBox[{"params_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paramSub", ",", "initialCondition", ",", "eqs", ",", "dSol"}], 
     "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paramSub", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Delta]", "\[Rule]", 
         FractionBox[
          RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
        RowBox[{"d", "\[Rule]", 
         RowBox[{
          FractionBox["sStar", 
           RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
        RowBox[{"a", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "\[ScriptL]"], "-", 
            FractionBox[
             RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
          FractionBox["\[ScriptCapitalN]", 
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"initialCondition", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"s2", "[", "0", "]"}], "\[Equal]", 
         RowBox[{"\[ScriptCapitalS]", "-", 
          RowBox[{"(", 
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], ")"}]}]}], ",", 
        RowBox[{
         RowBox[{"n2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"n2", "'"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"-", "d"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n2", "[", "t", "]"}], "-", 
              RowBox[{"\[ScriptCapitalN]", " ", 
               FractionBox[
                RowBox[{"s2", "[", "t", "]"}], 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"sStar", "+", "\[ScriptCapitalS]", "-", 
                    RowBox[{"(", 
                    RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], ")"}], "-", 
                    FractionBox[
                    RowBox[{"\[Beta]", " ", "\[ScriptCapitalN]"}], 
                    "\[Delta]"]}], ")"}], 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Delta]"}], " ", "t"}], "]"}]}], " ", "+", 
                  
                  FractionBox[
                   RowBox[{"\[Beta]", " ", "\[ScriptCapitalN]"}], 
                   "\[Delta]"]}], ")"}]]}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"s2", "'"}], "[", "t", "]"}], "\[Equal]", 
           RowBox[{
            RowBox[{"d", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"n2", "[", "t", "]"}], "-", 
               RowBox[{"\[ScriptCapitalN]", " ", 
                FractionBox[
                 RowBox[{"s2", "[", "t", "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"sStar", "+", "\[ScriptCapitalS]", "-", 
                    RowBox[{"(", 
                    RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], ")"}], "-", 
                    FractionBox[
                    RowBox[{"\[Beta]", " ", "\[ScriptCapitalN]"}], 
                    "\[Delta]"]}], ")"}], 
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[Delta]"}], " ", "t"}], "]"}]}], " ", "+", 
                   
                   FractionBox[
                    RowBox[{"\[Beta]", " ", "\[ScriptCapitalN]"}], 
                    "\[Delta]"]}], ")"}]]}]}], ")"}]}], "+", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"n2", "[", "t", "]"}]}], "-", 
            RowBox[{"\[Delta]", " ", 
             RowBox[{"s2", "[", "t", "]"}]}]}]}]}], "\[IndentingNewLine]", 
         "}"}], ")"}], "/.", "paramSub"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"dSol", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"eqs", "/.", "params"}], ",", 
            RowBox[{"initialCondition", "/.", "params"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s2", "[", "t", "]"}], ",", 
           RowBox[{"n2", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "dSol", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6694417697705317`*^9, 3.669441846103045*^9}, {
  3.669441892693983*^9, 3.6694420051450987`*^9}, {3.669442229793828*^9, 
  3.6694422912943068`*^9}, {3.669442375123905*^9, 3.669442390674618*^9}, {
  3.6694424728003817`*^9, 3.669442481407476*^9}, {3.669443134087372*^9, 
  3.6694431356468143`*^9}, {3.6742048459821568`*^9, 3.6742049076172323`*^9}, {
  3.674210891326152*^9, 3.674210934076521*^9}, {3.67421698973663*^9, 
  3.67421699792376*^9}, {3.6742171576113443`*^9, 3.674217159314579*^9}, {
  3.695634208542243*^9, 3.695634275284821*^9}, {3.6956343072428627`*^9, 
  3.6956343249300737`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"solveODEsDaily", "[", 
   RowBox[{"params_", ",", "T_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "paramSub", ",", "initialCondition", ",", "eqs", ",", "dSol", ",", 
      "condition"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paramSub", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Delta]", "\[Rule]", 
         FractionBox[
          RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
        RowBox[{"d", "\[Rule]", 
         RowBox[{
          FractionBox["sStar", 
           RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
        RowBox[{"a", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "\[ScriptL]"], "-", 
            FractionBox[
             RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
          FractionBox["\[ScriptCapitalN]", 
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"initialCondition", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"s1", "[", "0", "]"}], "\[Equal]", "sStar"}], ",", 
        RowBox[{
         RowBox[{"s2", "[", "0", "]"}], "\[Equal]", 
         FractionBox["\[ScriptCapitalS]", "7.0"]}], ",", 
        RowBox[{
         RowBox[{"n1", "[", "0", "]"}], "\[Equal]", "nStar"}], ",", 
        RowBox[{
         RowBox[{"n2", "[", "0", "]"}], "\[Equal]", "0"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"s1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d1", "+", "\[Beta]1"}], ")"}], 
              RowBox[{"n1", "[", "t", "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Delta]1", "+", 
                RowBox[{"a1", 
                 FractionBox[
                  RowBox[{"\[ScriptCapitalN]", "-", 
                   RowBox[{"n1", "[", "t", "]"}], "-", 
                   RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}], 
               ")"}], 
              RowBox[{"s1", "[", "t", "]"}]}]}]}], " ", ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"s2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"d2", "+", "\[Beta]2"}], ")"}], 
              RowBox[{"n2", "[", "t", "]"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[Delta]2", "+", 
                RowBox[{"a2", 
                 FractionBox[
                  RowBox[{"\[ScriptCapitalN]", "-", 
                   RowBox[{"n1", "[", "t", "]"}], "-", 
                   RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"]}]}], 
               ")"}], 
              RowBox[{"s2", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n1", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d1"}], " ", 
              RowBox[{"n1", "[", "t", "]"}]}], "+", 
             RowBox[{"a1", 
              FractionBox[
               RowBox[{"\[ScriptCapitalN]", "-", 
                RowBox[{"n1", "[", "t", "]"}], "-", 
                RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
              RowBox[{"s1", "[", "t", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"n2", "'"}], "[", "t", "]"}], "\[Equal]", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "d2"}], " ", 
              RowBox[{"n2", "[", "t", "]"}]}], "+", 
             RowBox[{"a2", 
              FractionBox[
               RowBox[{"\[ScriptCapitalN]", "-", 
                RowBox[{"n1", "[", "t", "]"}], "-", 
                RowBox[{"n2", "[", "t", "]"}]}], "\[ScriptCapitalN]"], 
              RowBox[{"s2", "[", "t", "]"}]}]}]}]}], "\[IndentingNewLine]", 
          "}"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a1", "\[Rule]", "a"}], ",", 
           RowBox[{"d1", "\[Rule]", "d"}], ",", 
           RowBox[{"\[Beta]1", "\[Rule]", "\[Beta]"}], ",", 
           RowBox[{"\[Delta]1", "\[Rule]", "\[Delta]"}], ",", 
           RowBox[{"a2", "\[Rule]", "a"}], ",", 
           RowBox[{"d2", "\[Rule]", "d"}], ",", 
           RowBox[{"\[Beta]2", "\[Rule]", "\[Beta]"}], ",", 
           RowBox[{"\[Delta]2", "\[Rule]", "\[Delta]"}]}], "}"}]}], ")"}], "/.",
        "paramSub"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"condition", "=", 
      RowBox[{"WhenEvent", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{"t", ",", "1"}], "]"}], "\[Equal]", "0"}], "&&", 
         RowBox[{"t", "<", "6.5"}]}], ",", 
        RowBox[{
         RowBox[{"s2", "[", "t", "]"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"s2", "[", "t", "]"}], "+", 
           FractionBox[
            RowBox[{"\[ScriptCapitalS]", "/.", "params"}], "7.0"]}], 
          ")"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dSol", "=", 
      RowBox[{
       RowBox[{"NDSolve", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"eqs", "/.", "params"}], ",", 
            RowBox[{"initialCondition", "/.", "params"}], ",", 
            RowBox[{"{", "condition", "}"}]}], "}"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s1", "[", "t", "]"}], ",", 
           RowBox[{"s2", "[", "t", "]"}], ",", 
           RowBox[{"n1", "[", "t", "]"}], ",", 
           RowBox[{"n2", "[", "t", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"t", ",", "0", ",", "T"}], "}"}]}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "dSol", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.673249817317045*^9, 3.673249834476966*^9}, {
  3.6732498651559067`*^9, 3.673249897979486*^9}, {3.67324992945844*^9, 
  3.6732499354330187`*^9}, {3.680340764479157*^9, 3.6803407664543552`*^9}, {
  3.680341774316372*^9, 3.680341774436242*^9}, {3.680341830554257*^9, 
  3.680341902127614*^9}, {3.680342696213352*^9, 3.6803426965971622`*^9}, {
  3.695640922534548*^9, 3.695641049177264*^9}, {3.695641307984838*^9, 
  3.6956413411113243`*^9}, {3.695641652043207*^9, 3.6956416521586237`*^9}, {
  3.69564225965464*^9, 3.695642270749593*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Wrappers", "Subsubsection",
 CellChangeTimes->{{3.695640808889436*^9, 3.695640810368544*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"predictionODEs", "[", "params_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dSol", ",", "x", ",", 
      RowBox[{"T", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dSol", "=", 
      RowBox[{"solveODEs", "[", 
       RowBox[{"params", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n2", "[", "t", "]"}], "/.", "dSol"}], ")"}], "/.", 
        RowBox[{"t", "\[Rule]", "T"}]}], 
       RowBox[{"nStar", "/.", "params"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "x", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6744564585766773`*^9, 3.67445651053187*^9}, {
   3.6956337857162857`*^9, 3.695633816187169*^9}, {3.695633982614213*^9, 
   3.695633985261095*^9}, 3.695634144343444*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"predictionSmall", "[", "params_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"paramSub", ",", "x"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"paramSub", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Delta]", "\[Rule]", 
         FractionBox[
          RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ",", 
        RowBox[{"d", "\[Rule]", 
         RowBox[{
          FractionBox["sStar", 
           RowBox[{"\[ScriptL]", " ", "nStar"}]], "-", "\[Beta]"}]}], ",", 
        RowBox[{"a", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            FractionBox["1", "\[ScriptL]"], "-", 
            FractionBox[
             RowBox[{"\[Beta]", " ", "nStar"}], "sStar"]}], ")"}], 
          FractionBox["\[ScriptCapitalN]", 
           RowBox[{"\[ScriptCapitalN]", "-", "nStar"}]]}]}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           FractionBox["1", "nStar"], 
           FractionBox[
            RowBox[{"a", 
             FractionBox[
              RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], 
              "\[ScriptCapitalN]"]}], 
            RowBox[{"\[Delta]", "+", 
             RowBox[{"a", 
              FractionBox[
               RowBox[{"\[ScriptCapitalN]", "-", "nStar"}], 
               "\[ScriptCapitalN]"]}]}]], "\[ScriptCapitalS]"}], ")"}], "/.", 
         "paramSub"}], ")"}], "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"x", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"x", ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "x", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695633852273795*^9, 3.695633956566566*^9}, {
   3.6956339974368773`*^9, 3.695633999541191*^9}, 3.695634149520348*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"predictionBig", "[", "params_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dSol", ",", "x", ",", 
      RowBox[{"T", "=", "10"}]}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dSol", "=", 
      RowBox[{"solveLinearODEs", "[", 
       RowBox[{"params", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n2", "[", "t", "]"}], "/.", "dSol"}], ")"}], "/.", 
        RowBox[{"t", "\[Rule]", "T"}]}], 
       RowBox[{"nStar", "/.", "params"}]]}], ";", "\[IndentingNewLine]", 
     RowBox[{"x", "=", 
      RowBox[{"Min", "[", 
       RowBox[{
        RowBox[{"Max", "[", 
         RowBox[{"x", ",", "0"}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "x", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.674455783991061*^9, 3.674455928337544*^9}, {
  3.6744564227433767`*^9, 3.674456423055252*^9}, {3.67453935812615*^9, 
  3.67453936326123*^9}, {3.6745611663955936`*^9, 3.6745611703872766`*^9}, {
  3.6956340398593397`*^9, 3.6956340450117607`*^9}, {3.6956340927702513`*^9, 
  3.6956341395277452`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Data Analysis", "Subsection",
 CellChangeTimes->{{3.6956437183304043`*^9, 3.695643720769752*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPars", "[", "dir_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "i", ",", "data", ",", "parsBase", ",", 
      "parsPars", ",", "parsSel", ",", "pars"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.dat\>\"", ",", "dir"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"pars", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"parsBase", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptCapitalN]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"sStar", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"nStar", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[ScriptL]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "4"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[ScriptCapitalS]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"1", ",", "5"}], "]"}], "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"data", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "6"}], "]"}], "]"}]}]}], "*)"}], "}"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"parsPars", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Beta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Delta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"a", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"d", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"2", ",", "4"}], "]"}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"parsSel", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Gamma]\[Beta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Gamma]\[Delta]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "2"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Gamma]a", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Gamma]d", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "4"}], "]"}], "]"}]}], ",", 
           RowBox[{"\[Epsilon]", "\[Rule]", 
            RowBox[{"data", "[", 
             RowBox[{"[", 
              RowBox[{"3", ",", "5"}], "]"}], "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"pars", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"parsBase", ",", "parsPars", ",", "parsSel"}], "}"}], 
          "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "pars", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695583714787603*^9, 3.695583723715773*^9}, {
  3.695583954441474*^9, 3.6955840232506523`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getData", "[", "dir_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "files", ",", "nFiles", ",", "data", ",", "j", ",", "dose", ",", 
      "finalState", ",", "fixProb", ",", "finalTime"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"files", "=", 
      RowBox[{"FileNames", "[", 
       RowBox[{"\"\<*.dat\>\"", ",", "dir"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"nFiles", "=", 
      RowBox[{"Length", "[", "files", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dose", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalTime", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"finalState", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fixProb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", "nFiles"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"j", "=", "1"}], ",", 
       RowBox[{"j", "\[LessEqual]", "nFiles"}], ",", 
       RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"data", "=", 
         RowBox[{"Import", "[", 
          RowBox[{"files", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dose", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "5"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data", "=", 
         RowBox[{"Drop", "[", 
          RowBox[{"data", ",", "3"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"finalTime", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"data", "[", 
          RowBox[{"[", 
           RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"finalState", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"Unitize", "[", 
          RowBox[{"data", "[", 
           RowBox[{"[", 
            RowBox[{"All", ",", "3"}], "]"}], "]"}], " ", "]"}]}], ";", " ", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"1", " ", "if", " ", "s2"}], ">", 
           RowBox[{"0", " ", "or", " ", "0", " ", "if", " ", "s2"}]}], "=", 
          "0"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"fixProb", "[", 
          RowBox[{"[", "j", "]"}], "]"}], "=", 
         RowBox[{"Mean", "[", 
          RowBox[{"finalState", "[", 
           RowBox[{"[", "j", "]"}], "]"}], " ", "]"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{"dose", ",", "finalTime", ",", "finalState", ",", "fixProb"}], 
       "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}]], "Input"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67749101974644*^9, 3.677491086411522*^9}, {
   3.677492308848658*^9, 3.677492501417471*^9}, {3.677492544560114*^9, 
   3.677492597646229*^9}, 3.695644670161037*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"extractFixationStats", "[", "dir_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fixProb", ",", "meanUnconditional", ",", "stdUnconditional", ",", 
      "meanConditional", ",", "stdConditional", ",", "dose", ",", "time", ",",
       "state", ",", "prob"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"dose", ",", "time", ",", "state", ",", "prob"}], "}"}], "=", 
      RowBox[{"getData", "[", "dir", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"fixProb", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dose", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{"N", "[", 
           RowBox[{"prob", "[", 
            RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dose", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"meanUnconditional", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dose", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"time", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "/", "365.25"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dose", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdUnconditional", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dose", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StandardDeviation", "[", 
            RowBox[{"time", "[", 
             RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "/", "365.25"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dose", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"meanConditional", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dose", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Mean", "[", 
            RowBox[{"time", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"state", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}],
               " ", "]"}], "]"}], "]"}], "/", "365.25"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dose", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stdConditional", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"dose", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"StandardDeviation", "[", 
            RowBox[{"time", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Position", "[", 
                 RowBox[{
                  RowBox[{"state", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], ",", "1"}], "]"}], "]"}]}],
               " ", "]"}], "]"}], "]"}], "/", "365.25"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dose", "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"{", 
       RowBox[{
       "fixProb", ",", "meanUnconditional", ",", "stdUnconditional", ",", 
        "meanConditional", ",", "stdConditional"}], "}"}], "]"}], ";"}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.67756815809566*^9, 3.677568315854412*^9}, {
   3.67756837141957*^9, 3.677568376167967*^9}, {3.6775775541241903`*^9, 
   3.677577580370695*^9}, 3.677577614419149*^9, {3.677577710726283*^9, 
   3.677577715597679*^9}, {3.677577765141892*^9, 3.67757776786182*^9}, 
   3.6778432999775763`*^9, {3.677843334237673*^9, 3.677843398803134*^9}, {
   3.677843743271771*^9, 3.677843775117976*^9}, {3.6848409490791407`*^9, 
   3.684840978181625*^9}, {3.695643743161385*^9, 3.6956437441770477`*^9}, {
   3.695644664154933*^9, 3.6956446669293613`*^9}, {3.695645921437624*^9, 
   3.695645941430348*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Analytical formulae", "Subsection",
 CellChangeTimes->{{3.6956433082249603`*^9, 3.695643313631789*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"getZ0", "[", "params_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dSol", ",", 
      RowBox[{"T", "=", "10"}], ",", "z0"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"dSol", "=", 
      RowBox[{"solveODEs", "[", 
       RowBox[{"params", ",", "T"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"z0", "=", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"n2", "[", "t", "]"}], "/.", "dSol"}], ")"}], "/.", 
        RowBox[{"t", "\[Rule]", "T"}]}], 
       RowBox[{"\[ScriptCapitalN]", "/.", "params"}]]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "z0", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.668841539600287*^9, 3.668841561906837*^9}, {
   3.668841616682199*^9, 3.668841619345768*^9}, {3.668841746797442*^9, 
   3.668841752108912*^9}, 3.66884188208971*^9, {3.668842044618889*^9, 
   3.668842049849934*^9}, {3.6688420839213943`*^9, 3.6688422549568567`*^9}, {
   3.67749076451233*^9, 3.677490781687209*^9}, {3.677490828637987*^9, 
   3.677490828927264*^9}, {3.677490875829639*^9, 3.6774908779562693`*^9}, {
   3.677490928098897*^9, 3.677490968104032*^9}, {3.677492918547641*^9, 
   3.6774929346022387`*^9}, {3.695584308088787*^9, 3.6955843251507587`*^9}, {
   3.695584381989959*^9, 3.695584398074939*^9}, {3.695584451565102*^9, 
   3.6955845298680887`*^9}, {3.695643448780912*^9, 3.695643488729991*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conditionalProb", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "prob"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"prob", "=", 
        FractionBox["z0", 
         RowBox[{"\[Sigma]", " ", "\[Xi]"}]]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"prob", "=", 
        RowBox[{"(", 
         FractionBox[
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "z0"}], "]"}]}], 
          RowBox[{"1", "-", 
           RowBox[{"Exp", "[", 
            RowBox[{
             RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
             "\[Xi]"}], "]"}]}]], ")"}]}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "prob", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695586504409417*^9, 3.6955866467615223`*^9}, {
   3.695586702077282*^9, 3.695586720452691*^9}, {3.711889333614003*^9, 
   3.711889368398201*^9}, 3.7118895614805183`*^9, {3.711889593406344*^9, 
   3.711889678475431*^9}, {3.7118897960392103`*^9, 3.7118899657300158`*^9}, {
   3.71189003902357*^9, 3.7118900407838087`*^9}, {3.711890092901648*^9, 
   3.711890164562224*^9}, {3.711890203186524*^9, 3.711890261958644*^9}, 
   3.711890297310302*^9, 3.7118903452206783`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"conditionalTime", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "time"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"time", "=", 
           RowBox[{
            FractionBox["\[Section]\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
            FractionBox[
             RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Xi]", "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[Xi]", "-", "z0"}], "]"}]}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"time", "=", 
           RowBox[{
            FractionBox["\[Section]\[ScriptCapitalN]", "\[ScriptCapitalB]"], 
            FractionBox[
             RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Log", "[", "\[Xi]", "]"}], "-", 
              RowBox[{"Log", "[", 
               RowBox[{"\[Xi]", "-", "z0"}], "]"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Sigma]"}], ")"}], "z0"}], 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "z0"}], ")"}]}]], 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "\[Sigma]"}], "]"}]}]}], ")"}]}]}]}], 
         "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", ",", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"time", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               FractionBox["\[Section]\[ScriptCapitalN]", 
                RowBox[{" ", 
                 RowBox[{
                 "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", 
                  "\[Xi]"}]}]]}], 
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
                  "1"}], ")"}]}]], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"EulerGamma", "+", 
                   RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
                   RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"3", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "-", 
                   
                   RowBox[{"3", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", "z", "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}],
                   ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                    
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"ExpIntegralEi", "[", 
                  RowBox[{
                   RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}]}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"2", "\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                   "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], 
                  ")"}]}], "+", 
                RowBox[{
                 RowBox[{"Exp", "[", 
                  RowBox[{
                   RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                 RowBox[{"ExpIntegralEi", "[", 
                  RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "+", "z"}], ")"}]}], "]"}], "-", 
                   RowBox[{"2", 
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}]}], 
                  ")"}]}]}], ")"}]}], ")"}], "/.", 
            RowBox[{"z", "\[Rule]", "z0"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"time", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FractionBox["\[Section]\[ScriptCapitalN]", 
               RowBox[{
               "\[ScriptCapitalB]", " ", "\[CapitalLambda]", " ", "\[Xi]"}]], 
              
              FractionBox["1", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}], 
                 ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Exp", "[", 
                   RowBox[{
                   "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], "]"}],
                   "-", "1"}], ")"}], " "}]], 
              RowBox[{"(", " ", 
               RowBox[{
                RowBox[{"2", 
                 RowBox[{"(", 
                  RowBox[{"EulerGamma", "+", 
                   RowBox[{"Log", "[", "\[Xi]", "]"}], "+", 
                   RowBox[{"Log", "[", "\[CapitalLambda]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}]}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Log", "[", "z", "]"}], "-", 
                   RowBox[{"Log", "[", 
                    RowBox[{"\[Xi]", "-", "z"}], "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
                    "]"}]}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], " ", 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}], "+", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", 
                    RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", "1"}], ")"}]}], "+", " ", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], "]"}], 
                    
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}]}], "+", 
                   
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Xi]"}], 
                    "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}]}], ")"}]}], 
                "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}], 
                    " ", 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}],
                    "+", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "\[Xi]"}], "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Sigma]"}], ")"}], "\[Xi]"}], "]"}]}],
                    "-", 
                   RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Xi]", " ", "\[Sigma]"}], 
                    "]"}], "-", 
                   RowBox[{
                    RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], 
                    RowBox[{"ExpIntegralEi", "[", 
                    RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                    "\[Xi]"}], "]"}]}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "-", "1"}],
                   ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", " ", 
                  RowBox[{
                   RowBox[{"Log", "[", 
                    RowBox[{"1", "-", "\[Sigma]"}], "]"}], "-", 
                   RowBox[{"Log", "[", "\[Sigma]", "]"}]}], ")"}], 
                 RowBox[{"(", 
                  RowBox[{"1", "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", " ", "z"}], "]"}], "+", 
                   RowBox[{"Exp", "[", 
                    RowBox[{
                    "\[CapitalLambda]", " ", "\[Sigma]", " ", "\[Xi]"}], 
                    "]"}], "-", 
                   RowBox[{"Exp", "[", 
                    RowBox[{"\[CapitalLambda]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Sigma]", " ", "\[Xi]"}], "+", "z"}], ")"}]}], 
                    "]"}]}], ")"}]}]}], ")"}]}], ")"}], "/.", 
            RowBox[{"z", "\[Rule]", "z0"}]}]}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", 
      RowBox[{"time", "/", "365.25"}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.69558468484597*^9, 3.695584718769825*^9}, {
   3.6955848037398043`*^9, 3.695584899448827*^9}, {3.695584955617128*^9, 
   3.695584980574943*^9}, {3.6955852085987377`*^9, 3.6955852577202473`*^9}, {
   3.6955852985182047`*^9, 3.6955854012801228`*^9}, {3.695585492999866*^9, 
   3.695585494576703*^9}, {3.6955855448124933`*^9, 3.6955855695475492`*^9}, {
   3.6955856712545137`*^9, 3.695585707584066*^9}, 3.695585763156383*^9, {
   3.6955858753117113`*^9, 3.695585879204714*^9}, {3.71179422580057*^9, 
   3.7117942529755573`*^9}, {3.7117943741420517`*^9, 3.711794375703191*^9}, {
   3.711794414425766*^9, 3.711794435872561*^9}, {3.7117976755762863`*^9, 
   3.7117977025990257`*^9}, {3.711797775887155*^9, 3.71179777938892*^9}, 
   3.711798326498131*^9, {3.711798520250523*^9, 3.711798530086753*^9}, {
   3.7118026866630583`*^9, 3.711802713019799*^9}, {3.711802966435885*^9, 
   3.7118029825063972`*^9}, {3.711890362280406*^9, 3.711890510761325*^9}, 
   3.7118906265092897`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"variance", "[", 
   RowBox[{"z0_", ",", "\[Sigma]_", ",", "params_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[Section]\[Epsilon]", ",", "\[Section]\[ScriptCapitalN]", ",", "\[Xi]",
       ",", "\[ScriptCapitalA]", ",", "\[ScriptCapitalB]", ",", 
      "\[CapitalLambda]", ",", "sec", ",", "var", ",", "sol", ",", 
      "\[CapitalDelta]"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Section]\[Epsilon]", "=", 
      RowBox[{"\[Epsilon]", "/.", "params"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Section]\[ScriptCapitalN]", "=", 
      RowBox[{"\[ScriptCapitalN]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Xi]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox["nStar", "\[ScriptCapitalN]"], ")"}], "/.", "params"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalA]", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"\[Beta]", 
           RowBox[{"(", 
            RowBox[{"sStar", "-", 
             RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
           "\[ScriptCapitalN]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "sStar"}]], 
         RowBox[{"(", 
          RowBox[{
          "\[Gamma]\[Beta]", "-", "\[Gamma]\[Delta]", "-", "\[Gamma]d", "+", 
           "\[Gamma]a"}], ")"}]}], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[ScriptCapitalB]", "=", 
      RowBox[{
       RowBox[{"(", 
        FractionBox[
         RowBox[{"\[Beta]", 
          RowBox[{"(", 
           RowBox[{"sStar", "-", 
            RowBox[{"\[Beta]", " ", "\[ScriptL]", " ", "nStar"}]}], ")"}], 
          "nStar", " ", "\[ScriptCapitalN]"}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"sStar", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"\[Beta]", " ", "\[ScriptL]"}]}], ")"}], "nStar"}]}], 
            ")"}], "2"], "sStar"}]], ")"}], "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[CapitalLambda]", "=", 
      FractionBox[
       RowBox[{
       "\[Section]\[Epsilon]", " ", "\[Section]\[ScriptCapitalN]", " ", 
        "\[ScriptCapitalA]"}], "\[ScriptCapitalB]"]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"\[Section]\[Epsilon]", "\[Equal]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Neutral", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"\[Sigma]", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", "Fixation", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"sec", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"2", 
              SuperscriptBox["\[Section]\[ScriptCapitalN]", "2"]}], 
             SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"\[Xi]", "-", "z0"}], "\[Xi]"], "]"}]}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", "1"}], "]"}], "-", 
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", 
                  FractionBox["z0", "\[Xi]"]}], "]"}]}], ")"}]}], ")"}]}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"\[Sigma]", "-", "Level"}], "*)"}], "\[IndentingNewLine]", 
          
          RowBox[{"sec", "=", 
           RowBox[{
            FractionBox[
             RowBox[{"2", " ", 
              SuperscriptBox["\[Section]\[ScriptCapitalN]", "2"]}], 
             SuperscriptBox["\[ScriptCapitalB]", "2"]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"\[Xi]", "-", "z0"}], "z0"], " ", 
               RowBox[{"Log", "[", 
                FractionBox[
                 RowBox[{"\[Xi]", "-", "z0"}], "\[Xi]"], "]"}]}], "+", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", "\[Sigma]"}], "]"}], "-", " ", 
                RowBox[{"PolyLog", "[", 
                 RowBox[{"2", ",", 
                  FractionBox["z0", "\[Xi]"]}], "]"}]}], ")"}], "+", 
              RowBox[{
               FractionBox[
                RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], " ", 
               RowBox[{"Log", "[", 
                RowBox[{"1", "-", "\[Sigma]"}], "]"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  FractionBox[
                   RowBox[{"\[Xi]", "-", "z0"}], "z0"], 
                  RowBox[{"Log", "[", 
                   FractionBox["\[Xi]", 
                    RowBox[{"\[Xi]", "-", "z0"}]], "]"}]}], "+", 
                 RowBox[{
                  FractionBox[
                   RowBox[{"1", "-", "\[Sigma]"}], "\[Sigma]"], 
                  RowBox[{"Log", "[", 
                   RowBox[{"1", "-", "\[Sigma]"}], "]"}]}], "-", "1"}], 
                ")"}]}]}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Selective", " ", "process"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"(*", 
        RowBox[{"Requires", " ", "numerical", " ", "solution", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "here", " ", "we", " ", "solve", " ", "the", " ", "first", " ", 
            "and", " ", "second", " ", "moments"}], ",", " ", 
           RowBox[{"because", " ", "we", " ", "can"}]}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalDelta]", "=", 
         SuperscriptBox["10.", 
          RowBox[{"-", "10"}]]}], ";", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Move", " ", "away", " ", "from", " ", "the", " ", "singular", " ", 
           
           RowBox[{"boundaries", ".", " ", "Not"}], " ", "perfect"}], ",", 
          " ", 
          RowBox[{"but", " ", "good", " ", "enough"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"sol", "=", 
         RowBox[{
          RowBox[{"NDSolve", "[", 
           RowBox[{
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", 
                 RowBox[{
                  RowBox[{"\[Theta]1", "'"}], "[", "z", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Theta]1", "''"}], "[", "z", "]"}]}], "\[Equal]", 
               RowBox[{
                RowBox[{"-", 
                 FractionBox["\[Section]\[ScriptCapitalN]", 
                  RowBox[{"\[ScriptCapitalB]", " ", "z", 
                   RowBox[{"(", 
                    RowBox[{"\[Xi]", "-", "z"}], ")"}]}]]}], 
                FractionBox[
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
                 RowBox[{"1", "-", 
                  RowBox[{"Exp", "[", 
                   RowBox[{
                    RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                    "\[Xi]"}], "]"}]}]]}]}], ",", 
              RowBox[{
               RowBox[{"\[Theta]1", "[", "\[CapitalDelta]", "]"}], "\[Equal]",
                "0"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]1", "[", 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}], "]"}], 
               "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"\[CapitalLambda]", " ", 
                 RowBox[{
                  RowBox[{"\[Theta]2", "'"}], "[", "z", "]"}]}], "+", 
                RowBox[{
                 RowBox[{"\[Theta]2", "''"}], "[", "z", "]"}]}], "\[Equal]", 
               RowBox[{
                RowBox[{"-", "2"}], 
                FractionBox["\[Section]\[ScriptCapitalN]", 
                 RowBox[{"\[ScriptCapitalB]", " ", "z", 
                  RowBox[{"(", 
                   RowBox[{"\[Xi]", "-", "z"}], ")"}]}]], 
                RowBox[{"\[Theta]1", "[", "z", "]"}]}]}], ",", 
              RowBox[{
               RowBox[{"\[Theta]2", "[", "\[CapitalDelta]", "]"}], "\[Equal]",
                "0"}], ",", 
              RowBox[{
               RowBox[{"\[Theta]2", "[", 
                RowBox[{"\[Sigma]", 
                 RowBox[{"(", 
                  RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}], "]"}], 
               "\[Equal]", "0"}]}], "\[IndentingNewLine]", "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"\[Theta]1", "[", "z", "]"}], ",", 
              RowBox[{"\[Theta]2", "[", "z", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "\[CapitalDelta]", ",", 
              RowBox[{"\[Sigma]", 
               RowBox[{"(", 
                RowBox[{"\[Xi]", "-", "\[CapitalDelta]"}], ")"}]}]}], "}"}], 
            ",", 
            RowBox[{"MaxSteps", "\[Rule]", "100000"}]}], "]"}], "//", 
          "First"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"sec", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Theta]2", "[", "z", "]"}], "/.", "sol"}], ")"}], "/", 
            FractionBox[
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[CapitalLambda]"}], " ", "z"}], "]"}]}], 
             RowBox[{"1", "-", 
              RowBox[{"Exp", "[", 
               RowBox[{
                RowBox[{"-", "\[CapitalLambda]"}], " ", "\[Sigma]", " ", 
                "\[Xi]"}], "]"}]}]]}], ")"}], "/.", 
          RowBox[{"z", "\[Rule]", "z0"}]}]}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"var", "=", 
      RowBox[{
       FractionBox["sec", 
        SuperscriptBox["365.25", "2"]], "-", 
       SuperscriptBox[
        RowBox[{"conditionalTime", "[", 
         RowBox[{"z0", ",", "\[Sigma]", ",", "params"}], "]"}], "2"]}]}], ";",
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "var", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.711446478802761*^9, 3.7114465828170633`*^9}, {
   3.711446738841564*^9, 3.711446754720251*^9}, {3.711446813086996*^9, 
   3.71144690628032*^9}, {3.711446950281795*^9, 3.711446957173641*^9}, {
   3.711446993336164*^9, 3.711447046956019*^9}, 3.7114472068375797`*^9, {
   3.711451969649268*^9, 3.711452022357366*^9}, {3.711452256222262*^9, 
   3.711452300180933*^9}, {3.711453174625086*^9, 3.711453183174818*^9}, {
   3.711691724516521*^9, 3.7116917550179987`*^9}, {3.7116917981043873`*^9, 
   3.711691841087152*^9}, {3.711791758524539*^9, 3.711791795956662*^9}, {
   3.711791832882471*^9, 3.71179184631597*^9}, {3.711791893385562*^9, 
   3.71179194199135*^9}, {3.711791980213264*^9, 3.711791982429175*^9}, {
   3.71179206230791*^9, 3.711792076293066*^9}, {3.711797868947214*^9, 
   3.711797871207541*^9}, {3.711797992683066*^9, 3.7117980978311787`*^9}, {
   3.711798133473428*^9, 3.711798136936211*^9}, 3.711798555304923*^9, {
   3.711798599536109*^9, 3.7117986057742977`*^9}, {3.711798649531909*^9, 
   3.71179870357178*^9}, {3.711798840278583*^9, 3.7117988601097317`*^9}, {
   3.7117997785339823`*^9, 3.711799820412499*^9}, {3.711799857445311*^9, 
   3.711799863227083*^9}, 3.711801078316558*^9, {3.711801184759046*^9, 
   3.7118011875418673`*^9}, {3.711801543986307*^9, 3.7118015820914717`*^9}, 
   3.711802735430949*^9, 3.711802995694175*^9, {3.7118031064862633`*^9, 
   3.711803110825198*^9}, {3.711803145124913*^9, 3.711803145300867*^9}, {
   3.7118033282869062`*^9, 3.711803353764391*^9}, {3.7118033937330112`*^9, 
   3.711803394187455*^9}, {3.711803519943961*^9, 3.7118035203192873`*^9}, {
   3.71180355765485*^9, 3.711803558062118*^9}, {3.7118064756926928`*^9, 
   3.7118065668481092`*^9}, {3.711806621895279*^9, 3.711806752579093*^9}, {
   3.711806804063676*^9, 3.711806804246913*^9}, {3.711806953941045*^9, 
   3.7118069827051773`*^9}, {3.711807325335123*^9, 3.71180735507304*^9}, {
   3.711863849056623*^9, 3.71186384956861*^9}, {3.711864018088746*^9, 
   3.711864034290105*^9}, {3.711865004863596*^9, 3.711865005817881*^9}, {
   3.7118652527947893`*^9, 3.711865252882113*^9}, 3.711865445012985*^9, {
   3.71186580456024*^9, 3.7118658051587563`*^9}, {3.711865921834813*^9, 
   3.711865923354885*^9}, {3.7118659856665983`*^9, 3.711866002594029*^9}, {
   3.7118906077837353`*^9, 3.7118907092501287`*^9}, {3.7118907685173903`*^9, 
   3.7118908465632257`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Plotting", "Subsection",
 CellChangeTimes->{{3.695637196735448*^9, 3.695637199670351*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"chimerismErrorPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "odePrediction_", ",", "smallPrediction_", ",", "bigPrediction_"}], 
     "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"smallError_", ",", "bigError_"}], "}"}], ",", "params_", ",", 
    "label_", ",", "legend_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "myCol", ",", "mySym", ",", "mySymLegend", ",", "mySymError", ",", 
      "myTicks", ",", "myTicksError", ",", "predPlot", ",", "errorPlot", ",", 
      "plot", ",", 
      RowBox[{"imageSize", "=", "370"}]}], "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"myCol", "=", 
      RowBox[{"col", "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"mySym", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}], "\[Times]", "1.3"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mySymLegend", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}], "\[Times]", "1.0"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"mySymError", "=", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
           RowBox[{"[", 
            RowBox[{"j", ",", "1"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"sym", "/.", "myPlotStyle"}], ")"}], "[", 
            RowBox[{"[", 
             RowBox[{"j", ",", "2"}], "]"}], "]"}], "\[Times]", "2.2"}]}], 
         "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myTicks", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]], ",", "1"}], "}"}], ",", "False", ",", 
            "True", ",", "True", ",", "False"}], "]"}], ",", 
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["10", 
               RowBox[{"-", "4"}]], ",", "1"}], "}"}], ",", "False", ",", 
            "False", ",", "True", ",", "False"}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              SuperscriptBox["10", "5"]}], "}"}], ",", "False", ",", "False", 
            ",", "True", ",", "False"}], "]"}], ",", 
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              SuperscriptBox["10", "5"]}], "}"}], ",", "False", ",", "False", 
            ",", "True", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"myTicksError", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              SuperscriptBox["10", "5"]}], "}"}], ",", "False", ",", "True", 
            ",", "True", ",", "False"}], "]"}], ",", 
          RowBox[{"logTicks", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", 
              SuperscriptBox["10", "5"]}], "}"}], ",", "False", ",", "False", 
            ",", "True", ",", "False"}], "]"}]}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"predPlot", "=", 
      RowBox[{
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLogLogPlot", "[", 
          RowBox[{"smallPrediction", ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "myCol"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListLogLogPlot", "[", 
          RowBox[{"bigPrediction", ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "myCol"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"legend", "\[Equal]", "True"}], ",", "\[IndentingNewLine]", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{"odePrediction", ",", 
             RowBox[{"PlotMarkers", "\[Rule]", "mySym"}], ",", 
             RowBox[{"PlotLegends", "\[Rule]", 
              RowBox[{"Placed", "[", 
               RowBox[{
                RowBox[{"LineLegend", "[", 
                 RowBox[{
                  RowBox[{"Round", "[", 
                   RowBox[{"1440", "\[ScriptL]Vals"}], "]"}], ",", 
                  RowBox[{"LegendMarkers", "\[Rule]", "mySymLegend"}], ",", 
                  RowBox[{"LegendLabel", "\[Rule]", "\"\<\[ScriptL]\>\""}], 
                  ",", 
                  RowBox[{"LabelStyle", "\[Rule]", 
                   RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", "ticksSize", 
                    ",", 
                    RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
                  RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                   RowBox[{"{", 
                    RowBox[{"0.3", ",", "0.5"}], "}"}]}], ",", 
                  RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"0.08", ",", "0.55"}], "}"}]}], "]"}]}]}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"ListLogLogPlot", "[", 
            RowBox[{"odePrediction", ",", 
             RowBox[{"PlotMarkers", "\[Rule]", "mySym"}]}], "]"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{
           FractionBox["1", 
            RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"0", ",", "5"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "4.1"}], ",", "0"}], "}"}]}], "}"}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", "myTicks"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         
         RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.5"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"35", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", 
              RowBox[{"(*", "25", "*)"}], ",", "5"}], "}"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}], "/.", "myPlotStyle"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"predPlot", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"predPlot", ",", "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"label", ",", "labelSize", ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
            "myPlotStyle"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{"Graphics", "[", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{
              RowBox[{"\"\<\!\(\*SuperscriptBox[\(s\), \(*\)]\)=\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"sStar", "/.", 
                 RowBox[{"params", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "1"}], "]"}], "]"}]}], " ", "]"}]}], ",",
               "labelSize", ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
              RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
            "myPlotStyle"}], ",", 
           RowBox[{"Scaled", "[", 
            RowBox[{"{", 
             RowBox[{"0.5", ",", "0.91"}], "}"}], "]"}]}], "]"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"errorPlot", "=", 
      RowBox[{
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLogLinearPlot", "[", 
          RowBox[{"smallError", ",", 
           RowBox[{"PlotMarkers", "\[Rule]", "mySymError"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ListLogLinearPlot", "[", 
          RowBox[{"bigError", ",", 
           RowBox[{"PlotMarkers", "\[Rule]", "mySymError"}]}], "]"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", 
              FractionBox["5", 
               RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
            
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1.2"}], ",", "1.2"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameTicks", "\[Rule]", "myTicksError"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"None", ",", "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<\[ScriptCapitalS]\>\"", ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "imageSize"}], ",", 
         RowBox[{"AspectRatio", "\[Rule]", "0.3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"35", ",", "5"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"50", ",", "0"}], "}"}]}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}], "/.", "myPlotStyle"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"Column", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"predPlot", ",", "errorPlot"}], "}"}], ",", 
        RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695635584943802*^9, 3.6956357228344393`*^9}, {
   3.695635764832699*^9, 3.6956361993299026`*^9}, {3.695636260345348*^9, 
   3.695636344893605*^9}, {3.695636500009027*^9, 3.695636564445541*^9}, {
   3.6956367579831038`*^9, 3.6956367718388367`*^9}, {3.695636806246045*^9, 
   3.695636809389625*^9}, {3.695637065493371*^9, 3.695637122354473*^9}, {
   3.695637166379683*^9, 3.695637171110586*^9}, {3.6956372033130713`*^9, 
   3.695637204927781*^9}, {3.695637528192864*^9, 3.695637611313637*^9}, {
   3.69743809964809*^9, 3.6974382026779118`*^9}, {3.697438273529849*^9, 
   3.697438274873238*^9}, 3.697438433124753*^9, {3.697438467211342*^9, 
   3.697438468545635*^9}, {3.6974385162164297`*^9, 3.6974385486472063`*^9}, {
   3.697438605990335*^9, 3.697438626772229*^9}, {3.697438834533552*^9, 
   3.6974388669314404`*^9}, {3.697438917946267*^9, 3.697438976535549*^9}, {
   3.6974390238870697`*^9, 3.6974390473250837`*^9}, {3.69743914903461*^9, 
   3.697439174584186*^9}, {3.7087784891739283`*^9, 3.7087784895167093`*^9}, {
   3.712137308248999*^9, 3.712137334958908*^9}, {3.7121373667364597`*^9, 
   3.712137431564344*^9}, {3.712137565881351*^9, 3.71213757900772*^9}, {
   3.7121377383310213`*^9, 3.7121377384178057`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"multipleDosesPlot", "[", 
   RowBox[{
   "singleBolus_", ",", "dailyInjections_", ",", "params_", ",", "T_"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "\[ScriptCapitalS]Vals", ",", "n\[ScriptCapitalS]", ",", "myCol", ",", 
      "max", ",", "plot"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[ScriptCapitalS]Vals", "=", 
      RowBox[{"\[ScriptCapitalS]", "/.", "params"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"n\[ScriptCapitalS]", "=", 
      RowBox[{"Length", "[", "\[ScriptCapitalS]Vals", "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"myCol", "=", 
      RowBox[{"col", "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"max", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"n2", "[", "t", "]"}], "/.", 
              RowBox[{"dailyInjections", "[", 
               RowBox[{"[", "j", "]"}], "]"}]}], ")"}], "/.", 
            RowBox[{"t", "\[Rule]", "T"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", "nS"}], "}"}]}], "]"}], " ", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"max", "=", 
        RowBox[{
         RowBox[{"Ceiling", "[", 
          RowBox[{"xxx", ",", 
           SuperscriptBox["10", 
            RowBox[{"Floor", "[", 
             RowBox[{"Log10", "[", "xxx", "]"}], "]"}]]}], "]"}], "/.", 
         RowBox[{"xxx", "\[Rule]", "max"}]}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"max", "=", "2000"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{
       RowBox[{"Show", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"n2", "[", "t", "]"}], "/.", 
               RowBox[{"singleBolus", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], 
             "]"}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Directive", "[", 
               RowBox[{
                RowBox[{"myCol", "[", 
                 RowBox[{"[", "j", "]"}], "]"}], ",", 
                RowBox[{"Opacity", "[", "0.8", "]"}], ",", "Thick", ",", 
                "Dashed"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "nS"}], "}"}]}], "]"}]}]}], " ", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"n2", "[", "t", "]"}], "/.", 
               RowBox[{"dailyInjections", "[", 
                RowBox[{"[", "j", "]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], 
             "]"}], " ", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "T"}], "}"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "myCol"}], ",", 
           RowBox[{"PlotLegends", "\[Rule]", 
            RowBox[{"Placed", "[", 
             RowBox[{
              RowBox[{"LineLegend", "[", 
               RowBox[{"\[ScriptCapitalS]Vals", ",", 
                RowBox[{
                "LegendLabel", "\[Rule]", "\"\<\[ScriptCapitalS]\>\""}], ",", 
                
                RowBox[{"LabelStyle", "\[Rule]", 
                 RowBox[{"Directive", "[", 
                  RowBox[{
                   RowBox[{"labelSize", "-", "2"}], ",", 
                   RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                   RowBox[{"GrayLevel", "[", "0.4", "]"}]}], " ", "]"}]}], 
                ",", 
                RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
                RowBox[{"Spacings", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"0.5", ",", "0.3"}], "}"}]}], ",", 
                RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
              RowBox[{"Scaled", "[", 
               RowBox[{"{", 
                RowBox[{"0.16", ",", "0.65"}], "}"}], "]"}]}], " ", "]"}]}]}],
           " ", "]"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "T"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "max"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotRangePadding", "\[Rule]", "0.05"}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<\!\(\*SubscriptBox[\(n\), \(2\)]\)\>\"", ",", "labelSize",
                 ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              "None"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<Time (days)\>\"", ",", "labelSize", ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
              "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"FrameTicksStyle", "\[Rule]", 
          RowBox[{"Directive", "[", 
           RowBox[{"ticksSize", ",", 
            RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"ImageSize", "\[Rule]", "500"}], ",", "\[IndentingNewLine]", 
         
         RowBox[{"Background", "\[Rule]", "White"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ImagePadding", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"62", ",", "10"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"48", ",", "10"}], "}"}]}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"AspectRatio", "\[Rule]", "0.45"}]}], "\[IndentingNewLine]", 
        "]"}], "/.", "myPlotStyle"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.695635584943802*^9, 3.6956357228344393`*^9}, {
   3.695635764832699*^9, 3.6956361993299026`*^9}, {3.695636260345348*^9, 
   3.695636344893605*^9}, {3.695636500009027*^9, 3.695636564445541*^9}, {
   3.6956367579831038`*^9, 3.6956367718388367`*^9}, {3.695636806246045*^9, 
   3.695636809389625*^9}, {3.695637065493371*^9, 3.695637122354473*^9}, {
   3.695637166379683*^9, 3.695637171110586*^9}, {3.6956372033130713`*^9, 
   3.695637204927781*^9}, {3.695637528192864*^9, 3.695637611313637*^9}, {
   3.695641694124436*^9, 3.695641895139102*^9}, {3.695641937426342*^9, 
   3.695642093044011*^9}, {3.695642131780117*^9, 3.695642134099246*^9}, {
   3.695642511078375*^9, 3.6956425168695498`*^9}, {3.6956425981074944`*^9, 
   3.695642600465116*^9}, {3.695642722822729*^9, 3.69564275703732*^9}, {
   3.6956430044527893`*^9, 3.695643033738924*^9}, {3.695649873515527*^9, 
   3.695649898506675*^9}, {3.695649980009015*^9, 3.695650048813697*^9}, {
   3.695650080293041*^9, 3.6956500950355883`*^9}, 3.697188016824265*^9, {
   3.697190426203611*^9, 3.6971905436622143`*^9}, {3.69719057499806*^9, 
   3.69719060871544*^9}, {3.697190639435191*^9, 3.697190729247223*^9}, {
   3.708778414207077*^9, 3.708778425352054*^9}, {3.7087786477437077`*^9, 
   3.708778676525826*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"errorLogLinearPlot", "[", 
   RowBox[{"x_", ",", "\[Sigma]_", ",", "col_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", "=", "0"}], ","}], "*)"}], 
     RowBox[{"num", ",", "points", ",", "lines", ",", 
      RowBox[{"(*", 
       RowBox[{"bars", ","}], "*)"}], "plot"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"num", "=", 
      RowBox[{"Length", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"points", "=", 
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{"x", ",", 
        RowBox[{"PlotStyle", "\[Rule]", "col"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"lines", "=", 
      RowBox[{"ListLogLinearPlot", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Max", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"x", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                 RowBox[{"\[Sigma]", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
               "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"x", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"x", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
               RowBox[{"\[Sigma]", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"Directive", "[", 
          RowBox[{"col", ",", 
           RowBox[{"Thickness", "[", "0.004", "]"}]}], "]"}]}], ",", 
        RowBox[{"PlotMarkers", "\[Rule]", "None"}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"bars", "=", "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Graphics", "[", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"col", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
                    "]"}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{"Max", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "-", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}], ",", "0"}], 
                    "]"}]}], "}"}]}], "}"}], "]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"col", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "-", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "1"}], "]"}], "]"}], "+", 
                    "\[CapitalDelta]"}], ",", 
                    RowBox[{
                    RowBox[{"x", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}], "+", 
                    RowBox[{"\[Sigma]", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "2"}], "]"}], "]"}]}]}], "}"}]}], "}"}],
                 "]"}]}], "}"}]}], "\[IndentingNewLine]", "}"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "num"}], "}"}]}], "]"}]}], ";"}], 
      "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"Show", "[", 
       RowBox[{"lines", ",", 
        RowBox[{"(*", 
         RowBox[{"bars", ","}], "*)"}], "points"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Return", "[", "plot", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.690366361098097*^9, 3.6903663756568403`*^9}, {
  3.690447167338378*^9, 3.6904471748094587`*^9}, {3.690447221464448*^9, 
  3.6904472746779003`*^9}, {3.695586111033328*^9, 3.695586111687381*^9}, {
  3.695587121470046*^9, 3.695587133028921*^9}, {3.695647904841099*^9, 
  3.6956479049760723`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Initial chimerism", "Section",
 CellChangeTimes->{{3.69562883542819*^9, 3.695628853898645*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Initiate", " ", "variable", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalS]Vals", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       SuperscriptBox["10", "i"], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "5", ",", 
         RowBox[{"1", "/", "3"}]}], "}"}]}], "]"}]}], ";"}], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"This", " ", "is", " ", "my", " ", "x"}], "-", 
      RowBox[{"axis", " ", "variable"}]}], ";", " ", 
     RowBox[{"dose", " ", "size"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[ScriptCapitalS]", "=", 
     RowBox[{"Length", "[", "\[ScriptCapitalS]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sStarVals", "=", 
     RowBox[{"{", 
      RowBox[{"10", ",", "100"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nS", "=", 
     RowBox[{"Length", "[", "sStarVals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[ScriptL]Vals", "=", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1.", ",", "3.", ",", "5."}], "}"}], "/", "1440."}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[ScriptL]", "=", 
     RowBox[{"Length", "[", "\[ScriptL]Vals", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.66943964751322*^9, 3.6694396514805317`*^9}, 
   3.669439847641354*^9, {3.669439992263359*^9, 3.669439999955433*^9}, {
   3.669440162399632*^9, 3.669440172741529*^9}, {3.674208175029993*^9, 
   3.674208220875812*^9}, {3.674208266098268*^9, 3.674208267178605*^9}, {
   3.6742108716311207`*^9, 3.6742108720867043`*^9}, {3.6742110277458878`*^9, 
   3.674211028008944*^9}, {3.674212121090599*^9, 3.674212127594264*^9}, 
   3.674217117763854*^9, {3.674217180273593*^9, 3.67421718041737*^9}, {
   3.674218410711248*^9, 3.67421841101504*^9}, {3.6742190236098137`*^9, 
   3.674219023761669*^9}, {3.674283247712076*^9, 3.674283261333963*^9}, {
   3.674455950753701*^9, 3.6744559763119383`*^9}, {3.674456014750391*^9, 
   3.6744562628533983`*^9}, {3.67445629505224*^9, 3.6744563017236967`*^9}, {
   3.674456336122589*^9, 3.674456339674346*^9}, {3.674456429071156*^9, 
   3.674456454222973*^9}, {3.674456523891376*^9, 3.67445653685096*^9}, {
   3.674456678669916*^9, 3.674456682445689*^9}, {3.674456951284562*^9, 
   3.67445704269633*^9}, {3.674457118070134*^9, 3.674457120925658*^9}, {
   3.674539185364085*^9, 3.674539190835717*^9}, {3.6745425716339703`*^9, 
   3.6745426156630993`*^9}, {3.674553291911993*^9, 3.674553300474324*^9}, {
   3.674558740497957*^9, 3.674558741553314*^9}, {3.674558798784425*^9, 
   3.6745588029990797`*^9}, {3.67455938630066*^9, 3.674559404890956*^9}, {
   3.674559480368915*^9, 3.6745595606934767`*^9}, 3.674560589421112*^9, {
   3.676806399474284*^9, 3.676806402386016*^9}, {3.676870793384409*^9, 
   3.676870794358759*^9}, {3.676876700187416*^9, 3.676876709458165*^9}, {
   3.676876893844109*^9, 3.676876893999548*^9}, {3.676876947794217*^9, 
   3.676876994216501*^9}, {3.6768774986800547`*^9, 3.676877508966935*^9}, {
   3.6768778378045893`*^9, 3.676877860683572*^9}, {3.676878604076097*^9, 
   3.6768786045391417`*^9}, {3.676878729543819*^9, 3.676878729735158*^9}, {
   3.676878831732307*^9, 3.676878834243351*^9}, {3.676879026277813*^9, 
   3.676879037012596*^9}, {3.67688653881102*^9, 3.6768865786524467`*^9}, {
   3.6768893906190367`*^9, 3.6768893909379683`*^9}, {3.695634375904544*^9, 
   3.695634496699642*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"paramsFunc", "[", 
    RowBox[{
    "\[Section]sStar_", ",", "\[Section]\[ScriptL]_", ",", 
     "\[Section]\[ScriptCapitalS]_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
     RowBox[{"sStar", "\[Rule]", "\[Section]sStar"}], ",", 
     RowBox[{"nStar", "\[Rule]", "9900"}], ",", 
     RowBox[{"\[Beta]", "\[Rule]", 
      RowBox[{"1.", "/", "39"}]}], ",", 
     RowBox[{"\[ScriptCapitalS]", "\[Rule]", "\[Section]\[ScriptCapitalS]"}], 
     ",", 
     RowBox[{"\[ScriptL]", "\[Rule]", "\[Section]\[ScriptL]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paramsTab", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"paramsFunc", "[", 
          RowBox[{
           RowBox[{"sStarVals", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"\[ScriptL]Vals", "[", 
            RowBox[{"[", "j", "]"}], "]"}], ",", 
           RowBox[{"\[ScriptCapitalS]Vals", "[", 
            RowBox[{"[", "k", "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.695634510568836*^9, 3.695634541154533*^9}, {
  3.695634577577249*^9, 3.695634614103479*^9}, {3.695634659181904*^9, 
  3.695634749420123*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Get", " ", "chimerism", " ", "predictions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"endSmall", "=", 
     RowBox[{"Ceiling", "[", 
      FractionBox[
       RowBox[{"n\[ScriptCapitalS]", "+", "4"}], "2"], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"startBig", "=", 
     RowBox[{
      RowBox[{"Floor", "[", 
       FractionBox[
        RowBox[{"n\[ScriptCapitalS]", "-", "4"}], "2"], "]"}], "+", "2"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"odePrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[ScriptCapitalS]", "/.", 
              RowBox[{"paramsTab", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
             RowBox[{"predictionODEs", "[", 
              RowBox[{"paramsTab", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], " ", "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"smallPrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[ScriptCapitalS]", "/.", 
              RowBox[{"paramsTab", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
             RowBox[{"predictionSmall", "[", 
              RowBox[{"paramsTab", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], " ", "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "1", ",", "endSmall"}], "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"bigPrediction", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[ScriptCapitalS]", "/.", 
              RowBox[{"paramsTab", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
             RowBox[{"predictionBig", "[", 
              RowBox[{"paramsTab", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}], " ", "]"}]}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"k", ",", "startBig", ",", "n\[ScriptCapitalS]"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.695634864045732*^9, 3.695634955979884*^9}, {
  3.6956350784885283`*^9, 3.695635102358897*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Calculate", " ", "errors"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{"smallError", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[ScriptCapitalS]", "/.", 
             RowBox[{"paramsTab", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
            FractionBox[
             RowBox[{
              RowBox[{"smallPrediction", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}], 
              "-", 
              RowBox[{"odePrediction", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}]}], 
             RowBox[{"odePrediction", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}]]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "endSmall"}], "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";", 
   RowBox[{"bigError", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"\[ScriptCapitalS]", "/.", 
             RowBox[{"paramsTab", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k"}], "]"}], "]"}]}], ",", 
            FractionBox[
             RowBox[{
              RowBox[{"bigPrediction", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", 
                 RowBox[{"k", "-", "startBig", "+", "1"}], ",", "2"}], "]"}], 
               "]"}], "-", 
              RowBox[{"odePrediction", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}]}], 
             RowBox[{"odePrediction", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j", ",", "k", ",", "2"}], "]"}], "]"}]]}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "startBig", ",", "n\[ScriptCapitalS]"}], "}"}]}],
          "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n\[ScriptL]"}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "nS"}], "}"}]}], "]"}]}], ";"}]}]], "Input",\

 CellChangeTimes->{{3.695635105813393*^9, 3.695635274378457*^9}, {
  3.695635318087946*^9, 3.695635320912285*^9}, {3.695636651314416*^9, 
  3.695636679385825*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"plot10", "=", 
   RowBox[{"chimerismErrorPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"odePrediction", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"smallPrediction", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"bigPrediction", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"smallError", "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"bigError", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"paramsTab", "[", 
      RowBox[{"[", "1", "]"}], "]"}], ",", "\"\<(a)\>\"", ",", "False"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot100", "=", 
   RowBox[{"chimerismErrorPlot", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"odePrediction", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"smallPrediction", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"bigPrediction", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"smallError", "[", 
        RowBox[{"[", "2", "]"}], "]"}], ",", 
       RowBox[{"bigError", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"paramsTab", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", "\"\<(b)\>\"", ",", "True"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.697438702096142*^9, 3.697438770335123*^9}, {
  3.69743887761078*^9, 3.6974388900575953`*^9}, {3.697439004794012*^9, 
  3.697439012868744*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Plot", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Row", "[", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"Graphics", "[", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Rotate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{
               "\"\<       Error         Chimerism\>\"", ",", "labelSize", 
                ",", 
                RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}], "/.", 
              "myPlotStyle"}], ",", 
             RowBox[{"90", "Degree"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"24", ",", "250"}], "}"}]}]}], "]"}], ",", 
      "\[IndentingNewLine]", "plot10", ",", "\[IndentingNewLine]", 
      "plot100"}], "\[IndentingNewLine]", "}"}], ",", "\"\< \>\""}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6956353898040133`*^9, 3.695635391108832*^9}, {
  3.695637216926571*^9, 3.6956374586796103`*^9}, {3.697438350174739*^9, 
  3.6974383917637167`*^9}, {3.697438690521309*^9, 3.6974386954724207`*^9}, {
  3.712137531215611*^9, 3.712137550007011*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Multiple doses", "Section",
 CellChangeTimes->{{3.69562883542819*^9, 3.695628863370356*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Parameters", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[ScriptCapitalS]Vals", "=", 
     RowBox[{"{", 
      RowBox[{"98", ",", "980", ",", "2100"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[ScriptCapitalS]", "=", 
     RowBox[{"Length", "[", "\[ScriptCapitalS]Vals", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"T", "=", "7"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"paramsFunc", "[", "\[Section]\[ScriptCapitalS]_", "]"}], ":=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[ScriptCapitalN]", "\[Rule]", "10000"}], ",", 
       RowBox[{"sStar", "\[Rule]", "100"}], ",", 
       RowBox[{"nStar", "\[Rule]", "9900"}], ",", 
       RowBox[{"\[Beta]", "\[Rule]", 
        RowBox[{"1.", "/", "39"}]}], ",", 
       RowBox[{
       "\[ScriptCapitalS]", "\[Rule]", "\[Section]\[ScriptCapitalS]"}], ",", 
       RowBox[{"\[ScriptL]", "\[Rule]", 
        FractionBox["3.", "1440."]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"paramsTab", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"paramsFunc", "[", 
        RowBox[{"\[ScriptCapitalS]Vals", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.680345358963711*^9, 3.680345382769651*^9}, {
  3.695641388820779*^9, 3.695641527344095*^9}, {3.6971842067982893`*^9, 
  3.697184208989574*^9}, {3.69718783626124*^9, 3.69718783786124*^9}, {
  3.6971878879728203`*^9, 3.697187900068165*^9}, {3.697187955986149*^9, 
  3.697187992255554*^9}, {3.697188089973454*^9, 3.697188104283491*^9}, {
  3.6971903459499702`*^9, 3.69719036701161*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Integrate", " ", "ODEs"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"singleBolus", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"solveODEs", "[", 
        RowBox[{
         RowBox[{"paramsTab", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "T"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dailyInjections", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"solveODEsDaily", "[", 
        RowBox[{
         RowBox[{"paramsTab", "[", 
          RowBox[{"[", "i", "]"}], "]"}], ",", "T"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6732499658108273`*^9, 3.6732499683592863`*^9}, {
   3.673250084804002*^9, 3.673250084907091*^9}, {3.673341789613435*^9, 
   3.673341799492607*^9}, {3.673341831788179*^9, 3.673341837452153*^9}, {
   3.673341870258779*^9, 3.673341878249826*^9}, {3.673342722341752*^9, 
   3.6733427229409323`*^9}, {3.6733427827796173`*^9, 3.673342793338644*^9}, {
   3.673345107507531*^9, 3.673345108211273*^9}, {3.673346722548781*^9, 
   3.6733467421235867`*^9}, {3.673346875239542*^9, 3.673346888006205*^9}, {
   3.67334977665301*^9, 3.6733497789481487`*^9}, {3.674808420527636*^9, 
   3.674808565498363*^9}, 3.674808618767869*^9, {3.67480869135061*^9, 
   3.674808700660866*^9}, {3.674816951423004*^9, 3.674816982933651*^9}, {
   3.674817997523066*^9, 3.674817997923045*^9}, {3.674819138036454*^9, 
   3.674819138692041*^9}, {3.674821220244605*^9, 3.674821220420341*^9}, {
   3.674882788203287*^9, 3.674882788651187*^9}, 3.680342411503083*^9, {
   3.6803426687895317`*^9, 3.68034276385843*^9}, {3.6803432335544567`*^9, 
   3.6803432338345137`*^9}, 3.680343840454997*^9, 3.680343951987183*^9, {
   3.680345059069639*^9, 3.680345076748152*^9}, {3.680345143889968*^9, 
   3.680345233750801*^9}, {3.68034531463721*^9, 3.680345336275508*^9}, {
   3.680345373562297*^9, 3.6803453752506523`*^9}, {3.680345414905713*^9, 
   3.680345483022585*^9}, {3.6956414269230213`*^9, 3.695641427250885*^9}, {
   3.6956415536873198`*^9, 3.695641642775325*^9}, {3.695642285900653*^9, 
   3.6956422888601933`*^9}, {3.69564235950601*^9, 3.695642364457718*^9}, {
   3.697187910035021*^9, 3.697187919483053*^9}, {3.697190356221714*^9, 
   3.6971903817311983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Plot", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"multipleDosesPlot", "[", 
   RowBox[{
   "singleBolus", ",", "dailyInjections", ",", "paramsTab", ",", "T"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6803444318427258`*^9, 3.680344497887985*^9}, {
  3.6803452653340282`*^9, 3.680345300972825*^9}, {3.680345490991351*^9, 
  3.680345492942319*^9}, {3.6803455383257113`*^9, 3.680345545172678*^9}, {
  3.680345800812788*^9, 3.680346009612834*^9}, {3.6803460488278847`*^9, 
  3.680346097354312*^9}, {3.680346169921135*^9, 3.680346171073792*^9}, {
  3.6803463524217987`*^9, 3.680346352585268*^9}, {3.680346388272605*^9, 
  3.680346482957809*^9}, {3.680346557339517*^9, 3.680346684526713*^9}, {
  3.681714410141137*^9, 3.681714467802415*^9}, {3.695642102423296*^9, 
  3.695642124410626*^9}, {3.695642535316428*^9, 3.6956425786506367`*^9}, {
  3.695650037421386*^9, 3.69565003778876*^9}, {3.697184216397244*^9, 
  3.697184217453174*^9}, {3.697190385052062*^9, 3.697190397962655*^9}, {
  3.697190500752034*^9, 3.697190500902856*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Takeover probability and time", "Section",
 CellChangeTimes->{{3.69562883542819*^9, 3.69562883629123*^9}, {
  3.695628876674883*^9, 3.695628888945437*^9}}],

Cell[CellGroupData[{

Cell["Analyse Data", "Subsection",
 CellChangeTimes->{{3.6956431124797707`*^9, 3.695643116614811*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Load", " ", "parameters", " ", "and", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "@", 
     RowBox[{"NotebookDirectory", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"dirs", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<./zz-data/non-preconditioned/fixation-epsilon_01/\>\"", ",", 
       "\"\<./zz-data/non-preconditioned/fixation-epsilon_05/\>\""}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Epsilon]", "=", 
     RowBox[{"Length", "[", "dirs", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"params", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getPars", "[", 
        RowBox[{"dirs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[ScriptCapitalS]", "=", 
     RowBox[{"Length", "[", 
      RowBox[{"params", "[", 
       RowBox[{"[", "1", "]"}], "]"}], " ", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"extractFixationStats", "[", 
        RowBox[{"dirs", "[", 
         RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataProb", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataTime", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "4"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dataTimeSigma", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"data", "[", 
        RowBox[{"[", 
         RowBox[{"i", ",", "5"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.695644043191058*^9, 3.6956443046310453`*^9}, {
  3.695644362844009*^9, 3.6956444054263067`*^9}, {3.695644796997649*^9, 
  3.6956448107476397`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Analytic predictions", "Subsection",
 CellChangeTimes->{{3.695644597475623*^9, 3.6956446014187098`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[ScriptCapitalS]Vals", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     SuperscriptBox["2", "j"], ",", 
     RowBox[{"{", 
      RowBox[{"j", ",", "0", ",", "13", ",", "0.1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n\[ScriptCapitalS]", "=", 
   RowBox[{"Length", "[", "\[ScriptCapitalS]Vals", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"moreParams", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"Append", "[", 
         RowBox[{
          RowBox[{"Drop", "[", 
           RowBox[{
            RowBox[{"params", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "1"}], "]"}], "]"}], ",", 
            RowBox[{"{", "5", "}"}]}], "]"}], ",", 
          RowBox[{"\[ScriptCapitalS]", "\[Rule]", 
           RowBox[{"\[ScriptCapitalS]Vals", "[", 
            RowBox[{"[", "j", "]"}], "]"}]}]}], " ", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"z0", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"getZ0", "[", 
        RowBox[{"moreParams", "[", 
         RowBox[{"[", 
          RowBox[{"i", ",", "j"}], "]"}], "]"}], " ", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"analyticProb", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"\[ScriptCapitalS]", "/.", 
          RowBox[{"moreParams", "[", 
           RowBox[{"[", 
            RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
         RowBox[{"conditionalProb", "[", 
          RowBox[{
           RowBox[{"z0", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "1", ",", 
           RowBox[{"moreParams", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"analyticTime", "=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\[ScriptCapitalS]", "/.", 
           RowBox[{"moreParams", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
          RowBox[{"conditionalTime", "[", 
           RowBox[{
            RowBox[{"z0", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "1", ",", 
            RowBox[{"moreParams", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\n", 
  RowBox[{"(*", 
   RowBox[{
   "Calculate", " ", "variance", " ", "and", " ", "export", " ", "for", " ", 
    "speed"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Comment", " ", "out", " ", "to", " ", "avoid", " ", "costly", " ", 
    "recalculations"}], "*)"}], "\n", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"analyticVariance", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[ScriptCapitalS]", "/.", 
            RowBox[{"moreParams", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "j"}], "]"}], "]"}]}], ",", 
           RowBox[{"conditionalTime", "[", 
            RowBox[{
             RowBox[{"z0", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "1", ",", 
             RowBox[{"moreParams", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}], ",", 
           RowBox[{"variance", "[", 
            RowBox[{
             RowBox[{"z0", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}], ",", "1", ",", 
             RowBox[{"moreParams", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "j"}], "]"}], "]"}]}], " ", "]"}]}], "}"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "1", ",", "n\[ScriptCapitalS]"}], "}"}]}], "]"}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}]}], ";", 
    "\n", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Export", "[", 
        RowBox[{
         RowBox[{"\"\<zz-data/non-preconditioned/variance\>\"", "<>", 
          RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], ",", 
         RowBox[{"analyticVariance", "[", 
          RowBox[{"[", "#", "]"}], "]"}]}], " ", "]"}], "&"}], ",", 
      RowBox[{"Range", "[", "n\[Epsilon]", "]"}]}], " ", "]"}], ";"}], "*)"}],
   "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"analyticVariance", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"\"\<zz-data/non-preconditioned/variance\>\"", "<>", 
        RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.dat\>\""}], "]"}], 
      "&"}], ",", 
     RowBox[{"Range", "[", "n\[Epsilon]", "]"}]}], " ", "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.695645372343162*^9, 3.695645374488001*^9}, {
  3.69564540584706*^9, 3.695645654006577*^9}, {3.711891321714459*^9, 
  3.711891356849168*^9}, {3.711891402967866*^9, 3.711891430418747*^9}, {
  3.711943514430292*^9, 3.711943520029291*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot fixation probability", "Subsection",
 CellChangeTimes->{{3.6956431124797707`*^9, 3.695643132014201*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"probPlot", "=", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"ListLogLinearPlot", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"dataProb", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
         
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"myCol", "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;", "3"}], "]"}], "]"}]}]}], " ", "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLogLinearPlot", "[", 
        RowBox[{"analyticProb", ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"myCol", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "Line"}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"myCol", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "Dashed"}], "]"}]}], 
           "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"PlotLegends", "\[Rule]", 
          RowBox[{"Placed", "[", 
           RowBox[{
            RowBox[{"LineLegend", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "+", "\[Epsilon]"}], ")"}], "/.", 
                 RowBox[{"params", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"LegendMarkerSize", "\[Rule]", "20"}], ",", 
              RowBox[{
              "LegendLabel", "\[Rule]", 
               "\"\<\!\(\*SubscriptBox[\(\[Beta]\), \(2\)]\)/\[Beta]\>\""}], 
              ",", 
              RowBox[{"LabelStyle", "\[Rule]", 
               RowBox[{"Directive", "[", 
                RowBox[{"18", ",", 
                 RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
                 RowBox[{"GrayLevel", "[", "0.4", "]"}]}], "]"}]}], ",", 
              RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
              RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], ",", 
            RowBox[{"Scaled", "[", 
             RowBox[{"{", 
              RowBox[{"0.85", ",", "0.32"}], "}"}], "]"}]}], "]"}]}]}], "]"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["0", 
             RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
            FractionBox["4", 
             RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.04"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"AxesOrigin", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Fixation prob.\>\"", ",", "labelSize", ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
            "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"None", 
            RowBox[{"(*", 
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\[ScriptCapitalS]\>\"", ",", "labelSize", ",", 
               RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], "*)"}], 
            ",", "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"ticksSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logTicks", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                SuperscriptBox["10", "4"]}], "}"}], ",", "False", ",", 
              "False", ",", "True", ",", "False"}], "]"}], ",", 
            RowBox[{"logTicks", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                SuperscriptBox["10", "4"]}], "}"}], ",", "False", ",", 
              "False", ",", "True", ",", "False"}], "]"}]}], "}"}]}], "}"}]}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"55", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"55", "-", "50"}], ",", "5"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "350"}]}], "\[IndentingNewLine]", 
      "]"}], "/.", "myPlotStyle"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"topPlot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"probPlot", ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(a)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
        "myPlotStyle"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}]}], " ", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6956435284575872`*^9, 3.69564355035301*^9}, {
   3.695643620255426*^9, 3.695643622534618*^9}, {3.695643655709548*^9, 
   3.695643658716462*^9}, {3.695644532114214*^9, 3.69564457688454*^9}, {
   3.695645035854596*^9, 3.695645092698497*^9}, {3.695645845584257*^9, 
   3.695645847432308*^9}, {3.6956477728937073`*^9, 3.695647798563848*^9}, {
   3.695647946903921*^9, 3.695647956302288*^9}, {3.695647997340979*^9, 
   3.695648010796574*^9}, {3.697439238934229*^9, 3.697439250747945*^9}, {
   3.6974393498344793`*^9, 3.697439370712195*^9}, {3.7087790245471077`*^9, 
   3.708779036601678*^9}, 3.708931541689528*^9, {3.712137862149754*^9, 
   3.7121378920677643`*^9}, {3.7121379453000517`*^9, 3.7121379592658463`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Plot fixation time", "Subsection",
 CellChangeTimes->{{3.6956431124797707`*^9, 3.695643142933926*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"myCol", "=", 
   RowBox[{"col", "/.", "myPlotStyle"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"timePlot", "=", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"errorLogLinearPlot", "[", 
          RowBox[{
           RowBox[{"dataTime", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"dataTimeSigma", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{"myCol", "[", 
            RowBox[{"[", 
             RowBox[{"i", "+", "1"}], "]"}], "]"}]}], " ", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ListLogLinearPlot", "[", 
        RowBox[{"analyticTime", ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"myCol", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", "Line"}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"myCol", "[", 
               RowBox[{"[", "3", "]"}], "]"}], ",", "Dashed"}], "]"}]}], 
           "}"}]}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ListLogLinearPlot", "[", 
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"analyticVariance", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"analyticVariance", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "-", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"analyticVariance", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], " ", 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"analyticVariance", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"analyticVariance", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "j", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"analyticVariance", "[", 
                   RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "2"}], "]"}], "]"}], "+", 
                  RowBox[{"Sqrt", "[", 
                   RowBox[{"analyticVariance", "[", 
                    RowBox[{"[", 
                    RowBox[{"i", ",", "j", ",", "3"}], "]"}], "]"}], " ", 
                   "]"}]}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", 
                 RowBox[{"Length", "[", 
                  RowBox[{"analyticVariance", "[", 
                   RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], "}"}]}], 
              "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
           RowBox[{"Joined", "\[Rule]", "True"}], ",", 
           RowBox[{"PlotStyle", "\[Rule]", "None"}], ",", 
           RowBox[{"Filling", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"1", "\[Rule]", 
              RowBox[{"{", "2", "}"}]}], "}"}]}], ",", 
           RowBox[{"FillingStyle", "\[Rule]", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"myCol", "[", 
               RowBox[{"[", 
                RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", 
              RowBox[{"Opacity", "[", "0.2", "]"}]}], " ", "]"}]}]}], " ", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n\[Epsilon]"}], "}"}]}], "]"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"PlotRange", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            FractionBox["0", 
             RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]], ",", 
            FractionBox["4", 
             RowBox[{"Log10", "[", "\[ExponentialE]", "]"}]]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "20"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", "0.2"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AxesOrigin", "\[Rule]", "Automatic"}], ",", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Mean time (years)\>\"", ",", "labelSize", ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
            "None"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<\[ScriptCapitalS]\>\"", ",", "labelSize", ",", 
              RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}], ",", 
            "None"}], "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"Directive", "[", 
         RowBox[{"ticksSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Automatic", ",", "Automatic"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"logTicks", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                SuperscriptBox["10", "4"]}], "}"}], ",", "False", ",", "True",
               ",", "True", ",", "False"}], "]"}], ",", 
            RowBox[{"logTicks", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"1", ",", 
                SuperscriptBox["10", "4"]}], "}"}], ",", "False", ",", 
              "False", ",", "True", ",", "False"}], "]"}]}], "}"}]}], "}"}]}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"55", ",", "5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"55", ",", "10"}], "}"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", "350"}]}], "\[IndentingNewLine]", 
      "]"}], "/.", "myPlotStyle"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"bottomPlot", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"timePlot", ",", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Text", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{"\"\<(b)\>\"", ",", "labelSize", ",", 
          RowBox[{"FontFamily", "\[Rule]", "font"}], ",", 
          RowBox[{"GrayLevel", "[", "0.4", "]"}], ",", 
          RowBox[{"Background", "\[Rule]", "White"}]}], "]"}], "/.", 
        "myPlotStyle"}], ",", 
       RowBox[{"Scaled", "[", 
        RowBox[{"{", 
         RowBox[{"0.05", ",", "0.93"}], "}"}], "]"}]}], "]"}], "]"}]}], " ", 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6956435830956707`*^9, 3.6956435927430897`*^9}, {
   3.695643628647173*^9, 3.695643630757846*^9}, {3.695643664708112*^9, 
   3.695643666339884*^9}, {3.695645685703353*^9, 3.695645687341786*^9}, {
   3.6956457619720793`*^9, 3.695645790753974*^9}, {3.69564583523466*^9, 
   3.69564586322375*^9}, {3.6956479584383707`*^9, 3.695647958797926*^9}, {
   3.69743926331662*^9, 3.6974392795799017`*^9}, {3.697439326642825*^9, 
   3.697439338361598*^9}, {3.7087790455837717`*^9, 3.708779076911734*^9}, {
   3.71189145697313*^9, 3.711891482462447*^9}, {3.711891531603737*^9, 
   3.711891570322844*^9}, {3.711891684621498*^9, 3.711891826586018*^9}, {
   3.711891923270297*^9, 3.711891929420957*^9}, 3.7121379067413273`*^9, 
   3.7121380118488903`*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Combine plots", "Subsection",
 CellChangeTimes->{{3.6956431124797707`*^9, 3.695643146509563*^9}}],

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"topPlot", ",", "bottomPlot"}], "}"}], ",", 
   RowBox[{"Spacings", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.695643241061028*^9, 3.6956432541379137`*^9}, 
   3.69564771352711*^9, {3.6956480225473967`*^9, 3.695648024548044*^9}, {
   3.6974392999150333`*^9, 3.697439304033905*^9}, {3.7087790623286247`*^9, 
   3.708779083126586*^9}, {3.711943497390964*^9, 3.711943498453774*^9}}]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1737, 1330},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (October 9, \
2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 158, 2, 92, "Title"],
Cell[741, 26, 141, 1, 51, "Subtitle"],
Cell[885, 29, 134, 1, 29, "Subsubtitle"],
Cell[1022, 32, 271, 9, 10, "Text"],
Cell[CellGroupData[{
Cell[1318, 45, 122, 1, 35, "Subsubsection"],
Cell[1443, 48, 549, 15, 46, "Input"],
Cell[1995, 65, 18467, 424, 1405, "Input"],
Cell[20465, 491, 271, 9, 10, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[20773, 505, 442, 7, 54, "Chapter"],
Cell[CellGroupData[{
Cell[21240, 516, 155, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[21420, 522, 111, 1, 35, "Subsubsection"],
Cell[21534, 525, 1955, 54, 69, "Input"],
Cell[23492, 581, 127, 2, 28, "Input"],
Cell[23622, 585, 104, 2, 28, "Input"],
Cell[23729, 589, 128, 2, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[23894, 596, 112, 1, 29, "Subsubsection"],
Cell[24009, 599, 1954, 54, 69, "Input"],
Cell[25966, 655, 131, 2, 28, "Input"],
Cell[26100, 659, 108, 2, 28, "Input"],
Cell[26211, 663, 131, 2, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[26379, 670, 95, 1, 29, "Subsubsection"],
Cell[26477, 673, 1928, 52, 69, "Input"],
Cell[28408, 727, 126, 2, 28, "Input"],
Cell[28537, 731, 103, 2, 28, "Input"],
Cell[28643, 735, 130, 2, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[28822, 743, 304, 8, 37, "Subsection"],
Cell[CellGroupData[{
Cell[29151, 755, 183, 2, 35, "Subsubsection"],
Cell[29337, 759, 2727, 73, 69, "Input"],
Cell[32067, 834, 313, 9, 35, "Input"],
Cell[32383, 845, 210, 4, 28, "Input"],
Cell[32596, 851, 163, 3, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[32808, 860, 622, 17, 43, "Subsection"],
Cell[CellGroupData[{
Cell[33455, 881, 127, 1, 35, "Subsubsection"],
Cell[33585, 884, 1884, 51, 59, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[35506, 940, 111, 1, 29, "Subsubsection"],
Cell[35620, 943, 3172, 83, 69, "Input"],
Cell[38795, 1028, 313, 9, 35, "Input"],
Cell[39111, 1039, 210, 4, 28, "Input"],
Cell[39324, 1045, 163, 3, 28, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[39536, 1054, 987, 29, 44, "Subsection"],
Cell[CellGroupData[{
Cell[40548, 1087, 127, 1, 35, "Subsubsection"],
Cell[40678, 1090, 1674, 45, 59, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[42389, 1140, 111, 1, 29, "Subsubsection"],
Cell[42503, 1143, 3070, 79, 69, "Input"],
Cell[45576, 1224, 313, 9, 35, "Input"],
Cell[45892, 1235, 210, 4, 28, "Input"],
Cell[46105, 1241, 163, 3, 28, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[46329, 1251, 254, 4, 54, "Chapter"],
Cell[CellGroupData[{
Cell[46608, 1259, 202, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[46835, 1266, 161, 2, 44, "Subsection"],
Cell[46999, 1270, 713, 24, 43, "Text"],
Cell[47715, 1296, 1411, 43, 114, "Input"],
Cell[49129, 1341, 235, 5, 30, "Text"],
Cell[49367, 1348, 1260, 36, 87, "Input"],
Cell[50630, 1386, 220, 6, 31, "Text"],
Cell[50853, 1394, 603, 15, 28, "Input"],
Cell[51459, 1411, 591, 15, 28, "Input"],
Cell[52053, 1428, 607, 15, 28, "Input"],
Cell[52663, 1445, 489, 12, 31, "Text"],
Cell[53155, 1459, 815, 23, 111, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[54007, 1487, 104, 1, 36, "Subsection"],
Cell[54114, 1490, 320, 6, 49, "Text"],
Cell[54437, 1498, 2586, 76, 114, "Input"],
Cell[57026, 1576, 393, 8, 46, "Input"],
Cell[57422, 1586, 326, 6, 30, "Text"],
Cell[57751, 1594, 250, 6, 28, "Input"],
Cell[58004, 1602, 135, 1, 30, "Text"],
Cell[58142, 1605, 980, 26, 54, "Input"],
Cell[59125, 1633, 312, 8, 46, "Input"],
Cell[59440, 1643, 412, 11, 32, "Text"],
Cell[59855, 1656, 1405, 44, 102, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[61297, 1705, 120, 1, 36, "Subsection"],
Cell[61420, 1708, 310, 6, 30, "Text"],
Cell[61733, 1716, 424, 10, 28, "Input"],
Cell[62160, 1728, 900, 23, 46, "Input"],
Cell[63063, 1753, 1393, 33, 67, "Input"],
Cell[64459, 1788, 2103, 52, 106, "Input"],
Cell[66565, 1842, 2614, 64, 133, "Input"],
Cell[69182, 1908, 1259, 37, 73, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[70478, 1950, 206, 3, 36, "Subsection"],
Cell[70687, 1955, 223, 4, 30, "Text"],
Cell[70913, 1961, 493, 12, 28, "Input"],
Cell[71409, 1975, 1437, 32, 46, "Input"],
Cell[72849, 2009, 1910, 41, 67, "Input"],
Cell[74762, 2052, 2379, 57, 106, "Input"],
Cell[77144, 2111, 1270, 34, 68, "Input"],
Cell[78417, 2147, 2797, 71, 108, "Input"],
Cell[CellGroupData[{
Cell[81239, 2222, 136, 1, 35, "Subsubsection"],
Cell[81378, 2225, 123, 2, 28, "Input"],
Cell[81504, 2229, 2301, 65, 90, "Input"],
Cell[83808, 2296, 255, 5, 28, "Input"],
Cell[84066, 2303, 339, 8, 28, "Input"],
Cell[84408, 2313, 1333, 37, 61, "Input"],
Cell[85744, 2352, 223, 4, 28, "Input"],
Cell[85970, 2358, 2219, 58, 103, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[88250, 2423, 152, 2, 50, "Section"],
Cell[CellGroupData[{
Cell[88427, 2429, 230, 3, 44, "Subsection"],
Cell[88660, 2434, 647, 22, 43, "Text"],
Cell[89310, 2458, 1464, 43, 114, "Input"],
Cell[90777, 2503, 235, 5, 30, "Text"],
Cell[91015, 2510, 1413, 38, 87, "Input"],
Cell[92431, 2550, 313, 8, 31, "Text"],
Cell[92747, 2560, 649, 15, 28, "Input"],
Cell[93399, 2577, 645, 15, 28, "Input"],
Cell[94047, 2594, 663, 16, 28, "Input"],
Cell[94713, 2612, 199, 4, 30, "Text"],
Cell[94915, 2618, 1154, 34, 51, "Input"],
Cell[96072, 2654, 624, 17, 51, "Input"],
Cell[96699, 2673, 337, 7, 49, "Text"],
Cell[97039, 2682, 7843, 225, 502, "Input"],
Cell[104885, 2909, 399, 7, 46, "Input"],
Cell[105287, 2918, 505, 14, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[105829, 2937, 100, 1, 36, "Subsection"],
Cell[105932, 2940, 330, 6, 30, "Text"],
Cell[106265, 2948, 995, 29, 28, "Input"],
Cell[107263, 2979, 298, 7, 28, "Input"],
Cell[107564, 2988, 443, 12, 32, "Text"],
Cell[108010, 3002, 1619, 42, 54, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[109666, 3049, 129, 2, 36, "Subsection"],
Cell[109798, 3053, 530, 18, 31, "Text"],
Cell[110331, 3073, 1310, 35, 70, "Input"],
Cell[CellGroupData[{
Cell[111666, 3112, 114, 1, 35, "Subsubsection"],
Cell[111783, 3115, 6947, 174, 454, "Input"],
Cell[118733, 3291, 27282, 618, 881, "Input"],
Cell[146018, 3911, 3788, 89, 238, "Input"],
Cell[149809, 4002, 686, 14, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[150544, 4022, 104, 1, 36, "Subsection"],
Cell[150651, 4025, 260, 5, 30, "Text"],
Cell[150914, 4032, 1065, 32, 54, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[152016, 4069, 120, 1, 36, "Subsection"],
Cell[152139, 4072, 636, 15, 50, "Text"],
Cell[152778, 4089, 523, 11, 28, "Input"],
Cell[153304, 4102, 1535, 35, 46, "Input"],
Cell[154842, 4139, 1937, 43, 67, "Input"],
Cell[156782, 4184, 3688, 97, 152, "Input"],
Cell[160473, 4283, 2920, 75, 112, "Input"],
Cell[163396, 4360, 5558, 144, 152, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[168991, 4509, 206, 3, 36, "Subsection"],
Cell[169200, 4514, 224, 4, 30, "Text"],
Cell[169427, 4520, 642, 14, 28, "Input"],
Cell[170072, 4536, 1541, 36, 46, "Input"],
Cell[171616, 4574, 1911, 44, 67, "Input"],
Cell[173530, 4620, 4814, 126, 135, "Input"],
Cell[178347, 4748, 3058, 77, 112, "Input"],
Cell[181408, 4827, 7579, 188, 186, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[189048, 5022, 284, 3, 54, "Chapter"],
Cell[CellGroupData[{
Cell[189357, 5029, 202, 3, 64, "Section"],
Cell[CellGroupData[{
Cell[189584, 5036, 161, 2, 44, "Subsection"],
Cell[189748, 5040, 647, 22, 43, "Text"],
Cell[190398, 5064, 1963, 58, 114, "Input"],
Cell[192364, 5124, 154, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[192543, 5131, 537, 15, 28, "Input"],
Cell[193083, 5148, 584, 11, 24, "Message"]
}, Open  ]],
Cell[193682, 5162, 1489, 38, 71, "Input"],
Cell[195174, 5202, 235, 5, 30, "Text"],
Cell[195412, 5209, 1783, 50, 87, "Input"],
Cell[197198, 5261, 220, 6, 31, "Text"],
Cell[197421, 5269, 603, 15, 28, "Input"],
Cell[198027, 5286, 591, 15, 28, "Input"],
Cell[198621, 5303, 607, 15, 28, "Input"],
Cell[199231, 5320, 456, 11, 31, "Text"],
Cell[199690, 5333, 815, 23, 111, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[200542, 5361, 104, 1, 36, "Subsection"],
Cell[200649, 5364, 320, 6, 49, "Text"],
Cell[200972, 5372, 3302, 95, 114, "Input"],
Cell[204277, 5469, 393, 8, 46, "Input"],
Cell[204673, 5479, 277, 5, 30, "Text"],
Cell[204953, 5486, 250, 6, 28, "Input"],
Cell[205206, 5494, 135, 1, 30, "Text"],
Cell[205344, 5497, 1962, 54, 54, "Input"],
Cell[207309, 5553, 244, 7, 46, "Input"],
Cell[207556, 5562, 611, 15, 52, "Text"],
Cell[208170, 5579, 1236, 35, 59, "Input"],
Cell[209409, 5616, 998, 29, 49, "Input"],
Cell[210410, 5647, 1761, 49, 54, "Input"],
Cell[212174, 5698, 1820, 53, 70, "Input"],
Cell[CellGroupData[{
Cell[214019, 5755, 104, 1, 35, "Subsubsection"],
Cell[214126, 5758, 3114, 82, 73, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[217289, 5846, 206, 3, 36, "Subsection"],
Cell[217498, 5851, 223, 4, 30, "Text"],
Cell[217724, 5857, 1604, 37, 46, "Input"],
Cell[219331, 5896, 2080, 48, 69, "Input"],
Cell[221414, 5946, 2889, 71, 121, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[224352, 6023, 152, 2, 50, "Section"],
Cell[CellGroupData[{
Cell[224529, 6029, 230, 3, 44, "Subsection"],
Cell[224762, 6034, 647, 22, 43, "Text"],
Cell[225412, 6058, 1970, 58, 114, "Input"],
Cell[227385, 6118, 881, 27, 49, "Input"],
Cell[228269, 6147, 235, 5, 30, "Text"],
Cell[228507, 6154, 1881, 51, 87, "Input"],
Cell[230391, 6207, 290, 8, 31, "Text"],
Cell[230684, 6217, 649, 15, 28, "Input"],
Cell[231336, 6234, 645, 15, 28, "Input"],
Cell[231984, 6251, 663, 16, 28, "Input"],
Cell[232650, 6269, 199, 4, 30, "Text"],
Cell[232852, 6275, 1154, 34, 51, "Input"],
Cell[234009, 6311, 672, 17, 51, "Input"],
Cell[234684, 6330, 337, 7, 49, "Text"],
Cell[235024, 6339, 9436, 262, 378, "Input"],
Cell[244463, 6603, 492, 10, 46, "Input"],
Cell[244958, 6615, 590, 16, 28, "Input"],
Cell[245551, 6633, 211, 5, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[245799, 6643, 100, 1, 36, "Subsection"],
Cell[245902, 6646, 330, 6, 30, "Text"],
Cell[246235, 6654, 1503, 41, 28, "Input"],
Cell[247741, 6697, 298, 7, 28, "Input"],
Cell[248042, 6706, 410, 11, 32, "Text"],
Cell[248455, 6719, 3583, 90, 69, "Input"],
Cell[252041, 6811, 2990, 78, 51, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[255068, 6894, 198, 2, 36, "Subsection"],
Cell[255269, 6898, 464, 16, 31, "Text"],
Cell[255736, 6916, 1778, 48, 70, "Input"],
Cell[CellGroupData[{
Cell[257539, 6968, 114, 1, 35, "Subsubsection"],
Cell[257656, 6971, 6947, 174, 454, "Input"],
Cell[264606, 7147, 26811, 614, 881, "Input"],
Cell[291420, 7763, 3788, 89, 238, "Input"],
Cell[295211, 7854, 736, 15, 46, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[295996, 7875, 104, 1, 36, "Subsection"],
Cell[296103, 7878, 260, 5, 30, "Text"],
Cell[296366, 7885, 1959, 55, 54, "Input"],
Cell[298328, 7942, 398, 10, 31, "Text"],
Cell[298729, 7954, 3467, 93, 96, "Input"],
Cell[302199, 8049, 464, 11, 68, "Input"],
Cell[302666, 8062, 298, 7, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[303001, 8074, 120, 1, 36, "Subsection"],
Cell[303124, 8077, 603, 14, 50, "Text"],
Cell[303730, 8093, 1648, 39, 46, "Input"],
Cell[305381, 8134, 2010, 48, 69, "Input"],
Cell[307394, 8184, 3289, 85, 123, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[310720, 8274, 206, 3, 36, "Subsection"],
Cell[310929, 8279, 224, 4, 30, "Text"],
Cell[311156, 8285, 1785, 42, 46, "Input"],
Cell[312944, 8329, 2223, 52, 69, "Input"],
Cell[315170, 8383, 3677, 91, 123, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[318908, 8481, 212, 3, 54, "Chapter"],
Cell[CellGroupData[{
Cell[319145, 8488, 96, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[319266, 8493, 103, 1, 44, "Subsection"],
Cell[319372, 8496, 4867, 124, 301, "Input"],
Cell[324242, 8622, 3370, 84, 453, "Input"],
Cell[327615, 8708, 3246, 82, 267, "Input"],
Cell[330864, 8792, 2481, 62, 284, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[333382, 8859, 105, 1, 36, "Subsection"],
Cell[333490, 8862, 1465, 33, 146, "Input"],
Cell[334958, 8897, 4161, 103, 468, "Input"],
Cell[339122, 9002, 20180, 466, 940, "Input"],
Cell[359305, 9470, 13583, 308, 901, "Input"],
Cell[372891, 9780, 4238, 95, 438, "Input"],
Cell[377132, 9877, 2805, 65, 181, "Input"],
Cell[379940, 9944, 2677, 66, 199, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[382654, 10015, 95, 1, 36, "Subsection"],
Cell[382752, 10018, 6581, 164, 301, "Input"],
Cell[389336, 10184, 6727, 166, 318, "Input"],
Cell[396066, 10352, 3408, 82, 165, "Input"],
Cell[399477, 10436, 2972, 81, 165, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[402498, 10523, 91, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[402614, 10528, 141, 1, 44, "Subsection"],
Cell[402758, 10531, 5411, 148, 495, "Input"],
Cell[408172, 10681, 2240, 51, 199, "Input"],
Cell[410415, 10734, 792, 19, 46, "Input"],
Cell[411210, 10755, 12023, 259, 421, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[423270, 11019, 170, 3, 36, "Subsection"],
Cell[423443, 11024, 2891, 76, 257, "Input"],
Cell[426337, 11102, 2424, 56, 199, "Input"],
Cell[428764, 11160, 930, 21, 46, "Input"],
Cell[429697, 11183, 14101, 343, 522, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[443835, 11531, 282, 3, 36, "Subsection"],
Cell[444120, 11536, 1029, 25, 148, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[445186, 11566, 108, 1, 36, "Subsection"],
Cell[445297, 11569, 1804, 40, 155, "Input"],
Cell[447104, 11611, 3622, 93, 250, "Input"],
Cell[450729, 11706, 7405, 176, 363, "Input"]
}, Closed]]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[458195, 11889, 160, 2, 54, "Chapter"],
Cell[CellGroupData[{
Cell[458380, 11895, 96, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[458501, 11900, 110, 1, 44, "Subsection"],
Cell[458614, 11903, 2575, 56, 69, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[461226, 11964, 105, 1, 36, "Subsection"],
Cell[461334, 11967, 1465, 33, 146, "Input"],
Cell[462802, 12002, 4161, 103, 468, "Input"],
Cell[466966, 12107, 20180, 466, 940, "Input"],
Cell[487149, 12575, 13605, 308, 901, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[500803, 12889, 89, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[500917, 12894, 187, 2, 44, "Subsection"],
Cell[501107, 12898, 2727, 72, 318, "Input"],
Cell[503837, 12972, 4653, 119, 182, "Input"],
Cell[508493, 13093, 10730, 232, 497, "Input"],
Cell[519226, 13327, 5636, 118, 104, "Input"],
Cell[524865, 13447, 776, 19, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[525678, 13471, 195, 2, 36, "Subsection"],
Cell[525876, 13475, 4176, 107, 358, "Input"],
Cell[530055, 13584, 7943, 188, 348, "Input"],
Cell[538001, 13774, 806, 20, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[538844, 13799, 191, 2, 36, "Subsection"],
Cell[539038, 13803, 859, 22, 148, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[539934, 13830, 196, 3, 36, "Subsection"],
Cell[540133, 13835, 2675, 67, 283, "Input"],
Cell[542811, 13904, 2275, 56, 63, "Input"],
Cell[CellGroupData[{
Cell[545111, 13964, 99, 1, 35, "Subsubsection"],
Cell[545213, 13967, 19404, 431, 810, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[564654, 14403, 104, 1, 29, "Subsubsection"],
Cell[564761, 14406, 21845, 479, 861, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[586655, 14891, 245, 3, 36, "Subsection"],
Cell[586903, 14896, 5949, 147, 403, "Input"],
Cell[592855, 15045, 3572, 85, 97, "Input"],
Cell[596430, 15132, 3214, 78, 114, "Input"],
Cell[599647, 15212, 5740, 151, 174, "Input"],
Cell[605390, 15365, 10457, 232, 409, "Input"],
Cell[615850, 15599, 2158, 56, 114, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[618069, 15662, 174, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[618268, 15668, 95, 1, 64, "Section"],
Cell[618366, 15671, 1301, 34, 50, "Input"],
Cell[619670, 15707, 472, 14, 49, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[620179, 15726, 96, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[620300, 15731, 152, 2, 44, "Subsection"],
Cell[620455, 15735, 4298, 102, 267, "Input"],
Cell[624756, 15839, 2727, 69, 284, "Input"],
Cell[627486, 15910, 3146, 74, 301, "Input"],
Cell[630635, 15986, 2467, 65, 284, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[633139, 16056, 161, 2, 36, "Subsection"],
Cell[633303, 16060, 4489, 126, 202, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[637841, 16192, 90, 1, 50, "Section"],
Cell[CellGroupData[{
Cell[637956, 16197, 440, 10, 45, "Subsection"],
Cell[638399, 16209, 1540, 34, 97, "Input"],
Cell[639942, 16245, 2880, 72, 97, "Input"],
Cell[642825, 16319, 98, 1, 28, "Input"],
Cell[642926, 16322, 9347, 200, 364, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[652310, 16527, 276, 3, 36, "Subsection"],
Cell[652589, 16532, 3357, 88, 199, "Input"],
Cell[655949, 16622, 8791, 189, 301, "Input"],
Cell[664743, 16813, 4069, 99, 233, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[668849, 16917, 200, 3, 36, "Subsection"],
Cell[669052, 16922, 3361, 87, 199, "Input"],
Cell[672416, 17011, 5453, 146, 395, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[677906, 17162, 151, 2, 36, "Subsection"],
Cell[678060, 17166, 662, 14, 28, "Input"]
}, Closed]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[678783, 17187, 162, 2, 54, "Chapter"],
Cell[CellGroupData[{
Cell[678970, 17193, 92, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[679087, 17198, 175, 2, 44, "Subsection"],
Cell[CellGroupData[{
Cell[679287, 17204, 101, 1, 35, "Subsubsection"],
Cell[679391, 17207, 5768, 145, 437, "Input"],
Cell[685162, 17354, 5575, 135, 435, "Input"],
Cell[690740, 17491, 6884, 169, 481, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[697661, 17665, 99, 1, 29, "Subsubsection"],
Cell[697763, 17668, 964, 24, 143, "Input"],
Cell[698730, 17694, 1970, 53, 202, "Input"],
Cell[700703, 17749, 1291, 32, 160, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[702043, 17787, 103, 1, 36, "Subsection"],
Cell[702149, 17790, 4867, 124, 301, "Input"],
Cell[707019, 17916, 3581, 93, 386, "Input"],
Cell[710603, 18011, 213, 3, 28, "Input"],
Cell[710819, 18016, 4770, 120, 216, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[715626, 18141, 109, 1, 36, "Subsection"],
Cell[715738, 18144, 1522, 33, 143, "Input"],
Cell[717263, 18179, 4161, 103, 468, "Input"],
Cell[721427, 18284, 20180, 466, 940, "Input"],
Cell[741610, 18752, 13583, 308, 901, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[755230, 19065, 96, 1, 36, "Subsection"],
Cell[755329, 19068, 14368, 340, 1054, "Input"],
Cell[769700, 19410, 8295, 186, 570, "Input"],
Cell[777998, 19598, 6590, 165, 301, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[784637, 19769, 101, 1, 50, "Section"],
Cell[784741, 19772, 3568, 70, 172, "Input"],
Cell[788312, 19844, 1660, 43, 46, "Input"],
Cell[789975, 19889, 3587, 99, 156, "Input"],
Cell[793565, 19990, 2819, 74, 112, "Input"],
Cell[796387, 20066, 1644, 45, 46, "Input"],
Cell[798034, 20113, 1406, 34, 114, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[799477, 20152, 98, 1, 50, "Section"],
Cell[799578, 20155, 1844, 44, 153, "Input"],
Cell[801425, 20201, 2520, 49, 63, "Input"],
Cell[803948, 20252, 1069, 18, 46, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[805054, 20275, 161, 2, 50, "Section"],
Cell[CellGroupData[{
Cell[805240, 20281, 102, 1, 44, "Subsection"],
Cell[805345, 20284, 2700, 79, 216, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[808082, 20368, 110, 1, 36, "Subsection"],
Cell[808195, 20371, 6270, 177, 258, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[814502, 20553, 115, 1, 36, "Subsection"],
Cell[814620, 20556, 7221, 170, 405, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[821878, 20731, 108, 1, 36, "Subsection"],
Cell[821989, 20734, 8715, 203, 507, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[830741, 20942, 103, 1, 36, "Subsection"],
Cell[830847, 20945, 474, 9, 28, "Input"]
}, Closed]]
}, Closed]]
}, Closed]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
